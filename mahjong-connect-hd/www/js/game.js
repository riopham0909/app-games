!function(){var e,d={},n=(window.G=d,(window.gameG=d).BuildEnvironment={production:!0},(d=void 0===d?{}:d).ExtLoader=function(){Phaser.Loader.call(this,game),game.state.onStateChange.add(this.reset,this),this.imagesToRemoveOnStateChange=[],this.loadedUrls={}},d.ExtLoader.prototype=Object.create(Phaser.Loader.prototype),d.ExtLoader.prototype.reset=function(t,e){this.imagesToRemoveOnStateChange.forEach(function(t){this.cache.removeImage(t)},this),this.imagesToRemoveOnStateChange=[],Phaser.Loader.prototype.reset.call(this,t,e)},d.ExtLoader.prototype.addToFileList=function(t,e,i,s,a,n){if(void 0===a&&(a=!1),void 0===e||""===e)console.warn("Phaser.Loader: Invalid or no key given of type "+t);else{if(null==i){if(!n)return console.warn("Phaser.Loader: No URL given for file type: "+t+" key: "+e),this;i=e+n}var o={type:t,key:e,path:this.path,url:i,syncPoint:0<this._withSyncPointDepth,data:null,loading:!1,loaded:!1,error:!1};if(s)for(var r in s)o[r]=s[r];n=this.getAssetIndex(t,e);a&&-1<n?(i=this._fileList[n]).loading||i.loaded?(this._fileList.push(o),this._totalFileCount++):this._fileList[n]=o:-1===n&&(this._fileList.push(o),this._totalFileCount++),this.loadFile(this._fileList.shift())}return this},d.ExtLoader.prototype.asyncComplete=function(t,e){void 0===e&&(e=""),t.loaded=!0,t.error=!!e,e&&(t.errorMessage=e,console.warn("Phaser.Loader - "+t.type+"["+t.key+"]: "+e))},d.ExtLoader.prototype.fileComplete=function(e,t){switch(e.type){case"packfile":var i=JSON.parse(t.responseText);e.data=i||{};break;case"image":this.cache.addImage(e.key,e.url,e.data);break;case"spritesheet":this.cache.addSpriteSheet(e.key,e.url,e.data,e.frameWidth,e.frameHeight,e.frameMax,e.margin,e.spacing);break;case"textureatlas":if(null==e.atlasURL)this.cache.addTextureAtlas(e.key,e.url,e.data,e.atlasData,e.format);else if(e.format==Phaser.Loader.TEXTURE_ATLAS_JSON_ARRAY||e.format==Phaser.Loader.TEXTURE_ATLAS_JSON_HASH||e.format==Phaser.Loader.TEXTURE_ATLAS_JSON_PYXEL)this.xhrLoad(e,this.transformUrl(e.atlasURL,e),"text",this.jsonLoadComplete);else{if(e.format!=Phaser.Loader.TEXTURE_ATLAS_XML_STARLING)throw new Error("Phaser.Loader. Invalid Texture Atlas format: "+e.format);this.xhrLoad(e,this.transformUrl(e.atlasURL,e),"text",this.xmlLoadComplete)}break;case"bitmapfont":e.atlasURL?this.xhrLoad(e,this.transformUrl(e.atlasURL,e),"text",function(t,e){var i;try{i=JSON.parse(e.responseText)}catch(t){}i?(t.atlasType="json",this.jsonLoadComplete(t,e)):(t.atlasType="xml",this.xmlLoadComplete(t,e))}):this.cache.addBitmapFont(e.key,e.url,e.data,e.atlasData,e.atlasType,e.xSpacing,e.ySpacing);break;case"video":if(e.asBlob)try{e.data=t.response}catch(t){throw new Error("Phaser.Loader. Unable to parse video file as Blob: "+e.key)}this.cache.addVideo(e.key,e.url,e.data,e.asBlob);break;case"audio":this.game.sound.usingWebAudio?(e.data=t.response,this.cache.addSound(e.key,e.url,e.data,!0,!1),e.autoDecode&&this.game.sound.decode(e.key)):this.cache.addSound(e.key,e.url,e.data,!1,!0);break;case"text":e.data=t.responseText,this.cache.addText(e.key,e.url,e.data);break;case"shader":e.data=t.responseText,this.cache.addShader(e.key,e.url,e.data);break;case"physics":i=JSON.parse(t.responseText);this.cache.addPhysicsData(e.key,e.url,i,e.format);break;case"script":e.data=document.createElement("script"),e.data.language="javascript",e.data.type="text/javascript",e.data.defer=!1,e.data.text=t.responseText,document.head.appendChild(e.data),e.callback&&(e.data=e.callback.call(e.callbackContext,e.key,t.responseText));break;case"binary":e.callback?e.data=e.callback.call(e.callbackContext,e.key,t.response):e.data=t.response,this.cache.addBinary(e.key,e.data)}this.onFileComplete.dispatch(0,e.key,!e.error)},function(r){"use strict";var h,l,c,d,p,u,e,g,m,s,t;if(!(void 0===r||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent)))return t=r.document,h=function(){return r.URL||r.webkitURL||r},l=t.createElementNS("http://www.w3.org/1999/xhtml","a"),c="download"in l,d=/constructor/i.test(r.HTMLElement)||r.safari,p=/CriOS\/[\d]+/.test(navigator.userAgent),u=function(t){(r.setImmediate||r.setTimeout)(function(){throw t},0)},e=4e4,g=function(t){setTimeout(function(){"string"==typeof t?h().revokeObjectURL(t):t.remove()},e)},m=function(t){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t},t=(s=function(t,i,e){e||(t=m(t));var s,a,n=this,e="application/octet-stream"===t.type,o=function(){for(var t=n,e="writestart progress write writeend".split(" "),i=void 0,s=(e=[].concat(e)).length;s--;){var a=t["on"+e[s]];if("function"==typeof a)try{a.call(t,i||t)}catch(t){u(t)}}};n.readyState=n.INIT,c?(s=h().createObjectURL(t),setTimeout(function(){var t,e;l.href=s,l.download=i,t=l,e=new MouseEvent("click"),t.dispatchEvent(e),o(),g(s),n.readyState=n.DONE})):(p||e&&d)&&r.FileReader?((a=new FileReader).onloadend=function(){var t=p?a.result:a.result.replace(/^data:[^;]*;/,"data:attachment/file;");r.open(t,"_blank")||(r.location.href=t),n.readyState=n.DONE,o()},a.readAsDataURL(t),n.readyState=n.INIT):(s=s||h().createObjectURL(t),!e&&r.open(s,"_blank")||(r.location.href=s),n.readyState=n.DONE,o(),g(s))}).prototype,"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(t,e,i){return e=e||t.name||"download",i||(t=m(t)),navigator.msSaveOrOpenBlob(t,e)}:(t.abort=function(){},t.readyState=t.INIT=0,t.WRITING=1,t.DONE=2,t.error=t.onwritestart=t.onprogress=t.onwrite=t.onabort=t.onerror=t.onwriteend=null,function(t,e,i){return new s(t,e||t.name||"download",i)})}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content));function i(){Object.keys(e).forEach(function(t){e[t].removeNonPermanent()})}function t(t){return game.state.onStateChange.add(i,this),e[t]||(e[t]=new Phaser.Signal),e[t]}"undefined"!=typeof module&&module.exports?module.exports.saveAs=n:"undefined"!=typeof define&&null!==define&&null!==define.amd&&define("FileSaver.js",function(){return n}),(d=void 0===d?{}:d).Button=function(t,e,i,s,a){Phaser.Button.call(this,game,d.l(t),d.l(e),null),this.state=game.state.getCurrentState(),d.changeTexture(this,i),this.anchor.setTo(.5),this.sfx=d.sfx.pop,this.active=!0,this.onClick=new Phaser.Signal,s&&this.onClick.add(s,a||this),this.onInputDown.add(this.click,this),this.terms=[],this.IMMEDIATE=!1,this.scaleOnClick=!0,this.targetAlphaTermsNotFulfilled=.5,this.targetAlpha=1,this.refractorPeriod=400,this.scaleChange=.1,this.pulsing=!1},d.Button.prototype=Object.create(Phaser.Button.prototype),d.Button.constructor=d.Button,d.Button.prototype.update=function(){this.checkTerms()?this.targetAlpha=1:this.targetAlpha=this.targetAlphaTermsNotFulfilled,this.alpha=d.lerp(this.alpha,this.targetAlpha,.2,.05),this.updateChildren()},d.Button.prototype.pulse=function(t){this.pulsing=!0,this.pulsingTween=game.add.tween(this.scale).to({x:t||1.1,y:t||1.1},500,Phaser.Easing.Sinusoidal.InOut,!0,0,-1,!0)},d.Button.prototype.stopPulse=function(t){this.pulsingTween&&this.pulsingTween.stop(),this.scale.setTo(t||1),this.pulsing=!1},d.Button.prototype.click=function(){var t,e;this.active&&this.checkTerms()&&(this.active=!1,this.onClick.dispatch(),this.sfx&&this.sfx.play(),t=this.scale.x,e=this.scale.y,this.IMMEDIATE?this.active=!0:this.pulsing||!this.scaleOnClick?game.time.events.add(this.refractorPeriod,function(){this.active=!0},this):game.add.tween(this.scale).to({x:t+this.scaleChange,y:e+this.scaleChange},Math.floor(.5*this.refractorPeriod),Phaser.Easing.Quadratic.Out,!0).onComplete.add(function(){game.add.tween(this.scale).to({x:t,y:e},Math.floor(.5*this.refractorPeriod),Phaser.Easing.Quadratic.Out,!0).onComplete.add(function(){this.active=!0},this)},this))},d.Button.prototype.checkTerms=function(){for(var t=0;t<this.terms.length;t++)if(!this.terms[t][0].call(this.terms[t][1]))return!1;return!0},d.Button.prototype.addTerm=function(t,e){this.terms.push([t,e])},d.Button.prototype.addImageLabel=function(t){this.label=game.make.image(0,0,"ssheet",t),this.label.anchor.setTo(.5),this.addChild(this.label)},d.Button.prototype.addTextLabel=function(t,e,i){var s=1/d.Loader.currentConfigMulti;this.label=new d.OneLineText(-7,-6,t,e,i||Math.floor(this.height*s*.7),this.width*s*.9,.5,.5),this.addChild(this.label)},d.Button.prototype.addTextLabelMultiline=function(t,e){var i=1/d.Loader.currentConfigMulti;this.label=new d.MultiLineText(0,0,t,e,Math.floor(this.height*i*.5),this.width*i*.8,this.height*i*.7,"center",.5,.5),this.addChild(this.label)},d.Button.prototype.addGTextLabel=function(t,e){this.label=new d.Text(0,0,t,e,.5,.9*this.width,.9*this.height,!0,"center"),this.addChild(this.label)},d.Button.prototype.stopTweens=function(){d.stopTweens(this)},d.Button.prototype.changeTexture=function(t){d.changeTexture(this,t)},d.Button.prototype.add=function(t){return this.addChild(t)},d.Button.prototype.updateChildren=function(){for(var t=this.children.length;t--;)this.children[t].update()},(d=void 0===d?{}:d).FrameAnimation=function(t,e,i,s,a){Phaser.Image.call(this,game,d.l(t),d.l(e)),this.anchor.setTo(.5),this.frameNamePrefix=i,this.animFramesLen=this.getAnimationLength(this.frameNamePrefix),this.timerEvery=s?60/s:1,this.animDir=1,d.changeTexture(this,this.frameNamePrefix+"_0"),this.currentTimer=0,this.currentIndex=0,this.onFinish=new Phaser.Signal,this.active=a||!1},d.FrameAnimation.prototype=Object.create(Phaser.Image.prototype),d.FrameAnimation.prototype.play=function(t,e,i){return this.currentTimer=0,this.currentIndex=i||0,this.active=!0,this.loop=t-1||0,this.animDir=1,this.bounce=e||!1,d.changeTexture(this,this.frameNamePrefix+"_"+this.currentIndex),this},d.FrameAnimation.prototype.update=function(){if(this.active&&(this.currentTimer+=d.deltaTime,this.currentTimer>=this.timerEvery)){if(this.currentTimer=this.currentTimer-this.timerEvery,this.currentIndex+=this.animDir,this.bounce){if(this.currentIndex==this.animFramesLen||0==this.currentIndex){if(0==this.loop&&0==this.currentIndex)return this.onFinish.dispatch(),this.active=!1;0<this.loop&&0==this.currentIndex&&this.loop--,this.currentIndex==this.animFramesLen&&(this.currentIndex=this.animFramesLen-1),this.animDir*=-1}}else if(this.currentIndex==this.animFramesLen){if(0==this.loop)return this.onFinish.dispatch(),this.active=!1;0<this.loop&&this.loop--,this.currentIndex=0}d.changeTexture(this,this.frameNamePrefix+"_"+this.currentIndex)}},d.FrameAnimation.prototype.getAnimationLength=function(t){if(d.FrameAnimation.CacheAnimLength[t])return d.FrameAnimation.CacheAnimLength[t];for(var e=0,i=0;i<1e3&&d.isImageInCache(t+"_"+i);i++)e++;return d.FrameAnimation.CacheAnimLength[t]=e},d.FrameAnimation.CacheAnimLength={},d.gift={},d.gift.getGift=function(t){for(var t=t||"normals",t=d.json.settings.gifts[t],e=t.boosterMaxNr||d.json.settings.gifts.boosterMaxNr,i=t.boosterChance||d.json.settings.gifts.boosterChance,s=(console.log(e+" & "+i),[]),a=(t.list.forEach(function(t){("coin"==t[0]||-1!==t[0].indexOf("booster")&&d.saveState.isBoosterUnlocked(parseInt(t[0][8]))&&d.saveState.getBoosterAmount(parseInt(t[0][8]))<e)&&s.push(t)}),Phaser.ArrayUtils.shuffle(s),Math.random()<i),n=0;n<s.length;n++){var o=s[n];if(-1===o[0].indexOf("booster"))return o.slice();if(a)return o.slice()}return["coin",50]},d.gift.getLabelString=function(t){return t[1]+" @"+d.json.settings.gifts.icons[t[0]]+"@"},d.gift.applyGift=function(t){"coin"==t[0]?d.saveState.changeCoins(t[1]):d.saveState.changeBoosterAmount(parseInt(t[0][8]),t[1])},d.gift.getIcon=function(t){return d.json.settings.gifts.icons[t[0]]},(d=void 0===d?{}:d).GridArray=function(t,e,i,s){"number"==typeof t?this.createGrid.apply(this,arguments):"string"==typeof t?(this.data=JSON.parse(t),this.width=this.data.length,this.height=this.data[0].length):Array.isArray(t)&&(a=t,this.data=t,this.width=this.data.length,this.height=this.data[0].length)},d.GridArray.prototype={createGrid:function(t,e,i){this.data=[],this.width=t,this.height=e;for(var s=0;s<t;s++){this.data[s]=[];for(var a=0;a<e;a++)this.data[s][a]=i}},set:function(t,e,i){return this.isInGrid(t,e)?this.data[t][e]=i:(this.dbg&&console.log("setValue OUT OF RANGE"),!1)},get:function(t,e){return this.isInGrid(t,e)?this.data[t][e]:(this.dbg&&console.log("getValue OUT OF RANGE"),!1)},swapValues:function(t,e,i,s){if(!this.isInGrid(t,e)||!this.isInGrid(i,s))return this.dbg&&console.log("swapValues OUT OF RANGE"),!1;var a=this.data[t][e];this.data[t][e]=this.data[i][s],this.data[i][s]=a},isInGrid:function(t,e){return!(t<0||t>=this.width||e<0||e>=this.height)},find:function(t,e){for(var i=0;i<this.width;i++)for(var s=0;s<this.height;s++)if(t.call(e,this.data[i][s],i,s,this.data))return this.data[i][s];return!1},filter:function(t,e){for(var i=[],s=0;s<this.width;s++)for(var a=0;a<this.height;a++)t.call(e,this.data[s][a],s,a,this.data)&&i.push(this.data[s][a]);return i},loop:function(t,e){for(var i=0;i<this.width;i++)for(var s=0;s<this.height;s++)t.call(e,this.data[i][s],i,s,this.data)},clear:function(a){this.loop(function(t,e,i,s){s[e][i]=a||!1})},findPattern:function(o,r){var h=!1,l=o.length;return this.loop(function(t,e,i,s){if(t==r&&!h){for(var a=0;a<l;a+=2){if(!this.get(e+o[a],i+o[a+1]))return;if(this.get(e+o[a],i+o[a+1])!==r)return}h=[];for(var n=0;n<l;n+=2)h.push(e+o[n],i+o[n+1])}},this),h},count:function(){for(var t=0,e=0;e<this.width;e++)for(var i=0;i<this.height;i++)this.data[e][i]&&t++;return t},getAllElements:function(){for(var t=[],e=0;e<this.width;e++)for(var i=0;i<this.height;i++)this.data[e][i]&&t.push(this.data[e][i]);return t}},d.Image=function(t,e,i,s,a){Phaser.Image.call(this,game,d.l(t),d.l(e),null),Object.defineProperty(this,"angle",{get:function(){return Phaser.Math.radToDeg(this.rotation)},set:function(t){this.rotation=Phaser.Math.degToRad(t)}}),this.angle=0,this.state=game.state.getCurrentState(),this.changeTexture(i),s&&("number"==typeof s?this.anchor.setTo(s):this.anchor.setTo(s[0],s[1])),a?(a.add||a.addChild).call(a,this):null!==a&&game.world.add(this)},d.Image.prototype=Object.create(Phaser.Image.prototype),d.Image.prototype.stopTweens=function(){d.stopTweens(this)},d.Image.prototype.changeTexture=function(t){d.changeTexture(this,t)},Phaser.Image.prototype.changeTexture=function(t){d.changeTexture(this,t)},d.Image.prototype.add=function(t){return this.addChild(t)},d.LabelGroupT=function(t,e,i,s,a,n,o){Phaser.Group.call(this,game),this.str=t,this.tagArray=d.LabelParser.changeIntoTagArray(t),this.x=e,this.y=i,this.textStyle=s,this.fontSize=parseInt(s.fontSize),this.distanceBetween=o||0,"number"==typeof a?this.anchorX=this.anchorY=a:(this.anchorX=a[0],this.anchorY=a[1]),this.maxWidth=n||0,this.processTagArray()},d.LabelGroupT.prototype=Object.create(Phaser.Group.prototype),d.LabelGroupT.prototype.processTagArray=function(){for(var t,e=0;e<this.tagArray.length;e++)"img"==this.tagArray[e].type?(t=d.makeImage(0,0,this.tagArray[e].content,0,this)).tagScale=this.tagArray[e].scale:"separator"==this.tagArray[e].type?((t=d.makeImage(0,0,null,0,this)).SEPARATOR=!0,t.SEP_LENGTH=this.tagArray[e].length):this.add(new d.Text(0,0,this.tagArray[e].content,this.textStyle));this.refresh()},d.LabelGroupT.prototype.refresh=function(){if(this.applySizeAndAnchor(),0<this.maxWidth&&this.getWholeWidth()>this.maxWidth)for(;this.getWholeWidth()>this.maxWidth;)this.distanceBetween=Math.floor(.9*this.distanceBetween),this.fontSize=Math.floor(.9*this.fontSize),this.applySizeAndAnchor();this.spreadElements()},d.LabelGroupT.prototype.applySizeAndAnchor=function(){this.children.forEach(function(t){t.anchor.setTo(this.anchorX,this.anchorY),t.fontSize?(t.fontSize=this.fontSize,t.updateTransform()):(t.height=this.fontSize*(t.tagScale||1),t.scale.x=t.scale.y),t.SEPARATOR&&(t.width=this.fontSize*t.SEP_LENGTH)},this)},d.LabelGroupT.prototype.getWholeWidth=function(){var t=(this.children.length-1)*this.distanceBetween,e=0;return this.children.forEach(function(t){e+=t.width}),t+e},d.LabelGroupT.prototype.spreadElements=function(){var s=this.getWholeWidth()*this.anchorX*-1;this.children.forEach(function(t,e,i){t.left=0==e?s:i[e-1].right+this.distanceBetween},this)},d.LabelParser={specialChars:["$","@","%","^"],changeIntoTagArray:function(t,e){for(var i=[],s=0;0<t.length&&!(20<s++);){var a=this.findFirstSpecialChar(t);if(-1===a){i.push(t);break}0<a[0]&&(i.push(t.slice(0,a[0])),t=t.slice(a[0])),t=this.cutOffTag(t,i,a[1])}for(var n=[],s=0;s<i.length;s++)n.push(this.processTag(i[s],e));return this.mergeTextTagsInArray(n)},mergeTextTagsInArray:function(t){for(var e=[],i=null,s=0;s<t.length;s++)"text"!==t[s].type?(null!==i&&(e.push(this.mergeTextTags(t,i,s)),i=null),e.push(t[s])):null==i&&(i=s);return null!==i&&e.push(this.mergeTextTags(t,i,s)),e},mergeTextTags:function(t,e,i){for(var s={type:"text",content:[]};e<i;e++)s.content.push(t[e].content);return s.content=s.content.join(" "),s},processTag:function(t,e){var i;return"@"==t[0]?("*"==t[i=1]&&t.indexOf("*",2)&&(i=parseFloat(t.slice(t.indexOf("*")+1,t.indexOf("*",2))),t=t.slice(t.indexOf("*",2))),{type:"img",content:t.slice(1,-1),scale:i}):"%"==t[0]?{type:"text",content:e[t.slice(1,-1)]}:"$"==t[0]?{type:"text",content:d.txt(t.slice(1,-1))}:"^"==t[0]?{type:"text",content:t.slice(1,-1)}:this.isStringJustSpaces(t)?{type:"separator",content:t,length:t.length}:{type:"text",content:t}},isStringJustSpaces:function(t){for(var e=0;e<t.length;e++)if(" "!==t[e])return!1;return!0},cutOffTag:function(t,e,i){var s=t.indexOf(i),i=t.indexOf(i,s+1);return e.push(t.slice(s,i+1)),t.slice(0,s)+t.slice(i+1)},findFirstSpecialChar:function(i){var s=1/0,a=!1;return this.specialChars.forEach(function(t){var e=i.indexOf(t);-1<e&&e<s&&(a=t,s=Math.min(e,s))}),s===1/0?-1:[s,a]},createLabel:function(t,e,i,s,a,n,o,r,h,l){this.changeIntoTagArray(t,e);return new d.LabelGroup(i,s,n,h,o,r,l)}},d.LabelGroup=function(t,e,i,s,a,n,o,r){Phaser.Group.call(this,game),this.fontData=game.cache.getBitmapFont(s).font,this.fontBaseSize=this.fontData.size,this.fontSpaceOffset=this.fontData.chars[32].xOffset+this.fontData.chars[32].xAdvance,this.str=t,this.tagArray=d.LabelParser.changeIntoTagArray(t),this.x=void 0===e?0:d.l(e),this.y=void 0===i?0:d.l(i),this.font=s,this.fontSize=void 0===a?d.l(30):d.l(a),this.distanceBetween=0,this.anchorX=void 0===n?.5:n,this.anchorY=void 0===o?.5:o,this.maxWidth=r||0,this.processTagArray()},d.LabelGroup.prototype=Object.create(Phaser.Group.prototype),d.LabelGroup.prototype.processTagArray=function(){for(var t,e=0;e<this.tagArray.length;e++)"img"==this.tagArray[e].type?(t=d.makeImage(0,0,this.tagArray[e].content,0,this)).tagScale=this.tagArray[e].scale:"separator"==this.tagArray[e].type?((t=d.makeImage(0,0,null,0,this)).SEPARATOR=!0,t.SEP_LENGTH=this.tagArray[e].length):this.add(game.add.bitmapText(0,0,this.font,this.tagArray[e].content,this.fontSize));this.refresh()},d.LabelGroup.prototype.refresh=function(){if(this.applySizeAndAnchor(),0<this.maxWidth&&this.getWholeWidth()>this.maxWidth)for(;this.getWholeWidth()>this.maxWidth;)this.distanceBetween*=.9,this.fontSize*=.9,this.applySizeAndAnchor();this.spreadElements()},d.LabelGroup.prototype.applySizeAndAnchor=function(){this.children.forEach(function(t){t.anchor.setTo(this.anchorX,this.anchorY),t.fontSize?(t.fontSize=this.fontSize,t.updateText()):(t.height=this.fontSize*(t.tagScale||1),t.scale.x=t.scale.y),t.SEPARATOR&&(t.width=this.fontSize/this.fontBaseSize*this.fontSpaceOffset*t.SEP_LENGTH)},this)},d.LabelGroup.prototype.getWholeWidth=function(){var t=(this.children.length-1)*this.distanceBetween,e=0;return this.children.forEach(function(t){e+=t.width}),t+e},d.LabelGroup.prototype.spreadElements=function(){var s=this.getWholeWidth()*this.anchorX*-1;this.children.forEach(function(t,e,i){t.left=0==e?s:i[e-1].right+this.distanceBetween},this)},d.LineEditor=function(){Phaser.Group.call(this,game),this.gfx=game.add.graphics(),this.gfx.fixedToCamera=!0,this.points={x:[],y:[]},this.currentIndex=null,this.pointerStart=new Phaser.Point(0,0),this.interpolation="linearInterpolation",game.input.onDown.add(function(t){this.currentIndex=this.findCurrentIndex(t),null!==this.currentIndex&&(this.pointerStart.x=t.x,this.pointerStart.y=t.y)},this),game.input.onUp.add(function(t){this.currentIndex=null},this),this.keys=game.input.keyboard.addKeys({Z:Phaser.Keyboard.Z,X:Phaser.Keyboard.X,C:Phaser.Keyboard.C,A:Phaser.Keyboard.A,S:Phaser.Keyboard.S,D:Phaser.Keyboard.D}),this.keys.Z.onDown.add(function(){this.interpolation="catmullRomInterpolation"},this),this.keys.X.onDown.add(function(){this.interpolation="bezierInterpolation"},this),this.keys.C.onDown.add(function(){this.interpolation="linearInterpolation"},this),this.keys.A.onDown.add(function(){var t=game.input.activePointer;this.points.x.push(t.x),this.points.y.push(t.y)},this),this.keys.S.onDown.add(function(){this.currentIndex&&(this.points.x.splice(this.currentIndex,1),this.points.y.splice(this.currentIndex,1))},this),this.keys.D.onDown.add(function(){this.points.x.pop(),this.points.y.pop()},this)},d.LineEditor.prototype=Object.create(Phaser.Group.prototype),d.LineEditor.prototype.update=function(){var t,e,i;this.currentIndex&&(t=game.input.activePointer,e=this.pointerStart.x-t.x,i=this.pointerStart.y-t.y,this.pointerStart.x=t.x,this.pointerStart.y=t.y,this.points.x[this.currentIndex]-=e,this.points.y[this.currentIndex]-=i),this.redraw()},d.LineEditor.prototype.findCurrentIndex=function(t){for(var e=null,i=1/0,s=0;s<this.points.x.length;s++){var a=game.math.distance(t.x,t.y,this.points.x[s],this.points.y[s]);a<i&&(e=s,i=a)}return e},d.LineEditor.prototype.redraw=function(){this.gfx.clear(),this.drawLine(),this.drawPoints()},d.LineEditor.prototype.drawPoints=function(){this.gfx.lineStyle(2,255,1),this.gfx.beginFill(255,.5);for(var t=0;t<this.points.x.length;t++)this.gfx.drawCircle(this.points.x[t],this.points.y[t],10)},d.LineEditor.prototype.drawLine=function(){if(0!=this.points.x.length){this.gfx.lineStyle(2,16711680,1),this.gfx.moveTo(this.points.x[0],this.points.y[0]);for(var t=0;t<1;t+=.001){var e=game.math[this.interpolation](this.points.x,t),i=game.math[this.interpolation](this.points.y,t);this.gfx.lineTo(e,i)}}},(d=void 0===d?{}:d).Loader={currentConfig:"hd",currentConfigMulti:1,loadingScreenActive:!1,lang:!1,passConfigs:function(t){this.configs=t},setConfig:function(t){this.currentConfig=t,this.currentConfigMulti=this.configs[t]},killLoadingScreen:function(){d.imgRotate&&(d.whiteOverlay.destroy(),d.imgRotate.fadeOut=!0,d.imgRotate=!1,this.loadingScreenActive=!1)},loadPOSTImage:function(t){void 0===t||game.cache.checkImageKey(t)||(this.makeLoadingScreen(),game.load.image(t,"assets/"+this.currentConfig+"/imagesPOST/"+t))},loadBootAssets:function(t){t&&(this.lang=t.toUpperCase()),d.ASSETS.images.forEach(function(t){this.checkIfLoad(t,!0)&&(console.log("loading ",t),game.load.image(this.removeExt(this.cutOffPrefixes(t)),"assets/"+this.currentConfig+"/images/"+t))},this),d.ASSETS.spritesheets.forEach(function(t){this.checkIfLoad(t,!0)&&(console.log("loading ",t),game.load.atlasJSONHash(this.cutOffPrefixes(t),"assets/"+this.currentConfig+"/spritesheets/"+t+".png","assets/"+this.currentConfig+"/spritesheets/"+t+".json"))},this),game.load.onLoadComplete.addOnce(function(){this.createSpritesheetMap(!0)},this)},loadAssets:function(t){t&&(this.lang=t.toUpperCase()),game.load.onLoadComplete.addOnce(this.processAssets,this),this.loadSFX(d.ASSETS.sfx),this.loadImages(d.ASSETS.images),this.loadSpritesheets(d.ASSETS.spritesheets),this.loadJson(d.ASSETS.json),this.loadFonts(d.ASSETS.fonts)},processAssets:function(){this.processJson(d.ASSETS.json),this.processSFX(d.ASSETS.sfx),this.createSpritesheetMap()},createSpritesheetMap:function(t){console.log("create spritesheets map"),d.spritesheetMap||(d.spritesheetMap={});for(var e=0,i=d.ASSETS.spritesheets.length;e<i;e++)if(this.checkIfLoad(d.ASSETS.spritesheets[e],t)){var s=this.cutOffPrefixes(d.ASSETS.spritesheets[e]);if(game.cache.checkImageKey(s))for(var a=game.cache.getFrameData(s),n=0;n<a._frames.length;n++){var o=a._frames[n];d.spritesheetMap[o.name]&&console.warn("Images name collision: "+o.name),d.spritesheetMap[o.name]=s}}},loadSFX:function(t){t.forEach(function(t){game.load.audio(this.removeExt(t),"assets/sfx/"+t)},this)},loadFonts:function(t){for(var e in t){if(!this.checkIfLoad(e))return;game.load.bitmapFont(this.cutOffPrefixes(e),"assets/"+this.currentConfig+"/fonts/"+t[e].frame,"assets/"+this.currentConfig+"/fonts/"+t[e].data)}},loadImages:function(t){t.forEach(function(t){this.checkIfLoad(t)&&game.load.image(this.removeExt(this.cutOffPrefixes(t)),"assets/"+this.currentConfig+"/images/"+t)},this)},loadJson:function(t){t.forEach(function(t){game.load.json(this.removeExt(t),"assets/json/"+t)},this)},loadSpritesheets:function(t){t.forEach(function(t){this.checkIfLoad(t)&&game.load.atlasJSONHash(this.cutOffPrefixes(t),"assets/"+this.currentConfig+"/spritesheets/"+t+".png","assets/"+this.currentConfig+"/spritesheets/"+t+".json")},this)},checkIfLoad:function(t,e){return!(e&&-1==t.indexOf("BOOT-")||!e&&-1!==t.indexOf("BOOT-")||-1!==t.indexOf("MOBILE-")&&game.device.desktop||-1!==t.indexOf("DESKTOP-")&&!game.device.desktop||this.lang&&t.match(/^[A-Z]{2}\-/)&&0!=t.indexOf(this.lang+"-"))},cutOffPrefixes:function(t){return t=(t=(t=(t=t.replace(/^[A-Z]{2}\-/,"")).replace("BOOT-","")).replace("MOBILE-","")).replace("DESKTOP-","")},removeExt:function(t){return t.slice(0,t.lastIndexOf("."))},processJson:function(t){d.json={},t.forEach(function(t){t=this.removeExt(t),d.json[t]=game.cache.getJSON(t)},this)},processSFX:function(t){d.sfx={},game.sfx=d.sfx;var i={};t.forEach(function(t){t=this.removeExt(t),d.sfx[t]=game.add.audio(t);var e=t.lastIndexOf("_");-1===e||isNaN(t.slice(e+1))||(parseInt(t.slice(e+1)),e=t.slice(0,e),i[e]||(i[e]=[]),i[e].push(d.sfx[t]))},this),Object.keys(i).forEach(function(t){d.sfx[t]={sfxArray:i[t],play:function(t,e,i){game.rnd.pick(this.sfxArray).play("",0,t,e,i)}}})}},d.MultiLineText=function(t,e,i,s,a,n,o,r,h,l){if(t=d.l(t),e=d.l(e),a=d.l(a),n=d.l(n),o=d.l(o),this.maxUserWidth=n,this.maxUserHeight=o,Phaser.BitmapText.call(this,game,t,e,i,"",a),this.splitText(s,n),this.align=r||"center",o)for(;this.height>o&&(this.fontSize-=2,this.splitText(s,n),this.updateText(),!(this.fontSize<5)););this.anchor.setTo(h,l),this.cacheAsBitmap=!0},d.MultiLineText.prototype=Object.create(Phaser.BitmapText.prototype),d.MultiLineText.prototype.constructor=d.MultiLineText,d.MultiLineText.prototype.splitText=function(t,e){for(var i,s=t,a=[],n=0;0<s.length;)i=n,-1==(n=s.indexOf(" ",n+1))?this.setText(s):this.setText(s.substring(0,n)),this.updateText(),this.width>e?n=(s=0==i&&-1==n?(a.push(s),""):0==i?(a.push(s.substring(0,n)),s.substring(n+1)):(a.push(s.substring(0,i)),s.substring(i+1)),0):-1==n&&(a.push(s),s="");this.setText(a.join("\n"))},d.MultiLineText.prototype.popUpAnimation=function(){this.cacheAsBitmap=!1;for(var t=this.children.length,i=[],e=0;e<t;e++)i[e]=e;i=Phaser.ArrayUtils.shuffle(i),delay_index=0,this.activeTweens=0,this.children.forEach(function(t){0==t.anchor.x&&(t.x=t.x+.5*t.width,t.y=t.y+t.height,t.anchor.setTo(.5,1));var e=t.scale.x,t=(t.scale.setTo(0,0),this.activeTweens++,game.add.tween(t.scale).to({x:1.5*e,y:1.5*e},200,Phaser.Easing.Quadratic.In,!1,25*i[delay_index]).to({x:e,y:e},200,Phaser.Easing.Sinusoidal.In));t.onComplete.add(function(){this.activeTweens--,0==this.activeTweens&&this.alive&&(this.cacheAsBitmap=!0)},this),t.start(),delay_index++},this)},d.OneLineText=function(t,e,i,s,a,n,o,r){if(Phaser.BitmapText.call(this,game,d.l(t),d.l(e),i,s,d.l(a),d.l(n)),n)for(;this.width>d.l(n)&&(this.fontSize-=2,this.updateText(),!(this.fontSize<5)););this.orgFontSize=d.l(a),this.maxUserWidth=d.l(n),this.skipCaching=d.skipOneLineTextCaching||!1,this.hAnchor=o,this.vAnchor=r,this.anchor.setTo(this.hAnchor,this.vAnchor),this.updateText(),this.insertCoin(this.fontSize),this.skipCaching||(this.cacheAsBitmap=!0,this.updateCache())},d.OneLineText.prototype=Object.create(Phaser.BitmapText.prototype),d.OneLineText.prototype.constructor=d.OneLineText,d.OneLineText.prototype.insertCoin=function(s){-1!=this.text.indexOf("$$")&&this.children.forEach(function(t,e,i){t.name&&"$"==t.name&&t.visible&&e+1<=i.length-1&&"$"==i[e].name&&(i=i[e+1],(e=t).visible=!1,i.visible=!1,(coin=d.makeImage(e.x+.05*s,e.y-.05*s,"coin")).width=s,coin.height=s,e.parent.addChild(coin))})},d.OneLineText.prototype.setText=function(t){Phaser.BitmapText.prototype.setText.call(this,t.toString());var t=this.scale.x,e=this.scale.y,i=this.alpha,s=this.angle;if(this.alpha=1,this.scale.setTo(1),this.maxUserWidth){this.fontSize=this.orgFontSize,this.updateText();for(;this.width>this.maxUserWidth&&(--this.fontSize,this.updateText(),!(this.fontSize<5)););}!this.skipCaching&&this.cacheAsBitmap&&this.updateCache(),this.scale.setTo(t,e),this.alpha=i,this.angle=s},d.OneLineText.prototype.popUpAnimation=function(){this.cacheAsBitmap=!1;for(var t=this.children.length,i=[],e=0;e<t;e++)i[e]=e;i=Phaser.ArrayUtils.shuffle(i),delay_index=0,this.activeTweens=0,this.children.forEach(function(t){0==t.anchor.x&&(t.x=t.x+.5*t.width,t.y=t.y+t.height,t.anchor.setTo(.5,1));var e=t.scale.x,t=(t.scale.setTo(0,0),this.activeTweens++,game.add.tween(t.scale).to({x:1.5*e,y:1.5*e},200,Phaser.Easing.Quadratic.In,!1,25*i[delay_index]).to({x:e,y:e},200,Phaser.Easing.Sinusoidal.In));t.onComplete.add(function(){this.activeTweens--,0==this.activeTweens&&this.alive&&!this.skipCaching&&(this.cacheAsBitmap=!0)},this),t.start(),delay_index++},this)},d.OneLineText.prototype.scaleOut=function(t,e){this.cacheAsBitmap=!1,this.activeTweens=0,this.children.forEach(function(t,e){0==t.anchor.x&&(t.x=t.x+.5*t.width,t.y=t.y+.5*t.height,t.anchor.setTo(.5,.5)),this.activeTweens++,t.scale.setTo(t.scale.x,t.scale.y);t=game.add.tween(t.scale).to({x:0,y:0},400,Phaser.Easing.Cubic.In,!1,20*e);t.onComplete.add(function(){this.activeTweens--,0==this.activeTweens&&this.destroy()},this),t.start()},this)},d.OneLineCounter=function(t,e,i,s,a,n,o,r,h,l){d.OneLineText.call(this,t,e,i,"",a,n,o,r),this.amount=s,this.amountDisplayed=s,this.amountMaxInterval=5,this.amountMaxNegInterval=-5,this.absoluteDisplay=!1,this.fixedToDecimal=0,this.stepCurrent=0,this.step=0,this.preText=h||"",this.postText=l||"",this.setText(this.preText+s+this.postText)},d.OneLineCounter.prototype=Object.create(d.OneLineText.prototype),d.OneLineCounter.prototype.update=function(){var t;this.lerp?this.lerpUpdate():this.amountDisplayed!=this.amount&&this.stepCurrent--<=0&&(this.stepCurrent=this.step,this.amountDisplayed!=this.amount)&&(t=this.amount-this.amountDisplayed,this.amountDisplayed+=game.math.clamp(t,this.amountMaxNegInterval,this.amountMaxInterval),t=this.amountDisplayed,this.absoluteDisplay&&(t=Math.abs(t)),0!=this.fixedTo&&(t=t.toFixed(this.fixedToDecimal)),this.setText(this.preText+t+this.postText))},d.OneLineCounter.prototype.changeAmount=function(t){this.amount=t},d.OneLineCounter.prototype.increaseAmount=function(t){this.amount+=t},d.OneLineCounter.prototype.changeIntervals=function(t,e){void 0===e?(this.amountMaxInterval=t,this.amountMaxNegInterval=-t):(this.amountMaxInterval=t,this.amountMaxNegInterval=e)},d.OneLineCounter.prototype.lerpUpdate=function(){this.amountDisplayed!=this.amount&&this.stepCurrent--<=0&&(this.stepCurrent=this.step,this.amountDisplayed=Math.round(d.lerp(this.amountDisplayed,this.amount,.5,.6)),this.setText(this.amountDisplayed.toString()))},d.PartCacher=function(){Phaser.Group.call(this,game),this.active=!1,this.every=1,this.rt=game.add.renderTexture(10,10),this.frameCounter=0,this.framesToRecord=null},d.PartCacher.prototype=Object.create(Phaser.Group.prototype),d.PartCacher.prototype.update=function(){this.active&&(this.stepForward(),this.checkChildren()?(this.frameCounter%this.frameRate==0&&(this.saveFrame(),this.frameNr++,null!==this.framesToRecord)&&(this.framesToRecord--,0==this.framesToRecord)&&(this.active=!1),this.frameCounter++):(this.active=!1,this.removeAll(!0,!0)))},d.PartCacher.prototype.stepForward=function(){for(var t=this.children.length;t--;)this.children[t].update()},d.PartCacher.prototype.start=function(t,e,i){this.fileName=t,this.frameNr=0,this.frameRate=60/e,this.active=!0,this.frameCounter=0,this.framesToRecord=i||null},d.PartCacher.prototype.saveFrame=function(){var t=this.getBounds(),e=Math.max(this.x-t.x,t.x+t.width-this.x,400),t=Math.max(this.y-t.y,t.y+t.height-this.y,400),e=(this.rt.resize(2*e,2*t,!0),this.rt.renderXY(this,e,t,!0),this.rt.getCanvas()),i=this.fileName+"_"+this.frameNr;e.toBlob(function(t){n(t,i)})},d.PartCacher.prototype.checkChildren=function(){var t=this.children.filter(function(t){return!t.alive||0===t.alpha||0==t.scale.x||0==t.scale.y});return this.children.length!==t.length},d.PoolGroup=function(t,e,i,s){if(Phaser.Group.call(this,game),this._deadArray=[],this._elementConstructor=t,this._argumentsArray=e||[],this._argumentsArray.unshift(null),i&&d.sb(i).add(this.init,this),s)for(var a=0;a<s;a++)element=new(Function.prototype.bind.apply(this._elementConstructor,this._argumentsArray)),this.add(element),element.events.onKilled.add(this._onElementKilled,this),element.kill()},d.PoolGroup.prototype=Object.create(Phaser.Group.prototype),d.PoolGroup.prototype.getFreeElement=function(){var t;return 0<this._deadArray.length?t=this._deadArray.pop():(t=new(Function.prototype.bind.apply(this._elementConstructor,this._argumentsArray))).events.onKilled.add(this._onElementKilled,this),this.add(t),t},d.PoolGroup.prototype._onElementKilled=function(t){this===t.parent&&(this._deadArray.push(t),this.removeChild(t))},d.PoolGroup.prototype.init=function(){var t=this.getFreeElement();return t.init.apply(t,arguments),t},d.PoolGroup.prototype.initBatch=function(t){for(var e=0;e<t;e++)this.init.apply(this,[].slice.call(arguments,1))},d.PreloaderBar=function(){Phaser.Group.call(this,game),this.fixedToCamera=!0,this.softgamesBtn=game.add.button(0,200,"sg_logo",function(){SG_Hooks.triggerMoreGames()},this),this.softgamesBtn.anchor.setTo(.5,.5),this.add(this.softgamesBtn),this.gfx=game.add.graphics(),this.add(this.gfx),this.drawProgress(0),d.sb("onScreenResize").add(this.onResize,this),this.onResize(),game.load.onFileComplete.add(this.drawProgress,this)},d.PreloaderBar.prototype=Object.create(Phaser.Group.prototype),d.PreloaderBar.prototype.onResize=function(){this.cameraOffset.x=.5*game.width,this.cameraOffset.y=.4*game.height},d.PreloaderBar.prototype.drawProgress=function(t){this.gfx.clear(),this.gfx.lineStyle(2,16777215,1),this.gfx.beginFill(0,1),this.gfx.drawRect(-150,0,300,50),this.gfx.beginFill(16777215,1),this.gfx.drawRect(-145,5,t/100*290,40)},d.ProgressBar=function(t,e,i,s,a,n,o){d.Image.call(this,t,e,i+"_empty",0,null),this.fill=d.makeImage(n=void 0===n?0:n,o=void 0===o?0:n,i+"_full",0,this),this.fillFullWidth=this.fill.width,this.fillOverlay=d.makeImage(n,o,i+"_full_overlay",this.fill,this),this.fillOverlay.alpha=0,this.fill.cropRect=new Phaser.Rectangle(0,0,0,this.fill.height),this.fill.updateCrop(),this.currentValue=s,this.prevCurrentValue=s,this.targetValue=s,this.maxValue=a,this.lerpValue=.05,this.updateBarCrop(),this.onTargetReached=new Phaser.Signal,this.onBarFilled=new Phaser.Signal},d.ProgressBar.prototype=Object.create(d.Image.prototype),d.ProgressBar.prototype.update=function(){this.currentValue!==this.targetValue&&(this.currentValue=d.lerp(this.currentValue,this.targetValue,this.lerpValue,.005*this.maxValue),this.currentValue===this.targetValue)&&this.onTargetReached.dispatch(),this.currentValue!==this.prevCurrentValue&&(this.updateBarCrop(),this.currentValue===this.maxValue&&(game.add.tween(this.fillOverlay).to({alpha:1},300,Phaser.Easing.Sinusoidal.InOut,!0,0,0,!0),this.onBarFilled.dispatch(),this.label)&&game.add.tween(this.label).to({alpha:0},600,Phaser.Easing.Sinusoidal.InOut,!0),this.label)&&Math.floor(this.currentValue)!==Math.floor(this.prevCurrentValue)&&(console.log("updating label"),this.label.updateValue(Math.floor(this.currentValue))),this.prevCurrentValue=this.currentValue},d.ProgressBar.prototype.updateBarCrop=function(){var t=this.fill.cropRect.width,e=Math.round(this.fillFullWidth*(this.currentValue/this.maxValue));t!==e&&(this.fill.cropRect.width=e,this.fill.updateCrop())},d.ProgressBar.prototype.changeCurrentValue=function(t,e){this.targetValue=game.math.clamp(t,0,this.maxValue),this.lerpValue=e||this.lerpValue},d.ProgressBar.prototype.increaseCurrentValue=function(t){this.changeCurrentValue(this.targetValue+(t||1))},d.ProgressBar.prototype.decreaseCurrentValue=function(t){this.changeCurrentValue(this.targetValue-(t||1))},d.ProgressBar.prototype.changeValues=function(t,e){this.currentValue=t,this.prevCurrentValue=t,this.targetValue=t,this.maxValue=e,this.label&&this.label.changeValues(t,e),this.updateBarCrop()},d.ProgressBar.prototype.addLabel=function(t,e){this.label=new d.ProgressBar.Label(d.rl(.5*this.width),d.rl(.5*this.height),this.currentValue,this.maxValue,Math.floor(.6*d.rl(this.height)),d.rl(.7*this.width),t,e),this.add(this.label)},d.ProgressBar.Label=function(t,e,i,s,a,n,o,r){d.OneLineText.call(this,t,e,"font","",a,n,.5,.5),this.labelType=o||0,this.labelType1Text=d.txt("%AMOUNT% left"),this.currentValue=i,this.maxValue=s,this.animationOnIncrease=r||!1,this.updateValue(this.currentValue,!0)},d.ProgressBar.Label.prototype=Object.create(d.OneLineText.prototype),d.ProgressBar.Label.prototype.updateValue=function(t,e){!e&&Math.min(t,this.maxValue)===this.currentValue||(this.currentValue=t,this.updateLabelText(),e)||!this.animationOnIncrease||(d.stopTweens(this),this.scale.setTo(1),game.add.tween(this.scale).to({x:1.2,y:1.2},200,Phaser.Easing.Sinusoidal.InOut,!0,0,0,!0))},d.ProgressBar.Label.prototype.changeValues=function(t,e){this.currentValue=t,this.maxValue=e,this.alpha=this.currentValue<this.maxValue?1:0,this.updateLabelText()},d.ProgressBar.Label.prototype.updateLabelText=function(){0==this.labelType?this.setText(this.currentValue+"/"+this.maxValue):this.setText(this.labelType1Text.replace("%AMOUNT%",this.maxValue-this.currentValue))},(d=void 0===d?{}:d).SignalBox=(Phaser.Signal.prototype.addPermanent||(Phaser.Signal.prototype.addPermanent=function(){var t=this.add.apply(this,arguments);return t._PERMANENT=!0,t},Phaser.Signal.prototype.removeNonPermanent=function(){if(this._bindings)for(var t=this._bindings.length;t--;)this._bindings[t]._PERMANENT||(this._bindings[t]._destroy(),this._bindings.splice(t,1))}),e={},t.signals=e,t.clearNonPermanent=i,t.clearAll=function(){Object.keys(e).forEach(function(t){e[t].removeAll()})},t),d.Slider=function(t,e,i,s){Phaser.Graphics.call(this,game,t,e),this.sliderWidth=i,this.pos=s,this.beginFill(0,1),this.drawRect(0,-2,this.sliderWidth,4),this.circleGfx=this.addChild(game.make.graphics(i*s,0)),this.circleGfx.clear(),this.circleGfx.lineStyle(1,0,1),this.circleGfx.beginFill(10066329,1),this.circleGfx.drawCircle(0,0,32),this.circleGfx.sliderWidth=i,this.circleGfx.inputEnabled=!0,this.circleGfx.input.useHandCursor=!0,this.circleGfx.input.draggable=!0,this.circleGfx.input.setDragLock(!0,!1)},d.Slider.prototype=Object.create(Phaser.Graphics.prototype),d.Slider.prototype.update=function(){this.circleGfx.x=game.math.clamp(this.circleGfx.x,0,this.sliderWidth),this.pos=this.circleGfx.x/this.sliderWidth},d.SliderPanel=function(t,e,i,s,a,n){Phaser.Group.call(this,game),this.sliderWidth=d.l(i),this.sliderHeight=d.l(s),this.x=t+-.5*this.sliderWidth,this.y=e+-.5*this.sliderHeight,this.gfxMask=game.add.graphics(),this.gfxMask.beginFill(0,1),this.gfxMask.drawRect(0,0,i,s),this.clickableObjects=[],this.config=n,this.applyConfig(this.config),this.addContent(a),this.add(this.gfxMask),this.contentGroup.mask=this.gfxMask,this.slideY=0,this.inputSprite=d.makeImage(0,0,null,0,this),this.inputSprite.inputEnabled=!0,this.inputSprite.hitArea=new Phaser.Rectangle(0,0,i,s),this.inputSpriteDown=!1,this.inputData={x:null,y:null,velX:0,velY:0,xStart:null,yStart:null,startFrameStamp:null,clickDistanceWindow:10,clickTimeWindow:10},this.inputSprite.events.onInputDown.add(function(t){var e=game.input.activePointer;this.inputSpriteDown=!0,this.inputData.x=this.inputData.xStart=e.worldX,this.inputData.y=this.inputData.yStart=e.worldY,this.inputData.startFrameStamp=this.frameCounter},this),this.inputSprite.events.onInputUp.add(function(){var t=game.input.activePointer,e=(this.inputSpriteDown=!1,game.math.distance(this.inputData.xStart,this.inputData.yStart,t.worldX,t.worldY)),i=this.frameCounter-this.inputData.startFrameStamp;e<=this.inputData.clickDistanceWindow&&i<=this.inputData.clickTimeWindow&&(this.propagateClick(t.x,t.y),this.inputData.velX=0,this.inputData.velY=0)},this),this.frameCounter=0},d.SliderPanel.prototype=Object.create(Phaser.Group.prototype),d.SliderPanel.prototype.applyConfig=function(t){this.horizontal=t.horizontal||!1,this.horizontalLerp=t.horizontalLerp||!1,this.vertical=t.vertical||!0,this.verticalLerp=t.verticalLerp},d.SliderPanel.prototype.addContent=function(t){this.changeInputSettings(t),this.contentGroup=t,this.add(t),this.contentGroup.x=0,this.contentGroupMinY=-this.contentGroup.height+this.sliderHeight,this.contentGroupMaxY=0,this.contentGroupMinX=this.sliderWidth-this.contentGroup.width,this.contentGroupMaxX=0},d.SliderPanel.prototype.changeInputSettings=function(t){for(var e=t.children.length;e--;){var i=t.children[e];i.inputEnabled&&(this.clickableObjects.push(i),i.inputEnabled=!1),0<i.children.length&&this.changeInputSettings(i)}},d.SliderPanel.prototype.update=function(){var t,e;this.frameCounter++,this.inputSpriteDown&&game.input.activePointer.isDown?(t=this.inputData.x-game.input.activePointer.worldX,e=this.inputData.y-game.input.activePointer.worldY,this.inputData.x=game.input.activePointer.worldX,this.inputData.y=game.input.activePointer.worldY,this.inputData.velX=.8*t+.2*this.inputData.velX,this.inputData.velY=.8*e+.2*this.inputData.velY,this.horizontal&&(this.contentGroup.x-=this.inputData.velX),this.vertical&&(this.contentGroup.y-=this.inputData.velY)):(this.horizontal&&(this.contentGroup.x-=this.inputData.velX,this.inputData.velX*=.95,Math.abs(this.inputData.velX)<1)&&(this.inputData.velX=0),this.vertical&&(this.contentGroup.y-=this.inputData.velY,this.inputData.velY*=.95,Math.abs(this.inputData.velY)<1)&&(this.inputData.velY=0)),this.vertical&&this.boundRestrict("y",this.verticalLerp,this.contentGroupMinY,this.contentGroupMaxY),this.horizontal&&this.boundRestrict("x",this.horizontalLerp,this.contentGroupMinX,this.contentGroupMaxX),this.boundRestrict()},d.SliderPanel.prototype.propagateClick=function(t,e){for(var i=0;i<this.clickableObjects.length;i++)if(this.clickableObjects[i].visible&&this.clickableObjects[i].getBounds().contains(t,e)){this.clickableObjects[i].onInputDown.dispatch();break}},d.SliderPanel.prototype.boundRestrict=function(t,e,i,s){e?(this.contentGroup[t]>s&&(this.contentGroup[t]=d.lerp(this.contentGroup[t],s,.5),this.contentGroup[t]<s+1)&&(this.contentGroup[t]=s),this.contentGroup[t]<i&&(this.contentGroup[t]=d.lerp(this.contentGroup[t],i,.2),this.contentGroup[t]>i-1)&&(this.contentGroup[t]=i)):this.contentGroup[t]=game.math.clamp(this.contentGroup[t],i,s)},d.StrObjGroup=function(t,e,i){Phaser.Group.call(this,game),this.x=t||0,this.y=e||0,this.importObj="string"==typeof i?JSON.parse(i):i,this.parseImportObj(this.importObj)},d.StrObjGroup.prototype=Object.create(Phaser.Group.prototype),d.StrObjGroup.prototype.parseImportObj=function(t){for(var e=0;e<t.length;e++){var i=t[e],s=d.makeImage(i.x,i.y,i.frame,i.anchor,this);s.scale.setTo(i.scale[0],i.scale[1]),s.angle=i.angle}},d.Text=function(t,e,i,s,a,n,o,r,h){"object"!=typeof s&&(s=JSON.parse(JSON.stringify(d.Text.styles[s]))),this.userMaxWidth=n||1/0,this.userMaxHeight=o||1/0,r&&(s.wordWrap=!0,s.wordWrapWidth=n,s.align=h||"left"),Phaser.Text.call(this,game,t,e,i,s),a&&("number"==typeof a?this.anchor.setTo(a):this.anchor.setTo(a[0],a[1])),this.width=Math.min(this.width,this.userMaxWidth),this.height=Math.min(this.height,this.userMaxHeight)},d.Text.prototype=Object.create(Phaser.Text.prototype),d.Text.styles={},d.Text.addStyle=function(t,e){d.Text.styles[t]=e},d.Text.prototype.setText=function(t){Phaser.Text.prototype.setText.call(this,t),this.scale.setTo(1),this.width=Math.min(this.width,this.userMaxWidth),this.height=Math.min(this.height,this.userMaxHeight)},d.TextCounter=function(t,e,i,s,a,n,o){this.amount=i,this.amountDisplayed=i,d.Text.call(this,t,e,null===i?"...":i.toString(),s,a,n),o=o||{lerpValue:.5},this.lerp=!0,this.lerpValue=o.lerpValue,this.stepCurrent=0,this.step=0},d.TextCounter.prototype=Object.create(d.Text.prototype),d.TextCounter.prototype.setAmount=function(t,e){this.amount=t,e&&(this.amountDisplayed=t,this.setText(this.amountDisplayed.toString()))},d.TextCounter.prototype.changeAmount=function(t,e){this.amount+=t,e&&(this.amountDisplayed=this.amount,this.setText(this.amountDisplayed.toString()))},d.TextCounter.prototype.update=function(){this.amountDisplayed!=this.amount&&this.stepCurrent--<=0&&(this.stepCurrent=this.step,this.lerp)&&this.lerpUpdate()},d.TextCounter.prototype.lerpUpdate=function(){this.amountDisplayed=d.lerp(this.amountDisplayed,this.amount,this.lerpValue,.2),this.setText(Math.round(this.amountDisplayed).toString())},d.TextRTCacher=function(){},d.TextRTCacher.prototype.cacheText=function(t,e,i,s,a){this.txt||(this.txt=game.make.bitmapText(0,0,t,"",80)),this.txt.fontSize=i,this.txt.setText(e),this.txt.tint=a||16777215,this.txt.updateCache(),game.make.renderTexture(this.txt.width,this.txt.height,s,!0).render(this.txt)},d.TextRTCacher.prototype.cachePhaserText=function(t,e,i){t=game.make.text(0,0,t,i);game.make.renderTexture(t.width,t.height,e,!0).render(t),t.destroy()},d.Timer=function(t,e,i,s,a,n,o){d.OneLineText.call(this,t,e,i,"???",s,a,n,o),this.secLeft=0,this.active=!1,this.timerBinding=d.sb.onWallClockTimeUpdate.add(this.updateTimer,this),this.events.onDestroy.add(function(){this.timerBinding.detach()},this)},d.Timer.prototype=Object.create(d.OneLineText.prototype),d.Timer.prototype.updateTimer=function(){this.active&&(d.sfx.clock_tick.play(),this.secLeft=Math.max(0,this.secLeft-1),this.setText(d.changeSecToTimerFormat(this.secLeft)))},d.Timer.prototype.setSecLeft=function(t){this.secLeft=t,this.setText(d.changeSecToTimerFormat(this.secLeft))},d.Timer.prototype.start=function(t){this.active=!0},d.TimerT=function(t,e,i,s,a,n,o,r){d.Text.call(this,t,e,"???",s,a,n),this.secLeft=0,this.active=!1,this.timerFormat=o,this.dots=!0,this.sfx=r?d.sfx[sfs]:null,this.timerBinding=d.sb("onWallClockTimeUpdate").add(this.updateTimer,this),this.events.onDestroy.add(function(){this.timerBinding.detach()},this),i&&this.setDate(i)},d.TimerT.prototype=Object.create(d.Text.prototype),d.TimerT.prototype.updateTimer=function(){this.active&&(this.sfx&&this.sfx.play(),this.secLeft=Math.max(0,this.secLeft-1),this.updateTimerText(this.secLeft,this.dots),this.dots=!this.dots)},d.TimerT.prototype.setSecLeft=function(t){this.secLeft=Math.max(0,t),this.updateTimerText(this.secLeft,!0)},d.TimerT.prototype.updateTimerText=function(t,e){var i=d.changeSecToDHMS(this.secLeft),s=[];-1<this.timerFormat.indexOf("d")&&s.push(i[0]),-1<this.timerFormat.indexOf("h")&&s.push(i[1]),-1<this.timerFormat.indexOf("m")&&s.push(i[2]),-1<this.timerFormat.indexOf("s")&&s.push(i[3]),this.setText(s.join(e?":":" "))},d.TimerT.prototype.start=function(t){this.active=!0},d.TimerT.prototype.setDate=function(t){var t=new Date(t).getTime(),e=Date.now(),t=Math.ceil((t-e)/1e3);this.setSecLeft(t),this.active=!0},d.UITargetParticles=function(){d.PoolGroup.call(this,d.UITargetParticle),this.fixedToCamera=!0},d.UITargetParticles.prototype=Object.create(d.PoolGroup.prototype),d.UITargetParticles.prototype.initPart=function(t,e,i,s,a,n){return this.init(t,e,i,s,a)},d.UITargetParticles.prototype.createDividedBatch=function(t,e,i,s,a,n){for(var o=new d.UITargetParticles.BatchObj,r=(25<a/n&&(n=Math.ceil(a/25)),Math.floor(a/n)+Math.sign(a%n)),h=0;h<r;h++){var l=this.init(t,e,i,s,Math.min(n,a));a-=n,o.add(l)}return o},d.UITargetParticles.prototype.createBatch=function(t,e,i,s,a,n){for(var o,r=new d.UITargetParticles.BatchObj,h=Array.isArray(t),l=0;l<n;l++)o=h?this.init(t[l].x,t[l].y,i,s,a):this.init(t,e,i,s,a),r.add(o);return r},d.UITargetParticles.BatchObj=function(){this.parts=[],this.nrOfParts=0,this.nrOfFinished=0,this.onFinish=new Phaser.Signal},d.UITargetParticles.BatchObj.prototype.add=function(t){this.parts.push(t),t.onFinish.addOnce(this.onPartFinish,this),this.nrOfParts++},d.UITargetParticles.BatchObj.prototype.onPartFinish=function(){this.nrOfFinished++,this.nrOfFinished==this.nrOfParts&&this.onFinish.dispatch()},d.UITargetParticles.BatchObj.prototype.addOnPartStart=function(e,i){this.parts.forEach(function(t){t.onStart.addOnce(e,i||t,1)})},d.UITargetParticles.BatchObj.prototype.addOnPartFinish=function(e,i){this.parts.forEach(function(t){t.onFinish.addOnce(e,i||t,1)})},d.UITargetParticles.BatchObj.prototype.start=function(e){var i=0;this.parts.forEach(function(t){t.start(i),i+=e||0})},d.UITargetParticle=function(){d.Image.call(this,0,0,null,.5),this.onStart=new Phaser.Signal,this.onFinish=new Phaser.Signal,this.speed=0,this.speedMax=30,this.speedDelta=.75,this.vel=new Phaser.Point(0,0),this.velInit=new Phaser.Point(0,0),this.kill()},d.UITargetParticle.prototype=Object.create(d.Image.prototype),d.UITargetParticle.prototype.init=function(t,e,i,s,a){this.position.setTo(t,e),this.changeTexture(i),this.onStart.removeAll(),this.onFinish.removeAll(),this.carriedValue=a||1,this.targetObj=s,this.stopTweens(this),this.scale.setTo(1),this.alpha=1,this.speed=0,this.vel.setTo(0,0)},d.UITargetParticle.prototype.start=function(t){t?game.time.events.add(t,this.start,this):(this.revive(),this.onStart.dispatch(this,this.carriedValue))},d.UITargetParticle.prototype.update=function(){var t,e;this.alive&&(this.position.add(this.vel.x,this.vel.y),this.vel.x*=.95,this.vel.y*=.95,this.speed+=this.speedDelta,this.speed=Math.min(this.speed,this.speedMax),t=Phaser.Point.distance(this.worldPosition,this.targetObj.worldPosition),e=Phaser.Point.angle(this.targetObj.worldPosition,this.worldPosition),this.position.add(d.lengthDirX(e,Math.min(t,this.speed),!0),d.lengthDirY(e,Math.min(t,this.speed),!0)),t<1.2*this.speedMax)&&(this.onFinish.dispatch(this,this.carriedValue),this.kill())},void 0===d&&(d={}),Math.sign=Math.sign||function(t){return 0===(t=+t)||isNaN(t)?t:0<t?1:-1},d.isImageInCache=function(t){return""!=this.checkSheet(t)||game.cache.checkImageKey(t)},d.checkSheet=function(t){return d.spritesheetMap?d.spritesheetMap[t]||"":this.checkSheetOld()},d.checkSheetOld=function(){for(var t=0,e=d.ASSETS.spritesheets.length;t<e;t++){d.ASSETS.spritesheets[t];if(game.cache.checkImageKey(d.ASSETS.spritesheets[t])&&game.cache.getFrameData(d.ASSETS.spritesheets[t]).getFrameByName(frame))return d.ASSETS.spritesheets[t]}return""},d.lerp=function(t,e,i,s){return s&&Math.abs(t-e)<=s?e:t+i*(e-t)},d.l=function(t){return Math.floor(t*d.Loader.currentConfigMulti)},d.rl=function(t){return Math.floor(t*(1/d.Loader.currentConfigMulti))},d.lnf=function(t){return t*d.Loader.currentConfigMulti},d.rnd=function(t,e){return game.rnd.realInRange(t||0,e||1)},d.rndInt=function(t,e){return game.rnd.between(t,e)},d.changeTexture=function(t,e){if("string"!=typeof e)return t.loadTexture(e);var i=this.checkSheet(e);""==i?t.loadTexture(e):t.loadTexture(i,e)},d.txt=function(t){return d.lang||(d.lang="en"),d.json.languages[d.lang]||(d.lang="en"),d.json.languages[d.lang][t]||t+"***"},d.deltaTime=1,d.delta=function(){d.deltaTime=Math.min(1.5,game.time.elapsedMS/16),17==game.time.elapsedMS&&(d.deltaTime=1)},d.rotatePositions=function(t){for(var e=[],i=0,s=t.length;i<s;i+=2)e.push(-1*t[i+1],t[i]);return e},d.loadTexture=d.changeTexture,d.makeImage=function(t,e,i,s,a){var n=this.checkSheet(i),t=""==n?game.make.image(this.l(t),this.l(e),i):game.make.image(this.l(t),this.l(e),n,i);return s&&("number"==typeof s?t.anchor.setTo(s):t.anchor.setTo(s[0],s[1])),a?(a.add||a.addChild).call(a,t):null!==a&&game.world.add(t),t},d.capitalize=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},d.lengthDirX=function(t,e,i){return(i=i||!1)?Math.cos(t)*e:Math.cos(game.math.degToRad(t))*e},d.lengthDirY=function(t,e,i){return(i=i||!1)?Math.sin(t)*e:Math.sin(game.math.degToRad(t))*e},d.stopTweens=function(e){game.tweens._add.forEach(function(t){e.scale&&t.target==e.scale&&t.stop(),t.target==e&&t.stop()}),game.tweens._tweens.forEach(function(t){e.scale&&t.target==e.scale&&t.stop(),t.target==e&&t.stop()})},d.makeExtImage=function(t,e,s,i,a,n,o,r){var h,l,c;return d.extLoader||(d.extLoader=new d.ExtLoader(game)),d.extLoader.loadedUrls[s]?(h=d.makeImage(t,e,d.extLoader.loadedUrls[s],a,n),r.call(h)):((h=d.makeImage(t,e,i,a,n)).onImgLoaded=new Phaser.Signal,d.extImagesKeys||(d.extImagesKeys=[]),l="extImgBlankName"+d.extImagesKeys.length,c=(d.extImagesKeys.push(l),d.extLoader.onFileComplete.add(function(t,e,i){e==l&&i&&(d.extLoader.loadedUrls[s]=l,d.changeTexture(h,l),r&&r.call(h),c.detach())})),d.extLoader.image(l,s,!0)),h},d.drawCircleSegment=function(t,e,i,s,a,n,o){if(a!==n){for(var r=(n-a)/(o=void 0===o?10:o),h=(t.moveTo(e,i),t.currentPath.shape.points);a<=n;a+=r)h.push(Math.floor(e+d.lengthDirX(a,s,!1)),Math.floor(i+d.lengthDirY(a,s,!1)));h.push(Math.floor(e+d.lengthDirX(n,s,!1)),Math.floor(i+d.lengthDirY(n,s,!1))),t.dirty=!0,t._boundsDirty=!0}return t},d.centerElements=function(t,s,e){void 0===e&&(e=0),void 0===s&&(s=[]);var i=0,a=Array.isArray(s),n=(t.forEach(function(t,e){i+=t.width,(a?s[e-1]:void 0!==s)&&(i+=d.l(a?s[e-1]:s))}),e+-.5*i);t.forEach(function(t,e,i){t.x=n,t.x+=t.width*t.anchor.x,n+=t.width,(a?s[e-1]:void 0!==s)&&(n+=d.l(a?s[e]:s))})},d.centerElements2=function(t,s,a){void 0===a&&(a=0),void 0===s&&(s=0);var n=0;t.forEach(function(t,e){n+=t.width}),n+=s*(t.length-1),t.forEach(function(t,e,i){t.left=0==e?a+-.5*n:i[e-1].right+s})},d.makeMover=function(e){void 0!==d.activeMover&&(d.activeMover.destroy(),d.activeMover.eKey.onDown.removeAll()),d.activeMover=game.add.image(),d.activeMover.obj=e,d.activeMover.cursors=game.input.keyboard.createCursorKeys(),d.activeMover.shiftKey=game.input.keyboard.addKey(Phaser.Keyboard.SHIFT),d.activeMover.eKey=game.input.keyboard.addKey(Phaser.Keyboard.E),d.activeMover.eKey.onDown.add(function(){console.log("MOVER: "+this.obj.x+"x"+this.obj.y)},d.activeMover),d.activeMover.update=function(){var t=this.shiftKey.isDown?10:2;this.cursors.down.isDown&&(e.y+=t),this.cursors.up.isDown&&(e.y-=t),this.cursors.left.isDown&&(e.x-=t),this.cursors.right.isDown&&(e.x+=t)}},d.makeLineEditor=function(t){var a=game.add.group();return a.interpolation=t||"linear",a.pointsX=[0],a.pointsY=[0],a.gfx=a.add(game.make.graphics()),a.shiftKey=game.input.keyboard.addKey(Phaser.Keyboard.SHIFT),a.wKey=game.input.keyboard.addKey(Phaser.Keyboard.W),a.wKey.onDown.add(function(){var t=2<this.children.length?(e=this.children[this.children.length-1].x,this.children[this.children.length-1].y):e=0,e=d.makeImage(e,t,"candy_1");e.anchor.setTo(.5),e.scale.setTo(.1),this.add(e),this.activeObject=e,this.changed=!0},a),a.qKey=game.input.keyboard.addKey(Phaser.Keyboard.Q),a.qKey.onDown.add(function(){this.children.length<=2||(this.removeChildAt(this.children.length-1),3<this.children.length?this.activeObject=this.children[this.children.length-1]:this.activeObject=null,this.changed=!0)},a),a.aKey=game.input.keyboard.addKey(Phaser.Keyboard.A),a.aKey.onDown.add(function(){var t;this.activeObject&&2!=(t=this.getChildIndex(this.activeObject))&&(this.activeObject=this.getChildAt(t-1))},a),a.sKey=game.input.keyboard.addKey(Phaser.Keyboard.S),a.sKey.onDown.add(function(){var t;this.activeObject&&(t=this.getChildIndex(this.activeObject))!=this.children.length-1&&(this.activeObject=this.getChildAt(t+1))},a),a.eKey=game.input.keyboard.addKey(Phaser.Keyboard.E),a.eKey.onDown.add(function(){console.log(JSON.stringify([this.pointsX,this.pointsY]))},a),a.cursors=game.input.keyboard.createCursorKeys(),a.activeObject=null,a.preview=d.makeImage(0,0,"candy_2",.5,a),a.preview.width=8,a.preview.height=8,a.preview.progress=0,a.update=function(){if(null!==this.activeObject&&(this.forEach(function(t){t==this.activeObject?t.alpha=1:t.alpha=.5},this),0!=this.children.length)){var t=this.shiftKey.isDown?3:1;if(this.cursors.down.isDown&&(this.activeObject.y+=t,this.changed=!0),this.cursors.up.isDown&&(this.activeObject.y-=t,this.changed=!0),this.cursors.left.isDown&&(this.activeObject.x-=t,this.changed=!0),this.cursors.right.isDown&&(this.activeObject.x+=t,this.changed=!0),a.preview.progress+=.01,1<a.preview.progress&&(a.preview.progress=0),a.preview.x=game.math[this.interpolation+"Interpolation"](this.pointsX,a.preview.progress),a.preview.y=game.math[this.interpolation+"Interpolation"](this.pointsY,a.preview.progress),this.changed){var i=[],s=[];this.pointsX=i,this.pointsY=s,this.children.forEach(function(t,e){e<=1||(i.push(t.x),s.push(t.y))}),this.gfx.clear(),this.gfx.beginFill(16711680,1);for(var e=0;e<200;e++)this.gfx.drawRect(game.math[this.interpolation+"Interpolation"](i,e/200),game.math[this.interpolation+"Interpolation"](s,e/200),3,3)}}},a},d.lineUtils={getWholeDistance:function(t,e){for(var i=0,s=1;s<t.length;s++)i+=game.math.distance(t[s-1],e[s-1],t[s],e[s]);return i},findPointAtDitance:function(t,e,i){for(var s=0,a=1;a<t.length;a++){var n,o=game.math.distance(t[a-1],e[a-1],t[a],e[a]);if(i<o+s)return n=game.math.angleBetween(t[a-1],e[a-1],t[a],e[a]),[t[a-1]+d.lengthDirX(n,i-s,!0),e[a-1]+d.lengthDirY(n,i-s,!0)];s+=o}return[t[t.length-1],e[e.length-1]]},spreadAcrossLine:function(t,e,i,s,a){console.log("spreadAcrossLine");for(var n=this.getWholeDistance(t,e)/(i.length-1),o=0;o<i.length;o++){var r=this.findPointAtDitance(t,e,n*o);i[o][s||"x"]=r[0],i[o][a||"y"]=r[1]}},spreadOnNodes:function(t,e,i,s,a){console.log("SPREAD ON NODES"),console.log(arguments);for(var n=0;n<t.length;n++){if(console.log(n),void 0===i[n])return;i[n][s||"x"]=t[n],i[n][a||"y"]=e[n],console.log(n+" pos: "+t[n]+"x"+e[n])}}},d.changeSecToTimerFormat=function(t,e){var t=parseInt(t,10),i=!!e&&-1!==e.toUpperCase().indexOf("D"),e=!!e&&-1!==e.toUpperCase().indexOf("H"),s=Math.floor(t/86400),a=Math.floor((t-86400*s)/3600),n=Math.floor((t-86400*s-3600*a)/60),t=t-86400*s-3600*a-60*n,n=d.zeroPad(n)+":"+d.zeroPad(t);return(0<a||0<s||e)&&(n=d.zeroPad(a)+":"+n),n=0<s||i?d.zeroPad(s)+":"+n:n},d.changeSecToDHMS=function(t,e){var t=parseInt(t,10),e=(!e||e.toUpperCase().indexOf("D"),!e||e.toUpperCase().indexOf("H"),Math.floor(t/86400)),i=Math.floor((t-86400*e)/3600),s=Math.floor((t-86400*e-3600*i)/60),t=t-86400*e-3600*i-60*s;return[d.zeroPad(e),d.zeroPad(i),d.zeroPad(s),d.zeroPad(t)]},d.zeroPad=function(t){return t<10?"0"+t:t},d.arrayJoin=function(t,i){return t.reduce(function(t,e){return e?t?t+i+e:e:t},"")},d.makeTextButton=function(t,e,i,s,a,n){t=game.make.text(t,e,i,s);return t.inputEnabled=!0,t.input.useHandCursor=!0,t.hitArea=new Phaser.Rectangle(0,0,t.width,t.height),t.events.onInputDown.add(a,n||null),t},d.setObjProp=function(e,i,t){var s=e;"string"==typeof i&&i.split(".");try{for(var a=0;a<this.refreshProp.length-1;a++)s=s[this.refreshProp[a]];s[this.refreshProp[this.refreshProp.length-1]]=t}catch(t){console.warn("cant set prop"),console.log(e),console.log(i)}},d.getObjProp=function(t,e){var i=t;"string"==typeof e&&(e=e.split("."));try{for(var s=0;s<e.length;s++)i=i[e[s]]}catch(t){return}return i},(d=void 0===d?{}:d).Utils={cacheText:function(t,e,i,s,a){(e=game.make.bitmapText(0,0,i,e,s)).tint=a||16777215,e.updateCache(),game.make.renderTexture(e.width,e.height,t,!0).render(e),e.destroy()},cacheGText:function(t,e,i){e=new d.Text(0,0,e,i,0);game.make.renderTexture(e.width,e.height,t,!0).render(e),e.destroy()},lerp:function(t,e,i,s){return s&&Math.abs(t-e)<=s?e:t+i*(e-t)},copyToClipboard:function(t){this.copyArea||(this.copyArea=document.createElement("textarea"),this.copyArea.style.positon="fixed",this.copyArea.style.opacity=0,document.body.appendChild(this.copyArea)),this.copyArea.value=t,this.copyArea.select(),document.execCommand("copy")},getObjProp:function(t,e){var i=t;"string"==typeof e&&(e=e.split("."));try{for(var s=0;s<e.length;s++)i=i[e[s]]}catch(t){return}return i},setObjProp:function(t,e,i){var s=t;"string"==typeof e&&(e=e.split("."));try{for(var a=0;a<e.length-1;a++)s=s[e[a]];s[e[e.length-1]]=i}catch(t){return null}},replaceAll:function(t,e,i){return t.split(e).join(i)},removeDuplicates:function(t){var e=[];return t.forEach(function(t){-1===e.indexOf(t)&&e.push(t)}),e},getParentsScaleX:function(t,e){return t==game.stage?1:d.Utils.getParentsScaleX(t.parent,!0)*(e?t.scale.x:1)},getParentsScaleY:function(t,e){return t==game.stage?1:d.Utils.getParentsScaleY(t.parent,!0)*(e?t.scale.y:1)},makeTextButton:function(t,e,i,s,a,n){t=game.add.text(t,e,i,n);return t.inputEnabled=!0,t.input.useHandCursor=!0,t.hitArea=new Phaser.Rectangle(0,0,t.width,t.height),t.events.onInputDown.add(s,a),t},injectCSS:function(t){var e=document.createElement("style");e.type="text/css",e.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(e)},toClientX:function(t){return(parseInt(game.canvas.style.marginLeft)||0)+t/game.width*game.canvas.clientWidth},toClientY:function(t){return(parseInt(game.canvas.style.marginTop)||0)+t/game.height*game.canvas.clientHeight},clientXToWorldX:function(t){t-=parseInt(game.canvas.style.marginLeft)||0;var e=parseInt(game.canvas.style.width),i=(parseInt(game.canvas.style.height),parseInt(game.canvas.width));parseInt(game.canvas.height);return t*(i/e)},clientYToWorldY:function(t){t-=parseInt(game.canvas.style.marginTop)||0,parseInt(game.canvas.style.width);var e=parseInt(game.canvas.style.height);parseInt(game.canvas.width);return t*(parseInt(game.canvas.height)/e)},getImageURI:function(t){return this._bmpMarker||(this._bmpMarker=d.makeImage(0,0,null,0,null)),this._bmp||(this._bmp=game.make.bitmapData()),this._bmp.clear(),d.changeTexture(this._bmpMarker,t),this._bmp.resize(this._bmpMarker.width,this._bmpMarker.height),this._bmp.draw(this._bmpMarker),this._bmp.canvas.toDataURL()},getRT:function(t){return game.cache.getRenderTexture(t).texture},arraysEqual:function(t,e){if(t!==e){if(null==t||null==e)return!1;if(t.length!=e.length)return!1;for(var i=0;i<t.length;++i)if(t[i]!==e[i])return!1}return!0}},d.lineCircleColl=function(t,e,i){var s=t.start,a=t.end,n=Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2)),o=(a.x-s.x)/n,a=(a.y-s.y)/n,n=o*(e.x-s.x)+a*(e.y-s.y),r=n*o+s.x,h=n*a+s.y,r=Math.sqrt(Math.pow(r-e.x,2)+Math.pow(h-e.y,2));return r<e.radius&&(e=(n-(h=Math.sqrt(e.radius*e.radius-r*r)))*o+s.x,r=(n-h)*a+s.y,o=(n+h)*o+s.x,n=(n+h)*a+s.y,(h=game.math.distance(s.x,s.y,e,r))<(a=game.math.distance(s.x,s.y,o,n))?t.length>h&&(i.setTo(e,r),i):t.length>a&&(i.setTo(o,n),i))},d.getRT=function(t){t=game.cache.getRenderTexture(t);return t?t.texture:null},d.numberDot=function(t){for(var e="",i=0,s=(t=t.toString()).length-1;0<=s;s--)e=t[s]+e,3==++i&&0!==s&&(e="."+e,i=0);return e},d.guid=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},d.AnimationElement=function(t,e,i,s){d.Image.call(this,t,e,null),this.ANIMATIONELEMENT=!0,this.SPR=new d.Image(0,0,null,.5,this),this.frameCounter=0,this.data=i,this.currentAnimationData=null,this.currentAnimationName=null,this.playing=void 0===s||s},d.AnimationElement.prototype=Object.create(d.Image.prototype),d.AnimationElement.prototype.update=function(){this.currentAnimationName&&this.playing&&(this.frameCounter++,this.updateAnimation(this.frameCounter))},d.AnimationElement.prototype.pause=function(){this.playing=!1},d.AnimationElement.prototype.resume=function(){this.playing=!0},d.AnimationElement.prototype.play=function(){this.playing=!0},d.AnimationElement.prototype.stop=function(){this.playing=!1,this.updateAnimation(0)};d.AnimationElement.prototype.changeAnimationData=function(t){this.data[t]||(t=Object.keys(this.data)[0]),this.eventTL=this.data[t].eventTL,this.frameTL=this.data[t].frameTL,this.propTLS=this.data[t].propTLS,this.propKeys=Object.keys(this.propTLS),this.currentAnimationData=this.data[t],this.currentAnimationName=t,this.updateAnimation(0)},d.AnimationElement.prototype.playAnimation=function(t){this.changeAnimationData(t),this.playing=!0},d.AnimationElement.prototype.getLastKeyFrame=function(t,e){for(var i=t.length,s=0;s<i;s++){if(t[s].f==e||s==i-1)return t[s];if(t[s].f<e&&e<t[s+1].f)return t[s]}},d.AnimationElement.prototype.getNextKeyFrame=function(t,e){for(var i=t.length,s=0;s<i;s++)if(t[s].f>t||s==i-1)return t[s]},d.AnimationElement.prototype.getKeyFrameAt=function(t,e){if(this.currentAnimationName)for(var i=0;i<t.length;i++){var s=t[i];if(s.f===e)return s}return null},d.AnimationElement.prototype.isAnyKeyFrameAt=function(t){if(this.currentAnimationName){if(this.getKeyFrameAt(this.eventTL,t))return!0;if(this.getKeyFrameAt(this.frameTL,t))return!0;for(var e=0;e<this.propKeys.length;e++){var i=this.propKeys[e];if(this.getKeyFrameAt(this.propTLS[i],t))return!0}}return!1},d.AnimationElement.prototype.getFrameValue=function(t,e){var i,s=this.getLastKeyFrame(t,e),t=this.getNextKeyFrame(t,e);return s.e?(i=t.f-s.f,t=t.v-s.v,e=Phaser.Easing[s.e[0]][s.e[1]]((e-s.f)/i),s.v+t*e):s.v},d.AnimationElement.prototype.updateAnimation=function(t){this.currentAnimationName&&(this.frameCounter=t,this.updateFromPropTLS(t),t=this.getTextureFrameValue(this.frameTL,t),this.SPR.key!=t)&&this.SPR.frameName!=t&&d.changeTexture(this.SPR,t)},d.AnimationElement.prototype.updateFromPropTLS=function(t){for(var e=0;e<this.propKeys.length;e++){var i=this.propKeys[e];this.setProp(i,this.getFrameValue(this.propTLS[i],t))}},d.AnimationElement.prototype.setProp=function(t,e){"scale.x"==t?this.SPR.scale.x=e:"scale.y"==t?this.SPR.scale.y=e:"anchor.x"==t?this.SPR.anchor.x=e:"anchor.y"==t?this.SPR.anchor.y=e:this.SPR[t]=e},d.AnimationElement.prototype.getTextureFrameValue=function(t,e){var t=this.getLastKeyFrame(t,e),i=t.frameSkip||1,e=e-t.f,e=Math.floor(e/i);return t.animation?(i=t.v.length,t.loop?t.refraction||t.reverse?t.refraction&&!t.reverse?t.v[Math.min(i-1,e%(i+t.refraction))]:void 0:t.v[e%i]:t.v[Math.min(i-1,e)]):t.v},d.GroupColliderLineLine=function(t,e,i,s){d.Image.call(this,0,0,null),this.group1=t,this.group2=e,this.callback=i,this.context=s||null,this.collPoint=new Phaser.Point(0,0)},d.GroupColliderLineLine.prototype=Object.create(d.Image.prototype),d.GroupColliderLineLine.prototype.update=function(){for(var t=this.group1.length,e=this.group2.length,i=0;i<t;i++)for(var s=this.group1.children[i],a=0;a<e;a++){var n=this.group2.children[a];s!==n&&s.collLine.intersects(n.collLine,!0,this.collPoint)&&this.callback.call(this.context,s,n,this.collPoint,this.group1,this.group2)}},d.GroupColliderLineCircle=function(t,e,i,s){d.Image.call(this,0,0,null),this.group1=t,this.group2=e,this.callback=i,this.context=s||null,this.collPoint=new Phaser.Point(0,0)},d.GroupColliderLineCircle.prototype=Object.create(d.Image.prototype),d.GroupColliderLineCircle.prototype.update=function(){this.group1.length,this.group2.length;for(var t=this.group1.length;t--;)for(var e=this.group1.children[t],i=this.group2.length;i--;){var s=this.group2.children[i];e!==s&&d.lineCircleColl(e.collLine,s.collCircle,this.collPoint)&&this.callback.call(this.context,e,s,this.collPoint,this.group1,this.group2)}},Phaser.Group.prototype.destroy=function(t,e){null===this.game||this.ignoreDestroy||(this.onDestroy.dispatch(this,t=void 0===t?!0:t,e=void 0===e?!1:e),this.removeAll(t),this.cursor=null,this.filters=null,this.alive=!1,this.pendingDestroy=!1,e)||(this.parent&&this.parent.removeChild(this),this.game=null,this.exists=!1)},Phaser.exportChildren=function(t){for(var e=[],i=0;i<t.children.length;i++){var s=t.children[i];s.exportToString&&e.push(s.exportToString())}return e},Phaser.Group.prototype.exportToString=function(){return{type:"GROUP",x:this.x,y:this.y,scale:[this.scale.x,this.scale.y],angle:this.angle,children:Phaser.exportChildren(this)}},Phaser.Image.prototype.exportToString=function(){return exportObj={type:"IMG",x:this.x,y:this.y,frame:this.frameName,anchor:[this.anchor.x,this.anchor.y],scale:[this.scale.x,this.scale.y],angle:this.angle,children:Phaser.exportChildren(this)}},(d=void 0===d?{}:d).ASSETS={spritesheets:["gems","ssheet"],sfx:["boom.mp3","btn_pressed.mp3","firework.mp3","firework2.mp3","game_over.mp3","game_won.mp3","match.mp3","music.mp3","new_highscore.mp3","new_level.mp3","pop.mp3","score_counter.mp3","stone_selection.mp3","timer.mp3"],images:[],json:["languages.json","settings.json"],fonts:{font:{data:"font.fnt",frame:"font.png"}}},d.Boot=function(t){},d.Boot.prototype={init:function(){this.scale.pageAlignHorizontally=!0,this.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.scale.fullScreenScaleMode=Phaser.ScaleManager.SHOW_ALL,this.stage.backgroundColor=0,this.input.maxPointers=1,this.stage.disableVisibilityChange=!0,game.tweens.frameBased=!0,game.time.advancedTiming=!0,game.input.mouse.enabled=!game.device.mspointer,this.game.device.desktop||(this.orientationDiv=document.getElementById("orientation"),this.scale.forceOrientation(!1,!0),this.scale.enterIncorrectOrientation.add(this.enterIncorrectOrientation,this),this.scale.leaveIncorrectOrientation.add(this.leaveIncorrectOrientation,this)),this.scaleGameSizeUpdate=function(){var t,e,i=window.innerHeight/window.innerWidth,s=window.innerWidth/window.innerHeight;game.device.desktop?(t=d.l(1200),e=d.l(800),1.5<=s?game.scale.setGameSize(Math.max(t,Math.floor(s*e)),e):game.scale.setGameSize(t,Math.floor(i*t))):(t=d.l(800),e=d.l(1200),.666<s?game.scale.setGameSize(Math.max(t,Math.floor(s*e)),e):game.scale.setGameSize(t,Math.floor(i*t))),game.world.setBounds(0,0,game.width,game.height),d.sb("onScreenResize").dispatch()},d.sb=d.SignalBox,d.extLoader=new d.ExtLoader(game),game.resizeGame=this.scaleGameSizeUpdate,game.incentivised=window.sgSettings.config.rewarded.enabled,this.scale.setResizeCallback(function(){d.old_w==window.innerWidth&&d.old_h==window.innerHeight||(d.old_w=window.innerWidth,d.old_h=window.innerHeight,game.resizeGame())})},preload:function(){d.Loader.loadBootAssets(d.lang)},create:function(){game.resizeGame(),this.state.start("Preloader")},enterIncorrectOrientation:function(){"block"!==this.orientationDiv.style.display&&(this.orientationDiv.style.display="block","DIV"==game.canvas.parentElement.tagName)&&(game.canvas.parentElement.style.display="none")},leaveIncorrectOrientation:function(){"none"!==this.orientationDiv.style.display&&(this.orientationDiv.style.display="none","DIV"==game.canvas.parentElement.tagName)&&(game.canvas.parentElement.style.display="block")}},Phaser.Stage.prototype.visibilityChange=function(t){if("pagehide"===t.type||"blur"===t.type||"pageshow"===t.type||"focus"===t.type)"pagehide"===t.type||"blur"===t.type?this.game.focusLoss(t):"pageshow"!==t.type&&"focus"!==t.type||this.game.focusGain(t);else if(document.hidden||document.mozHidden||document.msHidden||document.webkitHidden||"pause"===t.type)game.sound.mute=!0,game.input.pointers.forEach(function(t){t.active=!1});else if(d.saveState.data)try{var e=d.saveState.data.mute;game.paused||(game.sound.mute=e)}catch(t){console.log(t)}else game.sound.mute=!1},d.Game=function(t){},d.Game.prototype={init:function(){this.lvlNr=d.saveState.getLevel();var t=15+this.lvlNr,e=["None","Down","None","UpDown","LeftRight","Left","None","Up","Right","LeftRight"],i=this.lvlNr%e.length;this.lvlData={gemTypes:t=42<t?42:t,timeSec:150,secForMatch:3,fallType:e[i]},this.hintsNr=d.saveState.getHintsAmount(),this.pause=!1,this.pauseWindow=null},create:function(){d.sfx.musicEnable&&d.sfx.new_level.play(),s=game.state.getCurrentState(),this.bg=new d.Background,this.board=new d.Board(this.lvlData),game.add.tween(this.board).from({alpha:0},500,Phaser.Easing.Sinusoidal.Out,!0),this.uiBar=new d.UIBar,game.device.desktop&&(this.soundBtn=new d.SoundBtn),this.hintBtn=new d.HintBtn,this.menuBtn=new d.MenuBtn,0<d.saveState.getTutorial()&&this.board.tutorial(!0),this.flyingGemsGroup=game.add.group(),this.flyingGemsGroup.fixedToCamera=!0,this.fadeInput=new d.FadeInput,d.sb("onTimesUp").add(this.onTimesUp,this),d.sb("onBoardEmpty").add(this.onBoardEmpty,this),d.sb("onBonusTimeZero").add(function(){this.autoSave=!1,game.state.start("Game",!0,!1,this.lvlNr+1)},this),this.comboUI=new d.ComboUI,this.fxLayer=new d.FxLayer(this.board),this.uiTargetParticles=new d.UITargetParticles,"MainMenu"==d.prevGameState&&game.camera.flash(0,600),d.prevGameState="Game",game.onPause.add(this.pauseOnBlur,this)},pauseOnBlur:function(){this.pauseWindow||!1!==window.sdkHandler.isAdPlaying()||new d.PauseWindow},update:function(){},onTimesUp:function(){this.autoSave=!1,d.sfx.musicEnable&&d.sfx.game_over.play(),this.board.update=function(){};var t=d.saveState.getPoints(),e=(d.saveState.resetProgress(),new d.LevelCompleteTxt(d.txt("Time is up!")));game.time.events.add(2e3,function(){new d.GameOverWindow(t),e.hide()},this)},onBoardEmpty:function(){this.autoSave=!1,d.sfx.musicEnable&&d.sfx.game_won.play(),console.log("onBoardEmpty from state"),new d.LevelCompleteTxt(d.txt("Level %NR% completed").replace("%NR%",this.lvlNr+1)),d.saveState.levelEnd(!0)},render:function(){},shutdown:function(){game.onPause.remove(this.pauseOnBlur,this)}},d.GameProto=function(t){},d.GameProto.prototype={create:function(){s=game.state.getCurrentState(),this.gfx=game.add.graphics(),this.grid=new d.GridArray(10,10,!1),this.grid.loop(function(t,e,i,s){s[e][i]=game.rnd.between(1,10)}),this.drawGfx(),this.keyX=game.input.keyboard.addKey(Phaser.Keyboard.X),this.keyX.onDown.add(function(){var t=game.input.activePointer;xx=Math.floor(t.x/40),yy=Math.floor(t.y/40),this.grid.set(xx,yy,!1),this.drawGfx()},this)},drawGfx:function(){this.gfx.clear(),this.grid.loop(function(t,e,i){this.gfx.beginFill([0,16711680,10035712,65280,8840,5570815,21879,16711935,6736998,10039903,16724575][t],1),this.gfx.drawRect(40*e,40*i,40,40)},this)},findMatch:function(t,e,i,s){var a,n;return this.grid.get(t,e)!==this.grid.get(i,s)?(console.log("not the same stuff"),!1):(t!=i||e!=s)&&(1==this.getDistanceBetweenCells([t,e],[i,s])?[[t,e],[i,s]]:(n=this.getRaysForCell(t,e),a=this.getRaysForCell(i,s),0!=(n=this.findRoutes(n,a)).length&&this.getShortestFullRoute([t,e],[i,s],n)))},getShortestFullRoute:function(i,s,t){var e=t.filter(function(t){return 1==t.length});return e[0]?[i,e[0][0],s]:t.filter(function(t){return 2==t.length}).map(function(t){var e=this.getDistanceBetweenCells(i,t[0])+this.getDistanceBetweenCells(t[0],t[1])+this.getDistanceBetweenCells(t[1],s);return{route:[i,t[0],t[1],s],routeLength:e}},this).sort(function(t,e){return t.routeLength>e.routeLength})[0].route},getDistanceBetweenCells:function(t,e){return Math.abs(t[0]-e[0])+Math.abs(t[1]-e[1])},findRoutes:function(t,i){var s=[];return t.forEach(function(e){i.forEach(function(t){return d.Utils.arraysEqual(e,t)?s.push([e]):this.isSpaceBetweenFree(e,t)?s.push([e,t]):void 0},this)},this),s},isSpaceBetweenFree:function(t,e){if(t[0]==e[0]){for(var i=Math.min(t[1],e[1]),s=Math.max(t[1],e[1]),a=i;a<s;a++)if(this.grid.get(t[0],a))return!1}else{if(t[1]!=e[1])return!1;for(i=Math.min(t[0],e[0]),s=Math.max(t[0],e[0]),a=i;a<s;a++)if(this.grid.get(a,t[1]))return!1}return!0},getRaysForCell:function(t,e){var i=this.getRayInDir(t,e,0,-1),s=this.getRayInDir(t,e,0,1),a=this.getRayInDir(t,e,-1,0),t=this.getRayInDir(t,e,1,0);return[].concat(i,s,a,t)},getRayInDir:function(t,e,i,s){for(var a=[];!this.grid.get(t+i,e+s)&&(a.push([t+=i,e+=s]),this.grid.isInGrid(t,e)););return a},getAllPossibleMoves:function(){var a={},t=(this.grid.loop(function(s,t,e){s&&!a[s]&&(a[s]=[],this.grid.loop(function(t,e,i){t===s&&a[s].push([e,i])}))},this),[]);for(val in a)for(var e=a[val],i=e.length,s=0;s<i;s++)for(var n=e[s],o=s+1;o<i;o++){var r=e[o];this.findMatch(n[0],n[1],r[0],r[1])&&t.push([n,r])}return t},render:function(){var t=game.input.activePointer;xx=Math.floor(t.x/40),yy=Math.floor(t.y/40),game.debug.text(xx+"x"+yy,10,10,"#ffffff")}},d.MainMenu=function(t){},d.MainMenu.prototype={create:function(){s=game.state.getCurrentState(),this.bg=new d.Background,this.logo=new d.Logo(.5,.42,!0),this.playButton=new d.MainMenuPlayButton(.5,.76,!0),this.fadeInput=new d.FadeInput,game.resizeGame(),game.camera.flash(0,600),d.prevGameState="MainMenu"}},d.Preloader=function(t){this.ready=!1},d.Preloader.prototype={preload:function(){d.Loader.loadAssets(),game.load.onFileComplete.add(this.onFileComplete,this)},onFileComplete:function(t,e,i,s,a){sgSdk.trigger("loading.update",{progressPercentage:t})},create:function(){d.Text.addStyle("regular",{font:"Lobster",fill:"#914023",fontSize:"30px",shadow:[0,1,"rgba(248,216,182,1)",0]}),d.Text.addStyle("ribbon",{font:"Lobster",fill:"#fdfd4b",fontSize:30}),d.Text.addStyle("endGameTexts",{font:"Lobster",fill:"#f8d8b6",fontSize:70,stroke:"#914023",strokeThickness:10}),d.saveState.init(),game.resizeGame()},update:function(){!this.ready&&d.saveState.ready&&(sgSdk.trigger("loading.completed",{callback:function(){d.sfx.music.play("",0,.3,!0),d.sfx.musicEnable||d.sfx.music.pause(),game.state.start("MainMenu")}},this),this.ready=!0)}},d.Test=function(t){},d.Test.prototype={create:function(){s=game.state.getCurrentState(),this.borders=game.add.group(),this.test_border=d.makeImage(0,0,"gem_test_border",0),this.top=game.add.group(),this.test=d.makeImage(0,0,"gem_test",0),this.test_border.position=this.test.position,this.cursors=game.input.keyboard.createCursorKeys(),this.cursors.right.onDown.add(function(){this.test.x+=25.5},this),this.cursors.left.onDown.add(function(){this.test.x-=25.5},this),this.cursors.up.onDown.add(function(){this.test.y-=36},this),this.cursors.down.onDown.add(function(){this.test.y+=36},this),this.addRandom()},addRandom:function(){this.grid=new d.GridArray(10,10);for(var t=0;t<50;t++){var e,i,s=game.rnd.between(0,9),a=game.rnd.between(0,9);this.grid.get(s,a)||(e=d.makeImage(s=51+51*s,a=72+72*a,"gem_test_border",0,this.borders),i=d.makeImage(s,a,"gem_test",0,this.top),e.zz=5*s+1e3*a,i.zz=e.zz)}this.borders.sort("zz",Phaser.Group.SORT_DESCENDING),this.top.sort("zz",Phaser.Group.SORT_DESCENDING)}},d.Board=function(t){Phaser.Group.call(this,game),this.state=game.state.getCurrentState();var e=10,i=90/e;(game.device.desktop&&e<i||!game.device.desktop&&i<e)&&(e=i,i=10),this.moves=[],this.grid=new d.GridArray(e,i,!1),this.tileSize=d.json.settings.tileSize,this.tileWidth=this.tileSize[0],this.tileHeight=this.tileSize[1],this.gemTypes=t.gemTypes,this.cacheGroup=game.make.group(),this.cacheGroup.visible=!1,this.bottomRTLayer=new d.RTLayer(this,this.cacheGroup,!1),this.add(this.bottomRTLayer),this.backMoveable=new d.BoardMoveBackLayer(this),this.add(this.backMoveable),this.topMoveable=game.add.group(),this.add(this.topMoveable),this.topRTLayer=new d.RTLayer(this,this.cacheGroup,!0),this.add(this.topRTLayer),this.fillBoard(),this.orderRedraw=!0,this.postUpdate(),this.inputMgr=new d.BoardInputMgr(this),this.add(this.inputMgr),this.boardHint=new d.BoardHint(this),this.add(this.boardHint),this.matcher=new d.BoardMatcher(this),this.fallMgr=new d.BoardFallMgr(this,t.fallType),d.sb("onMoveStart").add(this.onMoveStart,this),d.sb("onMoveFinish").add(this.onMoveFinish,this),d.sb("onPause").add(this.onPause,this),d.sb("onUnpause").add(this.onUnpause,this),d.sb("onScreenResize").add(this.onResize,this),this.onResize(),this.possibleMoves=null,this.onIdle=new Phaser.Signal,this.idle=!1},d.Board.prototype=Object.create(Phaser.Group.prototype),d.Board.prototype.tutorial=function(t){this.update(),this.setGems(!0);var e=this.boardHint.showHint();e.g1.deactivate(!1),e.g2.deactivate(!1),t&&(this.bottomRTLayer.redrawGroup(),this.topRTLayer.redrawGroup())},d.Board.prototype.setGems=function(i){this.state.hintBtn.input.enabled=!i;let s;for(let e=0;e<this.grid.width;e++)for(let t=0;t<this.grid.height;t++)(s=this.grid.get(e,t))&&s.deactivate(i);s=null},d.Board.prototype.update=function(){for(var t=this.moves.length-1;0<=t;t--)this.moves[t].update();this.fallMgr.update(),this.inputMgr.update(),this.topMoveable.sort("y",Phaser.Group.SORT_DESCENDING),0==this.moves.length?this.idle||(this.onIdle.dispatch(),this.idle=!0,this.possibleMoves=this.matcher.getAllPossibleMoves(),0==this.possibleMoves.length&&(console.warn("no possible moves"),this.checkWin()?(d.sb("onBoardEmpty").dispatch(!0),this.EMPTY=!0,this.update=function(){}):this.shuffleBoard())):this.idle=!1},d.Board.prototype.postUpdate=function(){this.orderRedraw&&(this.orderRedraw=!1,this.cacheGroup.forEach(function(t){t.zz=-100*t.cellY+t.cellX}),this.cacheGroup.sort("zz",Phaser.Group.SORT_ASCENDING),this.bottomRTLayer.redrawGroup(),this.topRTLayer.redrawGroup())},d.Board.prototype.processMatch=function(t){d.sb("onProcessMatch").dispatch();var e=this.grid.get(t[0][0],t[0][1]),i=(e.inputLocked=!0,this.grid.get(t[t.length-1][0],t[t.length-1][1])),s=(i.inputLocked=!0,e.x<i.x?-1:1),a=-1*s,n=new d.GemFlying(this.x+e.x*this.scale.x,this.y+e.y*this.scale.y,e.matchType,this.scale.x),o=(this.state.flyingGemsGroup.add(n),new d.GemFlying(this.x+i.x*this.scale.x,this.y+i.y*this.scale.y,i.matchType,this.scale.x)),r=(this.state.flyingGemsGroup.add(o),game.device.desktop?110:150);1==s?(this.state.flyingGemsGroup.bringToTop(n),n.flyTo(.5*game.width,game.height-r,s),o.flyTo(.5*game.width-74,game.height-r,a)):(this.state.flyingGemsGroup.bringToTop(o),n.flyTo(.5*game.width-74,game.height-r,s),o.flyTo(.5*game.width,game.height-r,a)),this.grid.set(t[0][0],t[0][1],!1),this.grid.set(t[t.length-1][0],t[t.length-1][1],!1),d.sb("onMatch").dispatch(e,i),this.idle=!1,e.destroy(),i.destroy(),d.sfx.musicEnable&&d.sfx.match.play(),this.orderRedraw=!0,0<d.saveState.getTutorial()&&(d.saveState.tutorialStep(),0===d.saveState.getTutorial()?this.setGems(!1):(n=this.boardHint.showHint())&&(n.g1.deactivate(!1),n.g2.deactivate(!1)))},d.Board.prototype.checkWin=function(){return allFalse=!0,this.grid.loop(function(t){t&&(allFalse=!1)}),allFalse},d.Board.prototype.onMoveStart=function(t){this.moves.push(t),this.topMoveable.add(t.gem),this.topMoveable.updateTransform(),this.orderRedraw=!0,this.possibleMoves=null},d.Board.prototype.onMoveFinish=function(t){this.moves.splice(this.moves.indexOf(t),1),t.FALL&&(this.cacheGroup.add(t.gem),this.orderRedraw=!0,t.gem.inputLocked=!1)},d.Board.prototype.cellToPx=function(t,e){return[t*this.tileWidth,e*this.tileHeight]},d.Board.prototype.fillBoard=function(){for(var t=this.grid.width*this.grid.height,a=[],e=0;e<t;e+=2){var i=e%this.gemTypes;a.push(i,i)}Phaser.ArrayUtils.shuffle(a),this.grid.loop(function(t,e,i,s){s[e][i]=new d.Gem(this,e,i,a.pop()),this.cacheGroup.add(s[e][i])},this)},d.Board.prototype.shuffleBoard=function(t){for(var s=[],a=[],e=(this.grid.loop(function(t,e,i){t&&(a.push(t),s.push([e,i]))}),0);0==e||0==this.matcher.getAllPossibleMoves().length;)if(Phaser.ArrayUtils.shuffle(a),s.forEach(function(t,e){var e=a[e],i=this.cellToPx(t[0],t[1]);e.x=i[0],e.y=i[1],this.grid.set(t[0],t[1],e)},this),20<e++){console.warn("something went terribly wrong with shuffling");break}this.possibleMoves=this.matcher.getAllPossibleMoves(),this.orderRedraw=!0},d.Board.prototype.onResize=function(){var t=new Phaser.Rectangle;game.device.desktop?t.setTo(0,50,game.width,game.height-180):t.setTo(0,30,game.width,game.height-200),this.putInRect(t)},d.Board.prototype.putInRect=function(t){var e=this.grid.width*this.tileWidth,i=this.grid.height*this.tileHeight,s=Math.min(t.width/(50+e),t.height/i),i=i*s;this.x=Math.round(t.x+.5*(t.width-e*s)),this.y=Math.round(t.y+.5*(t.height-i)),this.scale.setTo(s)},d.Board.prototype.onPause=function(){d.stopTweens(this),game.add.tween(this).to({alpha:0},300,Phaser.Easing.Sinusoidal.In,!0)},d.Board.prototype.onUnpause=function(){d.stopTweens(this),game.add.tween(this).to({alpha:1},300,Phaser.Easing.Sinusoidal.Out,!0)},d.BoardFallMgr=function(t,e){this.board=t,this.grid=t.grid,this.fallType=e,this.update=this["fallUpdate"+e],this.halfRow=game.device.desktop?5:8,this.halfCollumn=game.device.desktop?7:3},d.BoardFallMgr.prototype.makeFall=function(t,e,i,s){var a=this.grid.get(t,e);this.grid.set(i,s,a),this.grid.set(t,e,!1),a.inputLocked=!0,new d.BoardMoveObject(this.board,a,[[t,e],[i,s]],!0)},d.BoardFallMgr.prototype.fallUpdateNone=function(){},d.BoardFallMgr.prototype.fallUpdateDown=function(){for(var t=0;t<this.grid.width;t++)for(var e=this.grid.height-1;0<=e;e--)if(!this.grid.get(t,e))for(var i=e-1;0<=i;i--){var s=this.grid.get(t,i);if(s){s.inputLocked||this.makeFall(t,i,t,e);break}}},d.BoardFallMgr.prototype.fallUpdateUp=function(){for(var t=0;t<this.grid.width;t++)for(var e=0;e<this.grid.height;e++)if(!this.grid.get(t,e))for(var i=e+1;i<this.grid.height;i++){var s=this.grid.get(t,i);if(s){s.inputLocked||this.makeFall(t,i,t,e);break}}},d.BoardFallMgr.prototype.fallUpdateUpDown=function(){for(var t=0;t<this.grid.width;t++){for(var e=0;e<this.halfRow;e++)if(!this.grid.get(t,e))for(var i=e+1;i<this.halfRow;i++)if(s=this.grid.get(t,i)){s.inputLocked||this.makeFall(t,i,t,e);break}for(e=this.grid.height-1;e>=this.halfRow;e--)if(!this.grid.get(t,e))for(var s,i=e-1;i>=this.halfRow;i--)if(s=this.grid.get(t,i)){s.inputLocked||this.makeFall(t,i,t,e);break}}},d.BoardFallMgr.prototype.fallUpdateRight=function(){for(var t=0;t<this.grid.height;t++)for(var e=this.grid.width-1;0<=e;e--)if(!this.grid.get(e,t))for(var i=e-1;0<=i;i--){var s=this.grid.get(i,t);if(s){s.inputLocked||this.makeFall(i,t,e,t);break}}},d.BoardFallMgr.prototype.fallUpdateLeft=function(){for(var t=0;t<this.grid.height;t++)for(var e=0;e<this.grid.width;e++)if(!this.grid.get(e,t))for(var i=e+1;i<this.grid.width;i++){var s=this.grid.get(i,t);if(s){s.inputLocked||this.makeFall(i,t,e,t);break}}},d.BoardFallMgr.prototype.fallUpdateLeftRight=function(){for(var t=0;t<this.grid.height;t++){for(var e=0;e<this.halfCollumn;e++)if(!this.grid.get(e,t))for(var i=e+1;i<this.halfCollumn;i++)if(s=this.grid.get(i,t)){s.inputLocked||this.makeFall(i,t,e,t);break}for(e=this.grid.width-1;e>=this.halfCollumn;e--)if(!this.grid.get(e,t))for(var s,i=e-1;i>=this.halfCollumn;i--)if(s=this.grid.get(i,t)){s.inputLocked||this.makeFall(i,t,e,t);break}}},d.BoardHint=function(t){Phaser.Group.call(this,game),this.board=t,game.add.tween(this).to({alpha:.7},300,Phaser.Easing.Sinusoidal.InOut,!0,0,-1,!0),this.highlightHint1=d.makeImage(0,0,"gem_highlight_hint",0,this),this.highlightHint1.pivot.setTo(4,5),this.highlightHint1.visible=!1,this.highlightHint2=d.makeImage(0,0,"gem_highlight_hint",0,this),this.highlightHint2.pivot.setTo(4,5),this.highlightHint2.visible=!1,d.sb("onHint").add(this.showHint,this),d.sb("onProcessMatch").add(this.hideHint,this)},d.BoardHint.prototype=Object.create(Phaser.Group.prototype),d.BoardHint.prototype.showHint=function(){var t,e,i;if(!(0<this.board.moves.length))return t=game.rnd.pick(this.board.possibleMoves),console.log(t),e=this.board.grid.get(t[0][0],t[0][1]),i=this.board.grid.get(t[1][0],t[1][1]),e&&i?(this.highlightHint1.position.set(e.x,e.y),this.highlightHint2.position.set(i.x,i.y),this.board.grid.get(t[0][0],t[0][1]+1),this.board.grid.get(t[1][0],t[1][1]+1),d.changeTexture(this.highlightHint1,"gem_hl"),d.changeTexture(this.highlightHint2,"gem_hl"),this.highlightHint1.visible=!0,this.highlightHint2.visible=!0,{g1:e,g2:i}):void 0;console.warn("cant show hint - there are moves")},d.BoardHint.prototype.hideHint=function(){this.highlightHint1.visible=!1,this.highlightHint2.visible=!1},d.BoardInputMgr=function(t){Phaser.Group.call(this,game),this.state=game.state.getCurrentState(),this.highlight=d.makeImage(0,0,"gem_selection",0,this),this.highlight.pivot.setTo(4,5),game.add.tween(this.highlight).to({alpha:.5},500,Phaser.Easing.Sinusoidal.InOut,!0,0,-1,!0),this.board=t,this.cell1=null,this.locked=!1,game.input.onDown.add(this.onClick,this),d.sb("onTimesUp").add(function(){this.locked=!0},this),d.sb("onPause").add(function(){this.cell1=null,this.locked=!0},this),d.sb("onUnpause").add(function(){this.cell1=null,this.locked=!1},this)},d.BoardInputMgr.prototype=Object.create(Phaser.Group.prototype),d.BoardInputMgr.prototype.update=function(){this.locked&&(this.cell1=null),this.cell1?(this.highlight.visible=!0,this.highlight.x=this.cell1[0]*this.board.tileWidth,this.highlight.y=this.cell1[1]*this.board.tileHeight):this.highlight.visible=!1},d.BoardInputMgr.prototype.onClick=function(t){var e,i,s;this.state.pause||this.locked||(e=Math.floor((t.x-this.board.worldPosition.x)/(this.board.tileWidth*this.board.scale.x)),t=Math.floor((t.y-this.board.worldPosition.y)/(this.board.tileHeight*this.board.scale.y)),(i=this.board.grid.get(e,t))&&!i.inputLocked&&(null==this.cell1?this.selectCell(e,t):(s=this.board.grid.get(this.cell1[0],this.cell1[1]))?s.matchType==i.matchType?((s=this.board.matcher.findMatch(this.cell1[0],this.cell1[1],e,t))&&this.board.processMatch(s),this.cell1=null):this.selectCell(e,t):this.deselect()))},d.BoardInputMgr.prototype.selectCell=function(t,e){d.sfx.musicEnable&&d.sfx.stones_touch.play();var i=this.board.grid.get(t,e);this.board.grid.get(t,e+1);i&&(this.cell1=[t,e],this.highlight.visible=!0,this.highlight.position.setTo(i.x,i.y))},d.BoardInputMgr.prototype.deselect=function(){this.cell1=null,this.highlight.visible=!1},d.BoardMatcher=function(t){console.log("creating matcher"),this.board=t,this.grid=t.grid},d.BoardMatcher.prototype.findMatch=function(t,e,i,s){var a,n;return(t!=i||e!=s)&&this.grid.get(t,e).matchType===this.grid.get(i,s).matchType&&(1==this.getDistanceBetweenCells([t,e],[i,s])?[[t,e],[i,s]]:(n=this.getRaysForCell(t,e),a=this.getRaysForCell(i,s),0!=(n=this.findRoutes(n,a)).length&&this.getShortestFullRoute([t,e],[i,s],n)))},d.BoardMatcher.prototype.getShortestFullRoute=function(i,s,t){var e=t.filter(function(t){return 1==t.length});return e[0]?[i,e[0][0],s]:t.filter(function(t){return 2==t.length}).map(function(t){var e=this.getDistanceBetweenCells(i,t[0])+this.getDistanceBetweenCells(t[0],t[1])+this.getDistanceBetweenCells(t[1],s);return{route:[i,t[0],t[1],s],routeLength:e}},this).sort(function(t,e){return t.routeLength-e.routeLength})[0].route},d.BoardMatcher.prototype.getDistanceBetweenCells=function(t,e){return Math.abs(t[0]-e[0])+Math.abs(t[1]-e[1])},d.BoardMatcher.prototype.findRoutes=function(t,i){var s=[];return t.forEach(function(e){i.forEach(function(t){return d.Utils.arraysEqual(e,t)?s.push([e]):this.isSpaceBetweenFree(e,t)?s.push([e,t]):void 0},this)},this),s},d.BoardMatcher.prototype.isSpaceBetweenFree=function(t,e){if(t[0]==e[0]){for(var i=Math.min(t[1],e[1]),s=Math.max(t[1],e[1]),a=i;a<s;a++)if(this.grid.get(t[0],a))return!1}else{if(t[1]!=e[1])return!1;for(i=Math.min(t[0],e[0]),s=Math.max(t[0],e[0]),a=i;a<s;a++)if(this.grid.get(a,t[1]))return!1}return!0},d.BoardMatcher.prototype.getRaysForCell=function(t,e){var i=this.getRayInDir(t,e,0,-1),s=this.getRayInDir(t,e,0,1),a=this.getRayInDir(t,e,-1,0),t=this.getRayInDir(t,e,1,0);return[].concat(i,s,a,t)},d.BoardMatcher.prototype.getRayInDir=function(t,e,i,s){for(var a=[];!this.grid.get(t+i,e+s)&&(a.push([t+=i,e+=s]),this.grid.isInGrid(t,e)););return a},d.BoardMatcher.prototype.getAllPossibleMoves=function(){var a={},t=(this.grid.loop(function(s,t,e){s&&!a[s.matchType]&&(a[s.matchType]=[],this.grid.loop(function(t,e,i){t&&t.matchType===s.matchType&&a[s.matchType].push([e,i])}))},this),[]);for(val in a)for(var e=a[val],i=e.length,s=0;s<i;s++)for(var n=e[s],o=s+1;o<i;o++){var r=e[o];this.findMatch(n[0],n[1],r[0],r[1])&&t.push([n,r])}return t},d.BoardMoveBackLayer=function(t){Phaser.Group.call(this,game),this.deadArray=[],d.sb("onMoveStart").add(this.onMove,this)},d.BoardMoveBackLayer.prototype=Object.create(Phaser.Group.prototype),d.BoardMoveBackLayer.prototype.getFreePart=function(){var t;return this.deadArray[0]?(t=this.deadArray.pop(),this.add(t)):t=d.makeImage(0,0,null,0,this),this.updateTransform(),t},d.BoardMoveBackLayer.prototype.onMove=function(t){var e=this.getFreePart();d.changeTexture(e,"blog_back"),e.position=t.gem.position,e.pivot.setTo(-5,8),t.onFinish.add(function(){this.removeChild(e),this.deadArray.push(e)},this)},d.BoardMoveObject=function(t,e,i,s){this.board=t,this.gem=e,this.FALL=s||!1,this.beginPos=[this.gem.x,this.gem.y],this.routeRaw=i,this.routeMap=this.processRoute(i),this.moveSpeed=0,this.moveSpeedDelta=1,this.progress=0,this.FALL||(t=Math.max(Math.floor(.6*this.routeMap.len),300),game.add.tween(this).to({progress:this.routeMap.len},t,Phaser.Easing.Sinusoidal.InOut,!0)),this.onTurn=new Phaser.Signal,this.onFinish=new Phaser.Signal,d.sb("onMoveStart").dispatch(this)},d.BoardMoveObject.prototype.update=function(){var t;this.FALL&&(this.moveSpeed+=this.moveSpeedDelta,this.progress+=this.moveSpeed),this.progress>=this.routeMap.len?(this.FALL&&(t=this.routeMap.nodes[this.routeMap.nodes.length-1],this.gem.x=t.px[0],this.gem.y=t.px[1]),d.sb("onMoveFinish").dispatch(this),this.onTurn.dispatch(),this.onFinish.dispatch()):this.setPosByDistance(this.gem,this.progress,this.routeMap)},d.BoardMoveObject.prototype.processRoute=function(t){for(var e={nodes:[],len:0},i=0;i<t.length;i++){var s={cell:t[i],px:this.board.cellToPx(t[i][0],t[i][1])},a=t[i+1];this.FALL||a!==t[t.length-1]||(s.cell[0]===a[0]?e.len-=this.board.tileWidth:e.len-=this.board.tileHeight),a&&(t[i][0]==a[0]?(s.lenToNext=Math.abs(t[i][1]-a[1])*this.board.tileWidth,s.ver=!0):(s.lenToNext=Math.abs(t[i][0]-a[0])*this.board.tileHeight,s.ver=!1),e.len+=s.lenToNext),e.nodes.push(s)}return e},d.BoardMoveObject.prototype.setPosByDistance=function(t,e,i){for(var s=0,a=0;a<i.nodes.length-1;a++){var n=i.nodes[a],o=i.nodes[a+1];if(e<s+n.lenToNext){var r,h=(e-s)/n.lenToNext;n.ver?(r=o.px[1]-n.px[1],t.x=n.px[0],t.y=n.px[1]+r*h):(r=o.px[0]-n.px[0],t.x=n.px[0]+r*h,t.y=n.px[1]),0<a&&this.onTurn.dispatch();break}s+=n.lenToNext}},d.FadeInput=function(){Phaser.Graphics.call(this,game),this.fixedToCamera=!0,this.inputEnabled=!0,this.visible=!1,d.sb("onScreenResize").add(this.onResize,this),this.onResize(),d.sb("openOverlay").add(this.open,this),d.sb("closeOverlay").add(this.close,this),game.add.existing(this)},d.FadeInput.prototype=Object.create(Phaser.Graphics.prototype),d.FadeInput.prototype.onResize=function(){this.clear(),this.beginFill(0,.6),this.drawRect(0,0,game.width,game.height)},d.FadeInput.prototype.open=function(){d.stopTweens(this),this.visible=!0,this.alpha=0},d.FadeInput.prototype.close=function(){d.stopTweens(this),this.visible=!1},d.Gem=function(t,e,i,s){var a=t.cellToPx(e,i);d.Image.call(this,a[0],a[1],"blog_front",0,null),d.json.settings.tileSize;this.sign=d.makeImage(0,0,"sign ("+(s+1)+")",0,this),this.cellX=e,this.cellY=i,this.board=t,this.matchType=s,this.inputLocked=!1},d.Gem.prototype=Object.create(d.Image.prototype),d.Gem.prototype.deactivate=function(t){this.tint=this.sign.tint=!0===t?7829367:16777215,this.inputLocked=t},d.RTLayer=function(t,e,i){Phaser.Group.call(this,game),this.group=e;var e=(t.grid.width+2)*t.tileWidth,s=(t.grid.height+2)*t.tileHeight;this.tileWidth=t.tileWidth,this.tileHeight=t.tileHeight,this.rt=game.make.renderTexture(e,s),this.img=game.add.image(-this.tileWidth,-this.tileHeight,this.rt),this.topLayer=i||!1,this.marker=d.makeImage(0,0,this.topLayer?null:"blog_back",0,null),this.add(this.img)},d.RTLayer.prototype=Object.create(Phaser.Group.prototype),d.RTLayer.prototype.redrawGroup=function(){this.topLayer||d.changeTexture(this.marker,"blog_back"),this.rt.clear();for(var t=0,e=this.group.length;t<e;t++){var i=this.group.children[t],s=i.x+this.tileWidth,a=i.y+this.tileHeight;this.topLayer?(d.changeTexture(this.marker,"blog_front"),this.rt.renderRawXY(i,s,a),this.rt.renderRawXY(i.sign,s,a)):this.rt.renderRawXY(this.marker,s+5,a-8)}},d.Text=function(t,e,i,s,a,n,o,r,h){for(s=d.Text.getStyle(s),this.userMaxWidth=n||1/0,this.userMaxHeight=o||1/0,r&&(s.wordWrap=!0,s.wordWrapWidth=n,s.align=h||"left"),Phaser.Text.call(this,game,t,e,i,s),s.lineSpacing&&(this.lineSpacing=s.lineSpacing),s.shadow&&(this.setShadow.apply(this,s.shadow),this.padding.setTo(s.shadow[0],s.shadow[1])),a&&("number"==typeof a?this.anchor.setTo(a):this.anchor.setTo(a[0],a[1]));(this.width>this.userMaxWidth||this.height>this.userMaxHeight)&&(this.fontSize-=2,!(this.fontSize<10)););},d.Text.prototype=Object.create(Phaser.Text.prototype),d.Text.styles={},d.Text.addStyle=function(t,e){d.Text.styles[t]=e},d.Text.getStyle=function(t){var e,i="object"!=typeof t?JSON.parse(JSON.stringify(d.Text.styles[t])):t.style||t.fontStyle?(t.style=t.fontStyle||t.style,e=JSON.parse(JSON.stringify(d.Text.styles[t.style])),t.scaleStroke&&t.fontSize&&e.fontSize&&e.strokeThickness&&(i=e.strokeThickness/parseInt(e.fontSize),t.strokeThickness=Math.ceil(parseInt(t.fontSize)*i)),Object.assign(e,t)):t;return"vi"===d.lang&&"Lobster"===i.font&&(delete i.font,i.fontWeight="bold"),i},d.Text.prototype.setText=function(t){Phaser.Text.prototype.setText.call(this,t),this.scale.setTo(1),this.width=Math.min(this.width,this.userMaxWidth),this.height=Math.min(this.height,this.userMaxHeight)},d.Text.prototype.setStyle=function(t,e){t=d.Text.getStyle(t),Phaser.Text.prototype.setStyle.call(this,t,e)},d.TextCounter=function(t,e,i,s,a,n,o){this.amount=i,this.amountDisplayed=i,d.Text.call(this,t,e,null===i?"...":i.toString(),s,a,n),o=o||{lerpValue:.5},this.lerp=!0,this.lerpValue=o.lerpValue,this.stepCurrent=0,this.step=0},d.TextCounter.prototype=Object.create(d.Text.prototype),d.TextCounter.prototype.setAmount=function(t,e){this.amount=t,e&&(this.amountDisplayed=t,this.setText(this.amountDisplayed.toString()))},d.TextCounter.prototype.changeAmount=function(t,e){this.amount+=t,e&&(this.amountDisplayed=this.amount,this.setText(this.amountDisplayed.toString()))},d.TextCounter.prototype.increaseAmount=function(t,e){this.changeAmount(t)},d.TextCounter.prototype.update=function(){this.amountDisplayed!=this.amount&&this.stepCurrent--<=0&&(this.stepCurrent=this.step,this.lerp)&&this.lerpUpdate()},d.TextCounter.prototype.lerpUpdate=function(){this.amountDisplayed=d.lerp(this.amountDisplayed,this.amount,this.lerpValue,.2),this.setText(Math.round(this.amountDisplayed).toString())},"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t,e){"use strict";if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),s=1;s<arguments.length;s++){var a=arguments[s];if(null!=a)for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(i[n]=a[n])}return i},writable:!0,configurable:!0}),Phaser.Text.prototype.updateText=function(){this.texture.baseTexture.resolution=this._res,this.context.font=this.style.font;var t=this.text,e=(-1<this.characterLimitSize&&this.characterLimitSize<t.length&&(t=this.text.substring(0,this.characterLimitSize)+this.characterLimitSuffix),(t=this.style.wordWrap?this.runWordWrap(this.text):t).split(this.splitRegExp)),i=this.style.tabs,s=[],a=0,n=this.determineFontProperties(this.style.font),o=e.length;0<this.style.maxLines&&this.style.maxLines<e.length&&(o=this.style.maxLines);for(var r=this._charCount=0;r<o;r++){if(0===i){var h=this.style.strokeThickness+this.padding.x;0<this.colors.length||0<this.strokeColors.length||0<this.fontWeights.length||0<this.fontStyles.length?h+=this.measureLine(e[r]):h+=this.context.measureText(e[r]).width,this.style.wordWrap&&(h-=this.context.measureText(" ").width)}else{var l=e[r].split(/(?:\t)/),h=this.padding.x+this.style.strokeThickness;if(Array.isArray(i))for(var c=0,d=0;d<l.length;d++){var p=0,p=0<this.colors.length||0<this.strokeColors.length||0<this.fontWeights.length||0<this.fontStyles.length?this.measureLine(l[d]):Math.ceil(this.context.measureText(l[d]).width);0<d&&(c+=i[d-1]),h=c+p}else for(d=0;d<l.length;d++)0<this.colors.length||0<this.strokeColors.length||0<this.fontWeights.length||0<this.fontStyles.length?h+=this.measureLine(l[d]):h+=Math.ceil(this.context.measureText(l[d]).width),h+=this.game.math.snapToCeil(h,i)-h}s[r]=Math.ceil(h),a=Math.max(a,s[r])}this.canvas.width=a*this._res,this.canvas.width%2==1&&(this.canvas.width=this.canvas.width+1);var u,g,m=n.fontSize+this.style.strokeThickness+this.padding.y,t=m*o,f=this._lineSpacing;for(0!==(f=f<0&&Math.abs(f)>m?-m:f)&&(t+=0<f?f*e.length:f*(e.length-1)),this.canvas.height=t*this._res,this.canvas.height%2==1&&(this.canvas.height=this.canvas.height+1),this.context.scale(this._res,this._res),navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.style.backgroundColor&&(this.context.fillStyle=this.style.backgroundColor,this.context.fillRect(0,0,this.canvas.width,this.canvas.height)),this.context.fillStyle=this.style.fill,this.context.font=this.style.font,this.context.strokeStyle=this.style.stroke,this.context.textBaseline="alphabetic",this.context.lineWidth=this.style.strokeThickness,this.context.lineCap="round",this.context.lineJoin="round",r=this._charCount=0;r<o;r++)u=this.style.strokeThickness/2,g=this.style.strokeThickness/2+r*m+n.ascent,0<r&&(g+=f*r),"right"===this.style.align?u+=a-s[r]:"center"===this.style.align&&(u+=(a-s[r])/2),this.autoRound&&(u=Math.round(u),g=Math.round(g)),0<this.colors.length||0<this.strokeColors.length||0<this.fontWeights.length||0<this.fontStyles.length?this.updateLine(e[r],u,g):(this.style.stroke&&this.style.strokeThickness&&(this.updateShadow(this.style.shadowStroke),0===i?this.context.strokeText(e[r],u,g):this.renderTabLine(e[r],u,g,!1)),this.style.fill&&(this.updateShadow(this.style.shadowFill),0===i?this.context.fillText(e[r],u,g):this.renderTabLine(e[r],u,g,!0)));this.updateTexture(),this.dirty=!1},d.Background=function(){Phaser.Group.call(this,game),this.fixedToCamera=!0,this.bg=d.makeImage(0,0,game.device.desktop?"bg_h":"bg_v",0,this),d.sb("onScreenResize").add(this.onResize,this),this.onResize()},d.Background.prototype=Object.create(Phaser.Group.prototype),d.Background.prototype.onResize=function(){this.bg.width=game.width,this.bg.height=game.height},(d=void 0===d?{}:d).Button=function(t,e,i,s,a){Phaser.Button.call(this,game,d.l(t),d.l(e),null),this.state=game.state.getCurrentState(),d.changeTexture(this,i),this.anchor.setTo(.5),this.sfx=d.sfx.btn_pressed,this.active=!0,this.onClick=new Phaser.Signal,s&&this.onClick.add(s,a||this),this.onInputDown.add(this.click,this),this.terms=[],this.IMMEDIATE=!1,this.scaleOnClick=!0,this.targetAlphaTermsNotFulfilled=.5,this.targetAlpha=1,this.pulsing=!1},d.Button.prototype=Object.create(Phaser.Button.prototype),d.Button.constructor=d.Button,d.Button.prototype.update=function(){this.checkTerms()?this.targetAlpha=1:this.targetAlpha=this.targetAlphaTermsNotFulfilled,this.alpha=d.lerp(this.alpha,this.targetAlpha,.2,.05),this.updateChildren()},d.Button.prototype.pulse=function(t){this.pulsing=!0,this.pulsingTween=game.add.tween(this.scale).to({x:t||1.1,y:t||1.1},500,Phaser.Easing.Sinusoidal.InOut,!0,0,-1,!0)},d.Button.prototype.stopPulse=function(t){this.pulsingTween&&this.pulsingTween.stop(),this.scale.setTo(t||1),this.pulsing=!1},d.Button.prototype.click=function(){var t,e;this.active&&this.checkTerms()&&(this.active=!1,this.onClick.dispatch(),d.sfx.musicEnable&&this.sfx.play(),t=this.scale.x,e=this.scale.y,this.IMMEDIATE?this.active=!0:this.pulsing||!this.scaleOnClick?game.time.events.add(400,function(){this.active=!0},this):game.add.tween(this.scale).to({x:t+.1,y:e+.1},200,Phaser.Easing.Quadratic.Out,!0).onComplete.add(function(){game.add.tween(this.scale).to({x:t,y:e},200,Phaser.Easing.Quadratic.Out,!0).onComplete.add(function(){this.active=!0},this)},this))},d.Button.prototype.checkTerms=function(){for(var t=0;t<this.terms.length;t++)if(!this.terms[t][0].call(this.terms[t][1]))return!1;return!0},d.Button.prototype.addTerm=function(t,e){this.terms.push([t,e])},d.Button.prototype.addImageLabel=function(t){this.label=game.make.image(0,0,"ssheet",t),this.label.anchor.setTo(.5),this.addChild(this.label)},d.Button.prototype.addTextLabel=function(t,e,i){var s=1/d.Loader.currentConfigMulti;this.label=new d.Text(0,-6,e,{style:t,fontSize:i||Math.floor(this.height*s*.7)},.5,.9*this.width),this.addChild(this.label)},d.Button.prototype.addTextLabelMultiline=function(t,e){var i=1/d.Loader.currentConfigMulti;this.label=new d.MultiLineText(0,0,t,e,Math.floor(this.height*i*.5),this.width*i*.8,this.height*i*.7,"center",.5,.5),this.addChild(this.label)},d.Button.prototype.stopTweens=function(){d.stopTweens(this)},d.Button.prototype.changeTexture=function(t){d.changeTexture(this,t)},d.Button.prototype.add=function(t){return this.addChild(t)},d.Button.prototype.updateChildren=function(){for(var t=this.children.length;t--;)this.children[t].update()},d.ComboUI=function(){d.Text.call(this,0,0," ",{style:"endGameTexts",fontSize:60},.5),this.padding.x=6,this.padding.y=6,this.setShadow(4,6,"rgba(0,0,0,0.2)",6),this.fixedToCamera=!0,this.timeDisappearEvent=null,d.sb("onComboIncreased").add(this.showCombo,this),d.sb("onScreenResize").add(this.onResize,this),this.onResize(),this.comboSounds=[d.sfx.combo_01,d.sfx.combo_02,d.sfx.combo_03,d.sfx.combo_04,d.sfx.combo_05,d.sfx.combo_06,d.sfx.combo_07,d.sfx.combo_08,d.sfx.combo_09],this.comboSoundIndex=0,game.add.existing(this)},d.ComboUI.prototype=Object.create(d.Text.prototype),d.ComboUI.prototype.onResize=function(){this.cameraOffset.x=Math.floor(.5*game.width),this.game.device.desktop?this.cameraOffset.y=50:this.cameraOffset.y=game.height-150},d.ComboUI.prototype.showCombo=function(t){var e;d.sfx.musicEnable&&(e=(t-2)%this.comboSounds.length,this.comboSounds[e].play()),d.stopTweens(this),d.stopTweens(this.anchor),this.timeDisappearEvent&&game.time.events.remove(this.timeDisappearEvent),this.alpha=1,this.anchor.setTo(.5),this.setText(d.txt("Combo")+" x"+t),this.scale.setTo(0),game.add.tween(this.scale).to({x:1,y:1},300,Phaser.Easing.Cubic.Out,!0),this.timeDisappearEvent=game.time.events.add(d.json.settings.comboTime,function(){game.add.tween(this).to({alpha:0},500,Phaser.Easing.Sinusoidal.Out,!0),game.add.tween(this.anchor).to({y:this.game.device.desktop?1.5:-1.5},500,Phaser.Easing.Sinusoidal.Out,!0)},this)},d.FxLayer=function(t){d.PoolGroup.call(this,d.FxPart,null,"fx",20),this.position=t.position,this.scale=t.scale,d.sb("onMatch").add(this.onMatch,this)},d.FxLayer.prototype=Object.create(d.PoolGroup.prototype),d.FxLayer.prototype.onMatch=function(t,e){d.sb("fx").dispatch("gem",t);for(var i=0;i<5;i++)d.sb("fx").dispatch("star",t);d.sb("fx").dispatch("gem",e);for(i=0;i<5;i++)d.sb("fx").dispatch("star",e)},d.FxPart=function(){d.Image.call(this,0,0,null,.5,null),this.kill()},d.FxPart.prototype=Object.create(d.Image.prototype),d.FxPart.prototype.emptyUpdate=function(){},d.FxPart.prototype.reset=function(t){this.x=(t.position||t).x,this.y=(t.position||t).y,this.anchor.setTo(.5),this.scale.setTo(1),this.alpha=1,this.angle=0,this.blendMode=0,this.changeTexture(null),this.update=this.emptyUpdate,this.revive()},d.FxPart.prototype.init=function(t,e){this.reset(e),this[t]?this[t].apply(this,arguments):console.warn("There is no "+t+" in G.FxPart")},d.FxPart.prototype.gem=function(t,e,i,s){this.alpha=.7,this.x+=27,this.y+=33,d.changeTexture(this,"gem_tile_light"),game.add.tween(this.scale).to({x:1.5,y:1.5},350,Phaser.Easing.Cubic.Out,!0),game.add.tween(this).to({alpha:0},350,Phaser.Easing.Cubic.Out,!0).onComplete.add(this.kill,this)},d.FxPart.prototype.star=function(t,e){d.changeTexture(this,"starPart"),this.x+=54*Math.random(),this.y+=67*Math.random(),this.angle=360*Math.random(),this.velX=game.rnd.realInRange(-3,3),this.velY=game.rnd.realInRange(-3,-8),this.grav=.4,this.update=this.starUpdate},d.FxPart.prototype.starUpdate=function(){this.x+=this.velX,this.y+=this.velY,this.velX*=.99,this.velY+=this.grav,this.angle+=this.velX,0<this.velY&&(this.alpha-=.03,this.alpha<=0)&&this.kill()},d.FxPartFW=function(){d.Image.call(this)},d.FxPartFW.prototype=Object.create(d.Image.prototype),d.FxPartFW.prototype.emptyUpdate=function(){},d.FxPartFW.prototype.reset=function(t){this.x=t.x,this.y=t.y,this.anchor.setTo(.5),this.scale.setTo(1),this.alpha=1,this.angle=0,this.blendMode=0,this.changeTexture(null),this.update=this.emptyUpdate,this.revive()},d.FxPartFW.prototype.init=function(t,e){this.reset(e),this[t]?this[t].apply(this,arguments):console.warn("There is no "+t+" in G.FxPartFW")},d.FxPartFW.prototype.dust=function(){d.changeTexture(this,"dust_part"),this.angle=game.rnd.between(0,360),game.add.tween(this).to({width:2*this.width,height:2*this.height,alpha:0},500,Phaser.Easing.Sinusoidal.Out,!0).onComplete.add(this.kill,this)},d.FxPartFW.prototype.dustBig=function(){this.alpha=.4,this.scale.setTo(1),d.changeTexture(this,"dust_part"),this.angle=game.rnd.between(0,360),game.add.tween(this).to({x:this.x+50,width:4*this.width,height:4*this.height,alpha:0},1e3,Phaser.Easing.Sinusoidal.Out,!0).onComplete.add(this.kill,this)},d.FxPartFW.prototype.firework=function(t,e){d.changeTexture(this,"firework_part_"+e.color),this.blendMode=1;var i=e.spd||4,s=e.angle||game.rnd.between(0,360);this.velX=d.lengthDirX(s,i,!1),this.velY=d.lengthDirY(s,i,!1),this.timer=e.timer||20,this.timer+=game.rnd.between(0,4),this.grav=.05,this.scaleDelta=game.rnd.realInRange(-.02,.005),this.update=this.fireworkUpdate},d.FxPartFW.prototype.fireworkUpdate=function(){this.x+=this.velX,this.y+=this.velY,this.scale.setTo(this.scale.x+this.scaleDelta),this.velX*=.95,this.velY*=.95,this.velY+=this.grav,this.timer--<0&&(this.alpha-=.02,this.alpha<=0)&&this.kill()},d.GameOverWindow=function(t,e){Phaser.Group.call(this,game),this.fixedToCamera=!0,this.state=game.state.getCurrentState(),(this.state.pauseWindow=this).bg=new d.PopUpBackground,this.add(this.bg),this.points=t,this.level=d.saveState.getLevel()||0,this.gameCompleted=e,this.gameOverRibbon=d.makeImage(-190,-70,"ribbon",.5,this),this.gameOverTxt=new d.Text(-190,-70,d.txt("Game over"),{style:"ribbon",fontSize:35},.5,280),this.add(this.gameOverTxt),this.scoreRibbon=d.makeImage(190,-70,"ribbon",.5,this),this.scoreTxt=new d.Text(190,-70,d.txt("Score")+": "+t,{style:"ribbon",fontSize:35},.5,280),this.scoreTxt.addColor("#ffffff",(d.txt("Score")+": ").length),this.add(this.scoreTxt),this.restartBtn=new d.Button(0,70,"play_button",this.restart,this),this.restartBtn.addTextLabel("regular",d.txt("Restart"),50),this.restartBtn.label.y=-2,this.add(this.restartBtn),game.add.tween(this).from({alpha:0},300,Phaser.Easing.Sinusoidal.In,!0),d.sb("onScreenResize").add(this.onResize,this),this.onResize(),d.sb("onPause").dispatch(),d.saveState.resetProgress()},d.GameOverWindow.prototype=Object.create(Phaser.Group.prototype),d.GameOverWindow.prototype.onResize=function(){this.cameraOffset.x=.5*game.width,this.cameraOffset.y=.5*game.height,this.bg.onResize()},d.GameOverWindow.prototype.close=function(){},d.GameOverWindow.prototype.restart=function(){window.sdkHandler.trigger("interstitialAd",{callback:function(){d.saveState.resetProgress(),this.ignoreChildInput=!0,game.camera.fade(0,300,!0),game.camera.onFadeComplete.add(function(){game.state.start("MainMenu")})}},this)},d.GameUI=function(){Phaser.Group.call(this,game),this.state=game.state.getCurrentState(),this.bgExt=d.makeImage(0,800,"bg_hud_ext",0,this),this.bg=d.makeImage(0,0,"bg_hud",0,this),this.levelTxt=new d.OneLineText(15,185,"font",d.txt(19).toUpperCase()+":",20,100,0,1),this.levelTxt.tint=13345819,this.levelTxt.updateCache(),this.add(this.levelTxt),this.levelNr=new d.OneLineText(75,210,"font",this.state.lvlNr+1,28,150,.5,.5),this.add(this.levelNr),"ar"==d.lang&&(this.levelNr.y=215),this.timeTxt=new d.OneLineText(15,378,"font",d.txt(20).toUpperCase()+":",20,150,0,1),this.timeTxt.tint=13345819,this.timeTxt.updateCache(),this.add(this.timeTxt),this.timeController=new d.TimeController(15,380),this.add(this.timeController),this.scoreTxt=new d.OneLineText(15,276,"font",d.txt(5).toUpperCase()+":",20,100,0,1),this.scoreTxt.tint=13345819,this.scoreTxt.updateCache(),this.add(this.scoreTxt),this.pointController=new d.PointController(75,302),this.add(this.pointController),d.sb("onScreenResize").add(this.onResize,this),this.onResize()},d.GameUI.prototype=Object.create(Phaser.Group.prototype),d.GameUI.prototype.onResize=function(){this.bgExt.height=Math.max(192,game.height-800)},d.GemFlying=function(t,e,i,s){d.Image.call(this,t,e,"blog_spin_00",0);t=d.json.settings.tileSize;this.sign=d.makeImage(2+.5*t[0],12+.5*t[1],"sign ("+(i+1)+")",.5,this),this.rotating=!1,this.rotationPos=0,this.lastPos=0,this.scale.setTo(s||1)},d.GemFlying.prototype=Object.create(d.Image.prototype),d.GemFlying.prototype.update=function(){var t;this.rotating&&(t=Math.floor(this.rotationPos))!==this.lastPos&&this.changeSpriteRotPos(t)},d.GemFlying.prototype.changeSpriteRotPos=function(t){d.changeTexture(this,"blog_spin_"+(1==(t=12==t?0:t).toString().length?"0"+t:t)),this.sign.visible=0==t,this.lastPos=t},d.GemFlying.prototype.rotateTo=function(t,e){this.rotating=!0,game.add.tween(this).to({rotationPos:t},e||200,Phaser.Easing.Linear.None,!0).onComplete.add(function(){this.rotating=!1,this.changeSpriteRotPos(t)},this)},d.GemFlying.prototype.rotateTo180=function(){this.rotateTo(6)},d.GemFlying.prototype.rotateTo360=function(){this.rotateTo(12)},d.GemFlying.prototype.flyTo=function(t,e,i){this.rotateTo180(),game.add.tween(this.scale).to({x:1.25,y:1.25},500,Phaser.Easing.Sinusoidal.Out,!0).onComplete.add(function(){game.add.tween(this.scale).to({x:1.1,y:1.1},500,Phaser.Easing.Sinusoidal.In,!0)},this),game.add.tween(this).to({y:e},1e3,Phaser.Easing.Sinusoidal.InOut,!0);e=i||Math.sign(this.x-t)||game.rnd.pick([1,-1]),i=100*e;Math.sign(this.x-t)!==e&&(i=(Math.abs(this.x-t)+100)*e),game.add.tween(this).to({x:this.x+i},500,Phaser.Easing.Sinusoidal.Out,!0).onComplete.add(function(){game.add.tween(this).to({x:t},500,Phaser.Easing.Sinusoidal.InOut,!0).onComplete.add(function(){game.time.events.add(300,function(){game.add.tween(this).to({y:this.y+200,alpha:0},500,Phaser.Easing.Sinusoidal.In,!0).onComplete.add(function(){this.destroy()},this)},this)},this),game.time.events.add(200,this.rotateTo360,this)},this)},d.HintBtn=function(){d.Button.call(this,0,0,game.device.desktop?"button_hint_2":"button_hint",this.onClick,this),this.targetAlphaTermsNotFulfilled=1,this.state=game.state.getCurrentState(),this.counter=d.makeImage(38,-33,"bg_number_booster",.5,this),this.counter.text=new d.Text(0,2," ",{style:"regular",fontSize:30},.5,50),this.counter.addChild(this.counter.text),this.updateHintNumber(),this.addTerm(function(){return(0<d.saveState.getHintsAmount()||game.incentivised)&&0==this.state.board.moves.length&&!this.state.board.EMPTY&&!this.state.pause&&!this.state.pauseWindow},this),d.sb("onScreenResize").add(this.onResize,this),this.onResize(),d.sb("onBoardEmpty").add(this.hide,this),d.sb("onTimesUp").add(this.hide,this),d.sb("onHintAdded").add(this.updateHintNumber,this),game.add.tween(this).from({alpha:0},300,Phaser.Easing.Sinusoidal.Out,!0),game.add.existing(this)},d.HintBtn.prototype=Object.create(d.Button.prototype),d.HintBtn.prototype.hide=function(){this.inputEnabled=!1,this.update=function(){},game.add.tween(this).to({alpha:0},300,Phaser.Easing.Sinusoidal.Out,!0)},d.HintBtn.prototype.updateHintNumber=function(){var t=d.saveState.getHintsAmount();this.counter.text.setText(t.toString()),0==t&&game.incentivised?(this.counter.text.visible=!1,d.changeTexture(this.counter,"plus")):(this.counter.text.visible=!0,d.changeTexture(this.counter,"bg_number_booster"))},d.HintBtn.prototype.onClick=function(){0===d.saveState.getHintsAmount()?this.state.pauseWindow?this.state.pauseWindow.close():new d.RewardHintWindow:(d.saveState.useHint(),d.sb("onHint").dispatch(),this.updateHintNumber())},d.HintBtn.prototype.onResize=function(){game.device.desktop?(this.x=Math.floor(.5*game.width)+490,this.y=game.height-35):(this.x=game.width-80,this.y=game.height-60)},d.LabelValue=function(t,e,i,s,a,n){Phaser.Group.call(this,game),this.position.setTo(t,e),this.label=new d.OneLineText(0,0,"font",i,a,350,0,0),this.label.tint=13345819,this.label.updateCache(),this.add(this.label),this.value=new d.OneLineText(0,0,"font",s,a,350,0,0),this.add(this.value),this.center(this.label,this.value,n)},d.LabelValue.prototype=Object.create(Phaser.Group.prototype),d.LabelValue.prototype.center=function(t,e,i){var s=t.width+i+e.width;t.left=-.5*s,e.left=t.right+i},d.LevelCompleteTxt=function(t){Phaser.Group.call(this,game),this.txt=this.add(new d.Text(0,0,t.toUpperCase(),{fontSize:80,style:"endGameTexts"},.5,600)),this.state=game.state.getCurrentState(),this.board=this.state.board,this.update(),game.add.existing(this)},d.LevelCompleteTxt.prototype=Object.create(Phaser.Group.prototype),d.LevelCompleteTxt.prototype.update=function(){this.x=this.board.x+Math.floor(this.board.grid.width*this.board.tileWidth*.5)*this.board.scale.x,this.y=this.board.y+Math.floor((this.board.grid.height-1)*this.board.tileHeight*.5)*this.board.scale.y},d.LevelCompleteTxt.prototype.hide=function(){game.add.tween(this).to({alpha:0},300,Phaser.Easing.Sinusoidal.In,!0)},d.LoadingBar=function(t,e){Phaser.Group.call(this,game),this.rX=t,this.rY=e,this.barBg=d.makeImage(-257,0,"loading_bar_empty_2",0,this),this.barFull=d.makeImage(-257,0,"loading_bar_full_2",0,this),game.load.setPreloadSprite(this.barFull),d.sb("onScreenResize").add(this.onResize,this),this.onResize()},d.LoadingBar.prototype=Object.create(Phaser.Group.prototype),d.LoadingBar.prototype.onResize=function(){this.x=Math.floor(game.width*this.rX),this.y=Math.floor(game.height*this.rY)},d.Logo=function(t,e,i){d.Image.call(this,t,e,"logo",.5),i&&this.setRelPos(t,e),d.sb("onScreenResize").add(this.onResize,this)},d.Logo.prototype=Object.create(d.Image.prototype),d.Logo.prototype.onResize=function(){this.relPos&&(this.x=Math.floor(game.width*this.relPos.x),this.y=Math.floor(game.height*this.relPos.y))},d.Logo.prototype.setRelPos=function(t,e){this.relPos={x:t,y:e},this.onResize()},d.MainMenuBgGems=function(){Phaser.Group.call(this,game);for(var t=[[.22,.11],[.06,.24],[.11,.7],[.28,.9],[.38,.59],[.69,.08],[.68,.4],[.92,.32],[.85,.78]],e=0;e<t.length;e++)this.add(new d.MainMenuBgGem(t[e]));d.sb("onScreenResize").add(this.onResize,this),this.onResize()},d.MainMenuBgGems.prototype=Object.create(Phaser.Group.prototype),d.MainMenuBgGems.prototype.onResize=function(){this.children.forEach(function(t){t.onResize()})},d.MainMenuBgGem=function(t){this.px=t[0],this.py=t[1],d.Image.call(this,this.px*game.width,this.py*game.height,"gem_test_border_s",0),this.bottom=d.makeImage(0,0,"gem_"+game.rnd.between(0,41),0,this),this.angle=game.rnd.between(0,360),this.scale.setTo(1.5),this.onResize()},d.MainMenuBgGem.prototype=Object.create(d.Image.prototype),d.MainMenuBgGem.prototype.onResize=function(){this.x=Math.floor(this.px*game.width),this.y=Math.floor(this.py*game.height)},d.MainMenuGroup=function(){Phaser.Group.call(this,game),this.fixedToCamera=!0,this.logo=d.makeImage(0,-90,"logo",.5,this),this.playBtn=new d.Button(0,230,"button_green",function(){this.ignoreChildInput=!0,game.camera.fade(0,500,!0),game.camera.onFadeComplete.addOnce(function(){game.state.start("Game")})},this),this.playBtn.addTextLabel("font",d.txt(0).toUpperCase(),50),this.playBtn.label.y=-12,this.add(this.playBtn),this.highscore=new d.LabelValue(0,305,d.txt(1).toUpperCase(),d.saveState.data.highscore.toString(),45,70),this.add(this.highscore),d.sb("onScreenResize").add(this.onResize,this),this.onResize()},d.MainMenuGroup.prototype=Object.create(Phaser.Group.prototype),d.MainMenuGroup.prototype.onResize=function(){this.cameraOffset.x=.5*game.width,this.cameraOffset.y=.5*game.height,this.logo.scale.setTo(1);var t=game.width/this.logo.width;this.logo.scale.setTo(Math.min(t,1))},d.MainMenuPlayButton=function(t,e,i){d.Button.call(this,t,e,"play_button",function(){game.state.start("Game")},this),this.label=this.addChild(new d.Text(0,0,d.txt("Play"),{style:"regular",fontSize:50},.5,440)),i&&this.setRelPos(t,e),d.sb("onScreenResize").add(this.onResize,this),game.add.existing(this)},d.MainMenuPlayButton.prototype=Object.create(d.Button.prototype),d.MainMenuPlayButton.prototype.onResize=function(){this.relPos&&(this.x=Math.floor(game.width*this.relPos.x),this.y=Math.floor(game.height*this.relPos.y))},d.MainMenuPlayButton.prototype.setRelPos=function(t,e){this.relPos={x:t,y:e},this.onResize()},d.MenuBtn=function(){d.Button.call(this,0,0,game.device.desktop?"button_brake_2":"button_brake",this.onClick,this),this.state=game.state.getCurrentState(),d.sb("onScreenResize").add(this.onResize,this),this.onResize(),d.sb("onBoardEmpty").add(this.hide,this),d.sb("onTimesUp").add(this.hide,this),game.add.tween(this).from({alpha:0},300,Phaser.Easing.Sinusoidal.Out,!0),game.add.existing(this)},d.MenuBtn.prototype=Object.create(d.Button.prototype),d.MenuBtn.prototype.hide=function(){this.inputEnabled=!1,this.update=function(){},game.add.tween(this).to({alpha:0},300,Phaser.Easing.Sinusoidal.Out,!0)},d.MenuBtn.prototype.onClick=function(){this.state.pauseWindow?this.state.pauseWindow.close():new d.PauseWindow},d.MenuBtn.prototype.onResize=function(){game.device.desktop?(this.x=Math.floor(.5*game.width)+420,this.y=game.height-35):(this.x=65,this.y=game.height-60)},d.PauseNotificator=function(){Phaser.Group.call(this,game),this.pauseShadowTxt=new d.OneLineText(-5,-2,"font","Pause",90,500,.5,.5),this.pauseShadowTxt.tint=0,this.pauseShadowTxt.updateCache(),this.add(this.pauseShadowTxt),game.add.tween(this.pauseShadowTxt).to({x:5},8e3,Phaser.Easing.Sinusoidal.InOut,!0,0,-1,!0),game.add.tween(this.pauseShadowTxt).to({y:8},8e3,Phaser.Easing.Sinusoidal.InOut,!0,0,-1,!0),this.pauseTxt=new d.OneLineText(0,0,"font","Pause",90,500,.5,.5),this.add(this.pauseTxt),this.pauseTxt.angle=-5,game.add.tween(this.pauseTxt).to({angle:5},8e3,Phaser.Easing.Sinusoidal.InOut,!0,0,-1,!0),this.alpha=0,d.sb("onScreenResize").add(this.onResize,this),d.sb("onPause").add(this.show,this),d.sb("onUnpause").add(this.hide,this)},d.PauseNotificator.prototype=Object.create(Phaser.Group.prototype),d.PauseNotificator.prototype.update=function(){this.pauseShadowTxt.angle=this.pauseTxt.angle},d.PauseNotificator.prototype.onResize=function(){this.x=.5*game.width,this.y=.4*game.height},d.PauseNotificator.prototype.show=function(){d.stopTweens(this),game.add.tween(this).to({alpha:1},300,Phaser.Easing.Sinusoidal.Out,!0)},d.PauseNotificator.prototype.hide=function(){d.stopTweens(this),game.add.tween(this).to({alpha:0},300,Phaser.Easing.Sinusoidal.Out,!0)},d.PauseWindow=function(){Phaser.Group.call(this,game),this.fixedToCamera=!0,this.state=game.state.getCurrentState(),(this.state.pauseWindow=this).bg=new d.PopUpBackground,this.add(this.bg),this.ribbon=d.makeImage(0,-100,"ribbon",.5,this),this.pauseTxt=new d.Text(0,-100,d.txt("Pause"),{style:"ribbon",fontSize:40},.5,280),this.add(this.pauseTxt),game.add.tween(this).from({alpha:0},300,Phaser.Easing.Sinusoidal.In,!0),this.restartBtn=new d.Button(0,100,"play_button",this.restart,this),this.restartBtn.addTextLabel("regular",d.txt("Restart"),50),this.restartBtn.label.y=-2,this.add(this.restartBtn),this.continueBtn=new d.Button(0,10,"play_button",this.close,this),this.continueBtn.addTextLabel("regular",d.txt("Resume"),50),this.continueBtn.label.y=-2,this.add(this.continueBtn),game.device.desktop||(this.soundBtn=new d.SoundBtn,this.add(this.soundBtn)),this.resizeBinding=d.sb("onScreenResize").add(this.onResize,this),this.onDestroy.add(function(){this.resizeBinding&&this.resizeBinding.detach()},this),this.onResize(),d.sb("onPause").dispatch(),d.sfx.music.pause()},d.PauseWindow.prototype=Object.create(Phaser.Group.prototype),d.PauseWindow.prototype.onResize=function(){this.cameraOffset.x=.5*game.width,this.cameraOffset.y=.5*game.height,this.bg.onResize(),this.soundBtn&&(this.soundBtn.x=.5*game.width-55,this.soundBtn.y=-95)},d.PauseWindow.prototype.close=function(){window.sdkHandler.trigger("interstitialAd",{callback:function(){this.ignoreChildInput=!0,d.sb("onUnpause").dispatch(),game.add.tween(this).to({alpha:0},300,Phaser.Easing.Sinusoidal.In,!0).onComplete.add(function(){this.destroy(),this.state.pauseWindow=null},this),d.sfx.musicEnable&&d.sfx.music.resume()}},this)},d.PauseWindow.prototype.restart=function(){window.sdkHandler.trigger("interstitialAd",{callback:function(){d.saveState.resetProgress(),this.ignoreChildInput=!0,game.camera.fade(0,300,!0),game.camera.onFadeComplete.add(function(){game.state.start("MainMenu")}),d.sfx.musicEnable&&d.sfx.music.resume()}},this)},d.PointController=function(t,e){Phaser.Group.call(this,game),this.position.setTo(t,e),this.points=d.saveState.getPoints(),this.counter=new d.TextCounter(0,0,this.points,{style:game.device.desktop?"regular":"endGameTexts",fontSize:40},.5,150),game.device.desktop||(this.counter.padding.x=6,this.counter.padding.y=6,this.counter.setShadow(4,6,"rgba(0,0,0,0.2)",6)),this.add(this.counter),this.forMatch=d.json.settings.pointsForMatch,this.forHint=d.json.settings.hintPenalty,this.combo=1,this.lastMatchTimestamp=0,d.sb("onMatch").add(this.onMatch,this),d.sb("onHint").add(this.onHint,this),d.sb("onTimeBonus").add(this.onTimeBonus,this)},d.PointController.prototype=Object.create(Phaser.Group.prototype),d.PointController.prototype.onMatch=function(){Date.now()-this.lastMatchTimestamp<=d.json.settings.comboTime?(this.combo++,10<this.combo&&(this.combo=2),d.sb("onComboIncreased").dispatch(this.combo)):this.combo=1,this.lastMatchTimestamp=Date.now(),this.points+=this.forMatch*this.combo,this.counter.setAmount(this.points),d.saveState.setPoints(this.points)},d.PointController.prototype.onHint=function(){this.points-=this.forHint,this.points=Math.max(0,this.points),this.counter.setAmount(this.points),d.saveState.setPoints(this.points),d.sfx.musicEnable&&d.sfx.hint.play()},d.PointController.prototype.onTimeBonus=function(t){this.points+=d.json.settings.bonusPerSecond*(t||1),this.counter.setAmount(this.points),d.saveState.setPoints(this.points),d.sfx.musicEnable&&d.sfx.pop.play()},d.PopUpBackground=function(){Phaser.Group.call(this,game),this.onResize()},d.PopUpBackground.prototype=Object.create(Phaser.Group.prototype),d.PopUpBackground.prototype.onResize=function(){for(var t=Math.ceil(game.width/576);this.children.length<t;)d.makeImage(576*this.children.length,0,"popup",[0,.5],this);this.pivot.x=Math.floor(576*this.children.length*.5)},d.PreloaderDot=function(t,e,i){Phaser.Group.call(this,game),this.rX=t,this.rY=e,this.config=i||{},this.gfx=this.add(this.addDotsGfx()),this.txt=this.add(new d.Text(0,0,"0%",{font:"LascoBold",fontSize:"28px",fill:this.config.textColor||"white"},.5)),this.frameCounter=0,this.frameEvery=6,game.load.onFileComplete.add(function(t){this.txt.setText(t+"%")},this),d.sb("onScreenResize").add(this.onResize,this),this.onResize()},d.PreloaderDot.prototype=Object.create(Phaser.Group.prototype),d.PreloaderDot.prototype.onResize=function(){this.x=game.width*this.rX,this.y=game.height*this.rY},d.PreloaderDot.prototype.update=function(){this.frameCounter++%this.frameEvery==0&&(this.gfx.angle+=45)},d.PreloaderDot.prototype.addDotsGfx=function(){for(var t=game.add.graphics(),e=0;e<6;e++){var i=d.lengthDirX(45*e,60,!1),s=d.lengthDirY(45*e,60,!1);t.beginFill(this.config.dotColor||16777215,e/6),t.drawCircle(i,s,15)}return t},d.RewardHintWindow=function(){Phaser.Group.call(this,game),this.fixedToCamera=!0,this.state=game.state.getCurrentState(),(this.state.pauseWindow=this).bg=new d.PopUpBackground,this.add(this.bg),this.ribbon=d.makeImage(0,-100,"ribbon",.5,this),this.ribbon.scale.x=1.5,this.pauseTxt=new d.Text(0,-100,d.txt("getHints"),{style:"ribbon",fontSize:40},.5,400),this.add(this.pauseTxt),game.add.tween(this).from({alpha:0},300,Phaser.Easing.Sinusoidal.In,!0),this.watchAdBtn=new d.Button(0,10,"play_button",this.showAd,this),this.watchAdBtn.addTextLabel("regular",d.txt("watchAd"),50),this.watchAdBtn.label.y=-2,this.add(this.watchAdBtn),this.continueBtn=new d.Button(0,100,"play_button",this.close,this),this.continueBtn.addTextLabel("regular",d.txt("noThx"),50),this.continueBtn.label.y=-2,this.add(this.continueBtn),this.resizeBinding=d.sb("onScreenResize").add(this.onResize,this),this.onDestroy.add(function(){this.resizeBinding&&this.resizeBinding.detach()},this),this.onResize(),d.sb("onPause").dispatch()},d.RewardHintWindow.prototype=Object.create(Phaser.Group.prototype),d.RewardHintWindow.prototype.onResize=function(){this.cameraOffset.x=.5*game.width,this.cameraOffset.y=.5*game.height,this.bg.onResize()},d.RewardHintWindow.prototype.close=function(){this.closeClose()},d.RewardHintWindow.prototype.closeClose=function(){this.ignoreChildInput=!0,d.sb("onUnpause").dispatch(),game.add.tween(this).to({alpha:0},300,Phaser.Easing.Sinusoidal.In,!0).onComplete.add(function(){this.destroy(),this.state.pauseWindow=null},this)},d.RewardHintWindow.prototype.showAd=function(){window.sdkHandler.trigger("rewardedAd",{callback:function(t){!0===t&&(d.saveState.addHints(3),d.sb("onHintAdded").dispatch()),this.closeClose()}},this)},d.SoundBtn=function(){d.Button.call(this,0,0,"button_sound_off_2",function(){d.sfx.musicEnable?d.sfx.music.pause():d.sfx.music.resume(),d.sfx.musicEnable=!d.sfx.musicEnable,this.refreshSprite()},this),this.refreshSprite(),this.onResizeBinding=d.sb("onScreenResize").add(this.onResize,this),this.onResize(),this.events.onDestroy.add(function(){this.onResizeBinding&&this.onResizeBinding.detach()},this),game.add.existing(this)},d.SoundBtn.prototype=Object.create(d.Button.prototype),d.SoundBtn.prototype.refreshSprite=function(){var t=d.sfx.musicEnable?"button_sound_on":"button_sound_off";game.device.desktop&&(t+="_2"),d.changeTexture(this,t),d.saveState.save()},d.SoundBtn.prototype.onResize=function(){game.device.desktop&&(this.x=Math.floor(.5*game.width)-520,this.y=game.height-35)},d.TimeController=function(t,e){Phaser.Group.call(this,game),this.state=game.state.getCurrentState(),this.board=this.state.board,this.position.setTo(t,e),this.bonusPointsPart=0,game.device.desktop?this.timeUI=new d.TimeControllerBar(0,0):this.timeUI=new d.TimeControllerArc(0,0),this.add(this.timeUI),this.timerFlashingSec=d.json.settings.timerFlashingSec,this.secForMatch=(void 0!==this.state.lvlData.secForMatch?this.state.lvlData:d.json.settings).secForMatch,this.timeMax=this.state.lvlData.timeSec||d.json.settings.timeSec,this.timeCurrent=this.timeMax,this.timeCurrentLerp=this.timeCurrent,this.lastFullSec=Math.ceil(this.timeCurrent),this.paused=!1,d.sb("onPause").add(function(){this.paused=!0},this),d.sb("onUnpause").add(function(){this.paused=!1},this),d.sb("onBoardEmpty").add(function(){this.lastFullSec=Math.ceil(this.timeCurrent),d.sb("onTimeBonus").dispatch(Math.ceil(this.timeCurrent)),game.time.events.add(2e3,function(){d.sb("onBonusTimeZero").dispatch()})},this),d.sb("onMatch").add(this.onMatch,this)},d.TimeController.prototype=Object.create(Phaser.Group.prototype),d.TimeController.prototype.update=function(){this.paused||(this.timeCurrent-=.0166,this.timeCurrentLerp=d.lerp(this.timeCurrentLerp,this.timeCurrent,.05),this.lastFullSec!==Math.ceil(this.timeCurrent)&&this.lastFullSec<=10&&d.sfx.musicEnable&&d.sfx.timer.play(),this.lastFullSec=Math.ceil(this.timeCurrent),this.timeUI.update(this.timeCurrentLerp/this.timeMax,this.timeCurrent<this.timerFlashingSec),this.timeCurrent<=0&&0==this.board.moves.length&&(this.update=function(){},d.sb("onTimesUp").dispatch()))},d.TimeController.prototype.onMatch=function(){this.timeCurrent=game.math.clamp(this.timeCurrent+this.secForMatch,0,this.timeMax)},d.saveState={makeNewDataObject:function(){return{musicEnable:!0,lvl:0,hints:d.json.settings.hintsNr,points:0,highscore:0,tutorial:2}},save:function(){this.data.musicEnable=d.sfx.musicEnable,this.data.desktop=game.device.desktop,window.localStorage.setItem("gm-mahjongconnect",JSON.stringify(this.data))},init:function(){var t=window.localStorage.getItem("gm-mahjongconnect");t?(this.data=JSON.parse(t),0===this.getLevel()&&(this.data.hints=d.json.settings.hintsNr,this.data.points=0,this.data.tutorial=2)):this.data=this.makeNewDataObject(),d.sfx.musicEnable=this.data.musicEnable,this.ready=!0},resetProgress:function(){console.log("resetProgress"),this.data=this.makeNewDataObject(),this.save()},getTutorial:function(){return this.data.tutorial},tutorialStep:function(){--this.data.tutorial},getLevel:function(){return this.data.lvl},setLevel:function(t){this.data.lvl=t},levelEnd:function(t){t&&this.data.lvl++,this.save()},useHint:function(){this.data.hints--,this.save()},addHints:function(t){this.data.hints+=t,this.save()},getHintsAmount:function(){return this.data.hints},getPoints:function(){return this.data.points},setPoints:function(t){this.data.points=t}},d.TimeControllerArc=function(t,e){Phaser.Group.call(this,game),this.position.setTo(t,e),this.bg=d.makeImage(0,0,"mobile_time",[.5,1],this),this.arc=d.makeImage(0,-26,"mobile_time_bar",[.5,1],this),this.arcHl=d.makeImage(0,0,"mobile_time_bar_hl",[.5,1],this.arc),this.arcHl.alphaVis=0,this.arcHl.alphaPulse=0,game.add.tween(this.arcHl).to({alphaPulse:1},300,Phaser.Easing.Sinusoidal.InOut,!0,0,-1,!0),this.maskGfx=game.make.graphics(),this.arc.addChild(this.maskGfx),this.arc.mask=this.maskGfx},d.TimeControllerArc.prototype=Object.create(Phaser.Group.prototype),d.TimeControllerArc.prototype.update=function(t,e){this.drawMaskArc(t),this.arcHl.alphaVis=d.lerp(this.arcHl.alphaVis,e?1:0,.1),this.arcHl.alpha=this.arcHl.alphaVis*this.arcHl.alphaPulse},d.TimeControllerArc.prototype.drawMaskArc=function(t){t=180+180*t;this.maskGfx.clear(),this.maskGfx.beginFill(0),d.drawCircleSegment(this.maskGfx,0,0,190,179,t)},d.TimeControllerBar=function(t,e){Phaser.Group.call(this,game),this.position.setTo(t,e),this.bg=d.makeImage(0,0,"loading_bar_empty_2",0,this),this.full=d.makeImage(0,0,"loading_bar_full_2",0,this),this.fullHl=d.makeImage(0,0,"loading_bar_full_hl_2",0,this),this.full.cropRect=new Phaser.Rectangle(0,0,514,20),this.fullHl.cropRect=this.full.cropRect,this.fullHl.alphaPulse=0,this.fullHl.alphaVis=0,game.add.tween(this.fullHl).to({alphaPulse:1},300,Phaser.Easing.Sinusoidal.InOut,!0,0,-1,!0)},d.TimeControllerBar.prototype=Object.create(Phaser.Group.prototype),d.TimeControllerBar.prototype.update=function(t,e){this.full.cropRect.width=Math.max(0,Math.floor(514*t)),this.full.updateCrop(),this.fullHl.updateCrop(),this.fullHl.alphaVis=d.lerp(this.fullHl.alphaVis,e?1:0,.1),this.fullHl.alpha=this.fullHl.alphaVis*this.fullHl.alphaPulse},d.UIBar=function(){Phaser.Group.call(this,game),this.state=game.state.getCurrentState(),game.device.desktop?this.initDesktop():this.initMobile(),d.sb("onScreenResize").add(this.onResize,this),this.onResize()},d.UIBar.prototype=Object.create(Phaser.Group.prototype),d.UIBar.prototype.initDesktop=function(){this.bg=d.makeImage(0,0,"ui_bar",[.5,1],this),this.levelNr=this.add(new d.Text(300,-35,this.state.lvlNr+1,{style:"regular",fontSize:40},[0,.5])),this.pointController=new d.PointController(-370,-35),this.add(this.pointController),this.progressBar=new d.TimeController(-257,-30),this.add(this.progressBar),this.timeLabel=new d.Text(0,-45,d.txt("Time"),{style:"regular",fontSize:25},.5),this.add(this.timeLabel)},d.UIBar.prototype.initMobile=function(){this.levelNr=this.add(new d.Text(190,-55,this.state.lvlNr+1,{style:"endGameTexts",fontSize:40},.5)),this.levelNr.padding.x=6,this.levelNr.padding.y=6,this.levelNr.setShadow(4,6,"rgba(0,0,0,0.2)",6),this.pointController=new d.PointController(-190,-55),this.add(this.pointController),this.progressBar=new d.TimeController(0,0),this.add(this.progressBar)},d.UIBar.prototype.onResize=function(){this.x=Math.floor(.5*game.width),this.y=game.height,this.bg&&(this.bg.width=game.width)},window.initGame=function(){var s=new Phaser.Game(1200,800,Phaser.CANVAS,"content",null,!0);(window.game=s).state.add("Boot",d.Boot),s.state.add("Preloader",d.Preloader),s.state.add("MainMenu",d.MainMenu),s.state.add("Game",d.Game),s.state.add("GameProto",d.GameProto),s.state.add("Test",d.Test),sgSdk.initialize([],{supportedLanguages:["en","de","es","it","pt","ru","tr","pl","fr","nl","ja"]},function(t,e,i){t?console.log(t):(window.sgSettings=e,window.sdkHandler=i,d.lang=window.sgSettings.config.env.locale,s.state.start("Boot"))})},d.ASSETS={spritesheets:["BOOT-loader","gems","ssheet"],sfx:["boom.mp3","btn_pressed.mp3","combo_01.mp3","combo_02.mp3","combo_03.mp3","combo_04.mp3","combo_05.mp3","combo_06.mp3","combo_07.mp3","combo_08.mp3","combo_09.mp3","firework.mp3","firework2.mp3","game_over.mp3","game_won.mp3","hint.mp3","match.mp3","music.mp3","new_highscore.mp3","new_level.mp3","pop.mp3","score_counter.mp3","stone_selection.mp3","stones_touch.mp3","timer.mp3"],images:["bg_h.png","bg_v.png"],json:["languages.json","settings.json"],fonts:{}}}();