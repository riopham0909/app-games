!function(e){function i(){for(var e=0;e<E.length;e++)E[e][0](E[e][1]);f=!(E=[])}function n(e,t){E.push([e,t]),f||(f=!0,w(i,0))}function t(e,t){function i(e){h(t,e)}try{e(function(e){o(t,e)},i)}catch(e){i(e)}}function s(t){var e=(i=t.owner).state_,i=i.data_,n=t[e];if(t=t.then,"function"==typeof n){e=T;try{i=n(i)}catch(e){h(t,e)}}a(t,i)||(e===T&&o(t,i),e===v&&h(t,i))}function a(t,i){var n;try{if(t===i)throw new TypeError("A promises callback cannot return that same promise.");if(i&&("function"==typeof i||"object"==typeof i)){var e=i.then;if("function"==typeof e)return e.call(i,function(e){n||(n=!0,(i!==e?o:r)(t,e))},function(e){n||(n=!0,h(t,e))}),1}}catch(e){return n||h(t,e),1}}function o(e,t){e!==t&&a(e,t)||r(e,t)}function r(e,t){e.state_===y&&(e.state_=S,e.data_=t,n(d,e))}function h(e,t){e.state_===y&&(e.state_=S,e.data_=t,n(u,e))}function l(e){var t=e.then_;for(e.then_=void 0,e=0;e<t.length;e++)s(t[e])}function d(e){e.state_=T,l(e)}function u(e){e.state_=v,l(e)}function c(e){if("function"!=typeof e)throw new TypeError("Promise constructor takes a function argument");if(!1==this instanceof c)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],t(e,this)}function g(){}var p,f,m=e.Promise,_=m&&"resolve"in m&&"reject"in m&&"all"in m&&"race"in m&&(new m(function(e){p=e}),"function"==typeof p),y=("undefined"!=typeof exports&&exports?(exports.Promise=_?m:c,exports.Polyfill=c):"function"==typeof define&&define.amd?define(function(){return _?m:c}):_||(e.Promise=c),"pending"),S="sealed",T="fulfilled",v="rejected",w="undefined"!=typeof setImmediate?setImmediate:setTimeout,E=[];c.prototype={constructor:c,state_:y,then_:null,data_:void 0,then:function(e,t){e={owner:this,then:new this.constructor(g),fulfilled:e,rejected:t};return this.state_===T||this.state_===v?n(s,e):this.then_.push(e),e.then},catch:function(e){return this.then(null,e)}},c.all=function(o){if("[object Array]"!==Object.prototype.toString.call(o))throw new TypeError("You must pass an array to Promise.all().");return new this(function(i,e){for(var t,n=[],s=0,a=0;a<o.length;a++)(t=o[a])&&"function"==typeof t.then?t.then(function(t){return s++,function(e){n[t]=e,--s||i(n)}}(a),e):n[a]=t;s||i(n)})},c.race=function(s){if("[object Array]"!==Object.prototype.toString.call(s))throw new TypeError("You must pass an array to Promise.race().");return new this(function(e,t){for(var i,n=0;n<s.length;n++)(i=s[n])&&"function"==typeof i.then?i.then(e,t):e(i)})},c.resolve=function(t){return t&&"object"==typeof t&&t.constructor===this?t:new this(function(e){e(t)})},c.reject=function(i){return new this(function(e,t){t(i)})}}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.i18nextBrowserLanguageDetector=t()}(this,function(){"use strict";var e=[],n=e.forEach,s=e.slice;var i=function(e,t,i,n){var s,a=void 0,a=i?((s=new Date).setTime(s.getTime()+60*i*1e3),"; expires="+s.toGMTString()):"";n=n?"domain="+n+";":"",document.cookie=e+"="+t+a+";"+n+"path=/"},a=function(e){for(var t=e+"=",i=document.cookie.split(";"),n=0;n<i.length;n++){for(var s=i[n];" "===s.charAt(0);)s=s.substring(1,s.length);if(0===s.indexOf(t))return s.substring(t.length,s.length)}return null},o={name:"cookie",lookup:function(e){var t=void 0;return t=e.lookupCookie&&"undefined"!=typeof document&&(e=a(e.lookupCookie))?e:t},cacheUserLanguage:function(e,t){t.lookupCookie&&"undefined"!=typeof document&&i(t.lookupCookie,e,t.cookieMinutes,t.cookieDomain)}},r={name:"querystring",lookup:function(e){var t=void 0;if("undefined"!=typeof window)for(var i=window.location.search.substring(1).split("&"),n=0;n<i.length;n++){var s=i[n].indexOf("=");0<s&&i[n].substring(0,s)===e.lookupQuerystring&&(t=i[n].substring(s+1))}return t}},h=void 0;try{var h="undefined"!==window&&null!==window.localStorage,t="i18next.translate.boo";window.localStorage.setItem(t,"foo"),window.localStorage.removeItem(t)}catch(e){h=!1}var l={name:"localStorage",lookup:function(e){var t=void 0;return t=e.lookupLocalStorage&&h&&(e=window.localStorage.getItem(e.lookupLocalStorage))?e:t},cacheUserLanguage:function(e,t){t.lookupLocalStorage&&h&&window.localStorage.setItem(t.lookupLocalStorage,e)}},d={name:"navigator",lookup:function(e){var t=[];if("undefined"!=typeof navigator){if(navigator.languages)for(var i=0;i<navigator.languages.length;i++)t.push(navigator.languages[i]);navigator.userLanguage&&t.push(navigator.userLanguage),navigator.language&&t.push(navigator.language)}return 0<t.length?t:void 0}},u={name:"htmlTag",lookup:function(e){var t=void 0,e=e.htmlTag||("undefined"!=typeof document?document.documentElement:null);return t=e&&"function"==typeof e.getAttribute?e.getAttribute("lang"):t}},c={name:"path",lookup:function(e){var t=void 0;if("undefined"!=typeof window){var i=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(i instanceof Array)if("number"==typeof e.lookupFromPathIndex){if("string"!=typeof i[e.lookupFromPathIndex])return;t=i[e.lookupFromPathIndex].replace("/","")}else t=i[0].replace("/","")}return t}},g={name:"subdomain",lookup:function(e){var t,i=void 0;return i="undefined"!=typeof window&&(t=window.location.href.match(/(?:http[s]*\:\/\/)*(.*?)\.(?=[^\/]*\..{2,5})/gi))instanceof Array?("number"==typeof e.lookupFromSubdomainIndex?t[e.lookupFromSubdomainIndex]:t[0]).replace("http://","").replace("https://","").replace(".",""):i}};function p(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(function(e,t,i){t&&p(e.prototype,t),i&&p(e,i)})(f,[{key:"init",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};this.services=e,this.options=function(i){return n.call(s.call(arguments,1),function(e){if(e)for(var t in e)void 0===i[t]&&(i[t]=e[t])}),i}(t,this.options||{},{order:["querystring","cookie","localStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],checkWhitelist:!0}),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=i,this.addDetector(o),this.addDetector(r),this.addDetector(l),this.addDetector(d),this.addDetector(u),this.addDetector(c),this.addDetector(g)}},{key:"addDetector",value:function(e){this.detectors[e.name]=e}},{key:"detect",value:function(e){var t=this,i=(e=e||this.options.order,[]),n=(e.forEach(function(e){t.detectors[e]&&(e=(e=t.detectors[e].lookup(t.options))&&"string"==typeof e?[e]:e)&&(i=i.concat(e))}),void 0);return i.forEach(function(e){n||(e=t.services.languageUtils.formatLanguageCode(e),t.options.checkWhitelist&&!t.services.languageUtils.isWhitelisted(e))||(n=e)}),n||(e=(e="string"==typeof(e=this.i18nOptions.fallbackLng)?[e]:e)||[],n="[object Array]"===Object.prototype.toString.apply(e)?e[0]:e[0]||e.default&&e.default[0]),n}},{key:"cacheUserLanguage",value:function(t,e){var i=this;!(e=e||this.options.caches)||this.options.excludeCacheFor&&-1<this.options.excludeCacheFor.indexOf(t)||e.forEach(function(e){i.detectors[e]&&i.detectors[e].cacheUserLanguage(t,i.options)})}}]);e=f;function f(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=this,n=f;if(!(i instanceof n))throw new TypeError("Cannot call a class as a function");this.type="languageDetector",this.detectors={},this.init(e,t)}return e.type="languageDetector",e});var Orca,Quartz,AzerionIntegration,Fabrique,ButterflyKyodai,CryptoJS=CryptoJS||function(r){function i(){}var e={},t=e.lib={},n=t.Base={extend:function(e){i.prototype=this;var t=new i;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),(t.init.prototype=t).$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},h=t.WordArray=n.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||a).stringify(this)},concat:function(e){var t=this.words,i=e.words,n=this.sigBytes;if(e=e.sigBytes,this.clamp(),n%4)for(var s=0;s<e;s++)t[n+s>>>2]|=(i[s>>>2]>>>24-s%4*8&255)<<24-(n+s)%4*8;else if(65535<i.length)for(s=0;s<e;s+=4)t[n+s>>>2]=i[s>>>2];else t.push.apply(t,i);return this.sigBytes+=e,this},clamp:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8,e.length=r.ceil(t/4)},clone:function(){var e=n.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],i=0;i<e;i+=4)t.push(4294967296*r.random()|0);return new h.init(t,e)}}),s=e.enc={},a=s.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var i=[],n=0;n<e;n++){var s=t[n>>>2]>>>24-n%4*8&255;i.push((s>>>4).toString(16)),i.push((15&s).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,i=[],n=0;n<t;n+=2)i[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new h.init(i,t/2)}},o=s.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var i=[],n=0;n<e;n++)i.push(String.fromCharCode(t[n>>>2]>>>24-n%4*8&255));return i.join("")},parse:function(e){for(var t=e.length,i=[],n=0;n<t;n++)i[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new h.init(i,t)}},l=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(o.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return o.parse(unescape(encodeURIComponent(e)))}},d=t.BufferedBlockAlgorithm=n.extend({reset:function(){this._data=new h.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var t=this._data,i=t.words,n=t.sigBytes,s=this.blockSize,a=n/(4*s),a=e?r.ceil(a):r.max((0|a)-this._minBufferSize,0),n=r.min(4*(e=a*s),n);if(e){for(var o=0;o<e;o+=s)this._doProcessBlock(i,o);o=i.splice(0,e),t.sigBytes-=n}return new h.init(o,n)},clone:function(){var e=n.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),u=(t.Hasher=d.extend({cfg:n.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(i){return function(e,t){return new i.init(t).finalize(e)}},_createHmacHelper:function(i){return function(e,t){return new u.HMAC.init(i,t).finalize(e)}}}),e.algo={});return e}(Math),__extends=(!function(){var e=CryptoJS,t=(n=e.lib).WordArray,i=n.Hasher,d=[],n=e.algo.SHA1=i.extend({_doReset:function(){this._hash=new t.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var i,n=this._hash.words,s=n[0],a=n[1],o=n[2],r=n[3],h=n[4],l=0;l<80;l++)d[l]=l<16?0|e[t+l]:(i=d[l-3]^d[l-8]^d[l-14]^d[l-16])<<1|i>>>31,i=(s<<5|s>>>27)+h+d[l],i=l<20?i+(1518500249+(a&o|~a&r)):l<40?i+(1859775393+(a^o^r)):l<60?i+((a&o|a&r|o&r)-1894007588):i+((a^o^r)-899497514),h=r,r=o,o=a<<30|a>>>2,a=s,s=i;n[0]=n[0]+s|0,n[1]=n[1]+a|0,n[2]=n[2]+o|0,n[3]=n[3]+r|0,n[4]=n[4]+h|0},_doFinalize:function(){var e=this._data,t=e.words,i=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[14+(64+n>>>9<<4)]=Math.floor(i/4294967296),t[15+(64+n>>>9<<4)]=i,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA1=i._createHelper(n),e.HmacSHA1=i._createHmacHelper(n)}(),function(){var e=CryptoJS,r=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=r.parse(t));var i=e.blockSize,n=4*i;(t=t.sigBytes>n?e.finalize(t):t).clamp();for(var e=this._oKey=t.clone(),t=this._iKey=t.clone(),s=e.words,a=t.words,o=0;o<i;o++)s[o]^=1549556828,a[o]^=909522486;e.sigBytes=t.sigBytes=n,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}})}(),!function(e){(t=e.Command||(e.Command={}))[t.highscore=0]="highscore";var t,s=e.Command;function i(){}i.sendMessage=function(e,t){var i=new MessageChannel,n={command:s[e],value:t,time:Date.now()};return n.hash=CryptoJS.HmacSHA1(JSON.stringify(n),"sbncvhiwebcyiowebcuio12378eh2d3cdhbwe8hc").toString(),new Promise(function(t,e){i.port1.onmessage=function(e){t(e.data)};try{window.parent.postMessage(n,document.referrer,[i.port2])}catch(e){}})},e.Communication=i}(Orca=Orca||{}),!function(){function H(e,t,i){return e.call.apply(e.bind,arguments)}function G(t,i,e){var n;if(t)return 2<arguments.length?(n=Array.prototype.slice.call(arguments,2),function(){var e=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(e,n),t.apply(i,e)}):function(){return t.apply(i,arguments)};throw Error()}function p(e,t,i){return(p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?H:G).apply(null,arguments)}var r=Date.now||function(){return+new Date};function F(e,t){this.a=e,this.o=t||e,this.c=this.o.document}var U=!!window.FontFace;function h(e,t,i,n){if(t=e.c.createElement(t),i)for(var s in i)i.hasOwnProperty(s)&&("style"==s?t.style.cssText=i[s]:t.setAttribute(s,i[s]));return n&&t.appendChild(e.c.createTextNode(n)),t}function l(e,t,i){(e=(e=e.c.getElementsByTagName(t)[0])||document.documentElement).insertBefore(i,e.lastChild)}function i(e){e.parentNode&&e.parentNode.removeChild(e)}function f(e,t,i){t=t||[],i=i||[];for(var n=e.className.split(/\s+/),s=0;s<t.length;s+=1){for(var a=!1,o=0;o<n.length;o+=1)if(t[s]===n[o]){a=!0;break}a||n.push(t[s])}for(t=[],s=0;s<n.length;s+=1){for(a=!1,o=0;o<i.length;o+=1)if(n[s]===i[o]){a=!0;break}a||t.push(n[s])}e.className=t.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function a(e,t){for(var i=e.className.split(/\s+/),n=0,s=i.length;n<s;n++)if(i[n]==t)return!0;return!1}function b(e,t,i){function n(){o&&s&&(o(a),o=null)}t=h(e,"link",{rel:"stylesheet",href:t,media:"all"});var s=!1,a=null,o=i||null;U?(t.onload=function(){s=!0,n()},t.onerror=function(){s=!0,a=Error("Stylesheet failed to load"),n()}):setTimeout(function(){s=!0,n()},0),l(e,"head",t)}function n(e,t,i,n){var s,a,o=e.c.getElementsByTagName("head")[0];return o?(s=h(e,"script",{src:t}),a=!1,s.onload=s.onreadystatechange=function(){a||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(a=!0,i&&i(null),s.onload=s.onreadystatechange=null,"HEAD"==s.parentNode.tagName&&o.removeChild(s))},o.appendChild(s),setTimeout(function(){a||(a=!0,i&&i(Error("Script load timeout")))},n||5e3),s):null}function I(){this.a=0,this.c=null}function C(e){return e.a++,function(){e.a--,s(e)}}function A(e,t){e.c=t,s(e)}function s(e){0==e.a&&e.c&&(e.c(),e.c=null)}function o(e){this.a=e||"-"}function P(e,t){this.c=e,this.f=4,this.a="n";e=(t||"n4").match(/^([nio])([1-9])$/i);e&&(this.a=e[1],this.f=parseInt(e[2],10))}function d(e){var t=[];e=e.split(/,\s*/);for(var i=0;i<e.length;i++){var n=e[i].replace(/['"]/g,"");-1!=n.indexOf(" ")||/^\d/.test(n)?t.push("'"+n+"'"):t.push(n)}return t.join(",")}function m(e){return e.a+e.f}function u(e){var t="normal";return"o"===e.a?t="oblique":"i"===e.a&&(t="italic"),t}function M(e,t){this.c=e,this.f=e.o.document.documentElement,this.h=t,this.a=new o("-"),this.j=!1!==t.events,this.g=!1!==t.classes}function _(e){var t,i,n;e.g&&(t=a(e.f,e.a.c("wf","active")),i=[],n=[e.a.c("wf","loading")],t||i.push(e.a.c("wf","inactive")),f(e.f,i,n)),y(e,"inactive")}function y(e,t,i){e.j&&e.h[t]&&(i?e.h[t](i.c,m(i)):e.h[t]())}function D(){this.c={}}function c(e,t){this.c=e,this.f=t,this.a=h(this.c,"span",{"aria-hidden":"true"},this.f)}function g(e){l(e.c,"body",e.a)}function S(e){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+d(e.c)+";font-style:"+u(e)+";font-weight:"+e.f+"00;"}function T(e,t,i,n,s,a){this.g=e,this.j=t,this.a=n,this.c=i,this.f=s||3e3,this.h=a||void 0}function v(e,t,i,n,s,a,o){this.v=e,this.B=t,this.c=i,this.a=n,this.s=o||"BESbswy",this.f={},this.w=s||3e3,this.u=a||null,this.m=this.j=this.h=this.g=null,this.g=new c(this.c,this.s),this.h=new c(this.c,this.s),this.j=new c(this.c,this.s),this.m=new c(this.c,this.s),e=S(e=new P(this.a.c+",serif",m(this.a))),this.g.a.style.cssText=e,e=S(e=new P(this.a.c+",sans-serif",m(this.a))),this.h.a.style.cssText=e,e=S(e=new P("serif",m(this.a))),this.j.a.style.cssText=e,e=S(e=new P("sans-serif",m(this.a))),this.m.a.style.cssText=e,g(this.g),g(this.h),g(this.j),g(this.m)}o.prototype.c=function(e){for(var t=[],i=0;i<arguments.length;i++)t.push(arguments[i].replace(/[\W_]+/g,"").toLowerCase());return t.join(this.a)},T.prototype.start=function(){var s=this.c.o.document,a=this,o=r(),e=new Promise(function(i,n){!function t(){var e;r()-o>=a.f?n():s.fonts.load(u(e=a.a)+" "+e.f+"00 300px "+d(e.c),a.h).then(function(e){1<=e.length?i():setTimeout(t,25)},function(){n()})}()}),i=null,t=new Promise(function(e,t){i=setTimeout(t,a.f)});Promise.race([t,e]).then(function(){i&&(clearTimeout(i),i=null),a.g(a.a)},function(){a.j(a.a)})};var w={D:"serif",C:"sans-serif"},t=null;function E(){var e;return null===t&&(e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),t=!!e&&(parseInt(e[1],10)<536||536===parseInt(e[1],10)&&parseInt(e[2],10)<=11)),t}function B(e,t,i){for(var n in w)if(w.hasOwnProperty(n)&&t===e.f[w[n]]&&i===e.f[w[n]])return!0;return!1}function N(e){var t=e.g.a.offsetWidth,i=e.h.a.offsetWidth;t===e.f.serif&&i===e.f["sans-serif"]||E()&&B(e,t,i)?r()-e.A>=e.w?E()&&B(e,t,i)&&(null===e.u||e.u.hasOwnProperty(e.a.c))?k(e,e.v):k(e,e.B):setTimeout(p(function(){N(this)},e),50):k(e,e.v)}function k(e,t){setTimeout(p(function(){i(this.g.a),i(this.h.a),i(this.j.a),i(this.m.a),t(this.a)},e),0)}function x(e,t,i){this.c=e,this.a=t,this.f=0,this.m=this.j=!1,this.s=i}v.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.m.a.offsetWidth,this.A=r(),N(this)};var R=null;function L(e){0==--e.f&&e.j&&(e.m?((e=e.a).g&&f(e.f,[e.a.c("wf","active")],[e.a.c("wf","loading"),e.a.c("wf","inactive")]),y(e,"active")):_(e.a))}function z(e){this.j=e,this.a=new D,this.h=0,this.f=this.g=!0}function W(e,t){this.c=e,this.a=t}function q(e,t){this.c=e,this.a=t}function V(e,t){this.c=e||"https://fonts.googleapis.com/css",this.a=[],this.f=[],this.g=t||""}x.prototype.g=function(e){var t=this.a;t.g&&f(t.f,[t.a.c("wf",e.c,m(e).toString(),"active")],[t.a.c("wf",e.c,m(e).toString(),"loading"),t.a.c("wf",e.c,m(e).toString(),"inactive")]),y(t,"fontactive",e),this.m=!0,L(this)},x.prototype.h=function(e){var t,i,n,s=this.a;s.g&&(t=a(s.f,s.a.c("wf",e.c,m(e).toString(),"active")),i=[],n=[s.a.c("wf",e.c,m(e).toString(),"loading")],t||i.push(s.a.c("wf",e.c,m(e).toString(),"inactive")),f(s.f,i,n)),y(s,"fontinactive",e),L(this)},z.prototype.load=function(e){this.c=new F(this.j,e.context||this.j),this.g=!1!==e.events,this.f=!1!==e.classes;var n=this,t=new M(this.c,e),i=e,s=[],e=i.timeout,s=(function(e){e.g&&f(e.f,[e.a.c("wf","loading")]),y(e,"loading")}(t),function(e,t,i){var n,s,a=[];for(n in t)t.hasOwnProperty(n)&&(s=e.c[n])&&a.push(s(t[n],i));return a}(n.a,i,n.c)),a=new x(n.c,t,e);for(n.h=s.length,t=0,i=s.length;t<i;t++)s[t].load(function(e,t,i){var l,d,u,c,g;l=a,d=e,u=t,c=i,g=0==--(e=n).h,(e.f||e.g)&&setTimeout(function(){var e=c||null,t=u||{};if(0===d.length&&g)_(l.a);else{l.f+=d.length,g&&(l.j=g);for(var i=[],n=0;n<d.length;n++){var s,a=d[n],o=t[a.c],r=l.a,h=a;r.g&&f(r.f,[r.a.c("wf",h.c,m(h).toString(),"loading")]),y(r,"fontloading",h),r=(R=(r=null)===R?!!window.FontFace&&(h=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent),s=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor),h?42<parseInt(h[1],10):!s):R)?new T(p(l.g,l),p(l.h,l),l.c,a,l.s,o):new v(p(l.g,l),p(l.h,l),l.c,a,l.s,e,o),i.push(r)}for(n=0;n<i.length;n++)i[n].start()}},0)})},W.prototype.load=function(o){var r,t=this,h=t.a.projectId,e=t.a.version;h?(r=t.c.o,n(this.c,(t.a.api||"https://fast.fonts.net/jsapi")+"/"+h+".js"+(e?"?v="+e:""),function(e){e?o([]):(r["__MonotypeConfiguration__"+h]=function(){return t.a},function e(){if(r["__mti_fntLst"+h]){var t,i=r["__mti_fntLst"+h](),n=[];if(i)for(var s=0;s<i.length;s++){var a=i[s].fontfamily;null!=i[s].fontStyle&&null!=i[s].fontWeight?(t=i[s].fontStyle+i[s].fontWeight,n.push(new P(a,t))):n.push(new P(a))}o(n)}else setTimeout(function(){e()},50)}())}).id="__MonotypeAPIScript__"+h):o([])},q.prototype.load=function(e){for(var t=this.a.urls||[],i=this.a.families||[],n=this.a.testStrings||{},s=new I,a=0,o=t.length;a<o;a++)b(this.c,t[a],C(s));var r=[];for(a=0,o=i.length;a<o;a++)if((t=i[a].split(":"))[1])for(var h=t[1].split(","),l=0;l<h.length;l+=1)r.push(new P(t[0],h[l]));else r.push(new P(t[0]));A(s,function(){e(r,n)})};function j(e){this.f=e,this.a=[],this.c={}}var K={latin:"BESbswy","latin-ext":"çöüğş",cyrillic:"йяЖ",greek:"αβΣ",khmer:"កខគ",Hanuman:"កខគ"},X={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},Z={i:"i",italic:"i",n:"n",normal:"n"},Y=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;function J(e,t){this.c=e,this.a=t}var Q={Arimo:!0,Cousine:!0,Tinos:!0};function $(e,t){this.c=e,this.a=t}function ee(e,t){this.c=e,this.f=t,this.a=[]}J.prototype.load=function(e){for(var t=new I,i=this.c,n=new V(this.a.api,this.a.text),s=this.a.families,a=n,o=s,r=o.length,h=0;h<r;h++){var l=o[h].split(":"),d=(3==l.length&&a.f.push(l.pop()),"");2==l.length&&""!=l[1]&&(d=":"),a.a.push(l.join(d))}for(var u=new j(s),c=u,g=c.f.length,p=0;p<g;p++){var f=c.f[p].split(":"),m=f[0].replace(/\+/g," "),_=["n4"];if(2<=f.length){var y,S,T=f[1],v=[];if(T)for(var w=(T=T.split(",")).length,E=0;E<w;E++)(S=!(S=T[E]).match(/^[\w-]+$/)||null==(y=Y.exec(S.toLowerCase()))?"":[S=null==(S=y[2])||""==S?"n":Z[S],y=null==(y=y[1])||""==y?"4":X[y]||(isNaN(y)?"4":y.substr(0,1))].join(""))&&v.push(S);0<v.length&&(_=v),3==f.length&&(v=[],0<(f=(f=f[2])?f.split(","):v).length)&&(f=K[f[0]])&&(c.c[m]=f)}for(c.c[m]||(f=K[m])&&(c.c[m]=f),f=0;f<_.length;f+=1)c.a.push(new P(m,_[f]))}b(i,function(e){if(0==e.a.length)throw Error("No fonts to load!");if(-1!=e.c.indexOf("kit="))return e.c;for(var t=e.a.length,i=[],n=0;n<t;n++)i.push(e.a[n].replace(/ /g,"+"));return t=e.c+"?family="+i.join("%7C"),0<e.f.length&&(t+="&subset="+e.f.join(",")),0<e.g.length&&(t+="&text="+encodeURIComponent(e.g)),t}(n),C(t)),A(t,function(){e(u.a,u.c,Q)})},$.prototype.load=function(o){var e=this.a.id,r=this.c.o;e?n(this.c,(this.a.api||"https://use.typekit.net")+"/"+e+".js",function(e){if(e)o([]);else if(r.Typekit&&r.Typekit.config&&r.Typekit.config.fn){e=r.Typekit.config.fn;for(var t=[],i=0;i<e.length;i+=2)for(var n=e[i],s=e[i+1],a=0;a<s.length;a++)t.push(new P(n,s[a]));try{r.Typekit.load({events:!1,classes:!1,async:!0})}catch(e){}o(t)}},2e3):o([])},ee.prototype.load=function(h){var e=this.f.id,t=this.c.o,l=this;e?(t.__webfontfontdeckmodule__||(t.__webfontfontdeckmodule__={}),t.__webfontfontdeckmodule__[e]=function(e,t){for(var i,n,s,a=0,o=t.fonts.length;a<o;++a){var r=t.fonts[a];l.a.push(new P(r.name,(r="font-weight:"+r.weight+";font-style:"+r.style,s=n=i=void 0,i=4,n="n",s=null,r&&((s=r.match(/(normal|oblique|italic)/i))&&s[1]&&(n=s[1].substr(0,1).toLowerCase()),s=r.match(/([1-9]00|normal|bold)/i))&&s[1]&&(/bold/i.test(s[1])?i=7:/[1-9]00/.test(s[1])&&(i=parseInt(s[1].substr(0,1),10))),n+i)))}h(l.a)},n(this.c,(this.f.api||"https://f.fontdeck.com/s/css/js/")+((t=this.c).o.location.hostname||t.a.location.hostname)+"/"+e+".js",function(e){e&&h([])})):h([])};var e=new z(window),O=(e.a.c.custom=function(e,t){return new q(t,e)},e.a.c.fontdeck=function(e,t){return new ee(t,e)},e.a.c.monotype=function(e,t){return new W(t,e)},e.a.c.typekit=function(e,t){return new $(t,e)},e.a.c.google=function(e,t){return new J(t,e)},{load:p(e.load,e)});"function"==typeof define&&define.amd?define(function(){return O}):"undefined"!=typeof module&&module.exports?module.exports=O:(window.WebFont=O,window.WebFontConfig&&e.load(window.WebFontConfig))}(),!function(n){Object.defineProperty(t.prototype,"length",{get:function(){var e=Object.keys(localStorage);return n.Storage.nameSpaceKeyFilter(e,this.namespace).length},enumerable:!0,configurable:!0}),t.prototype.getItem=function(e){return localStorage.getItem(this.namespace+e)},t.prototype.setItem=function(e,t){localStorage.setItem(this.namespace+e,t)},t.prototype.deleteItem=function(e){localStorage.removeItem(this.namespace+e)},t.prototype.empty=function(){for(var e=Object.keys(localStorage),t=n.Storage.nameSpaceKeyFilter(e,this.namespace),i=0;i<t.length;i++)localStorage.removeItem(t[i])},t.prototype.setNamespace=function(e){e&&(this.namespace=e+":")};var e=t;function t(e){this.namespace="",this.setNamespace(e)}n.LocalStorage=e}(Quartz=Quartz||{}),!function(t){function e(){this.store=null;try{"object"==typeof localStorage?(localStorage.setItem("testingLocalStorage","foo"),localStorage.removeItem("testingLocalStorage"),this.store=new t.LocalStorage("Quartz")):this.store=new t.CookieStorage("Quartz")}catch(e){this.store=new t.CookieStorage("Quartz")}return this}e.getInstance=function(){return null===t.Storage.instance&&(t.Storage.instance=new t.Storage),t.Storage.instance},e.nameSpaceKeyFilter=function(e,t){return e.filter(function(e){return e.substring(0,t.length)===t})},e.prototype.setNamespace=function(e){if(null===this.store)throw new Error("No storage available, unable to set namespace: "+e);return this.store.setNamespace(e),this},e.prototype.get=function(e){if(null===this.store)throw new Error("No storage available, unable to get key: "+e);return this.store.getItem(e)},e.prototype.set=function(e,t){if(null===this.store)throw new Error("No storage available, unable to set key: "+e);return this.store.setItem(e,t),this},e.instance=null,t.Storage=e}(Quartz=Quartz||{}),!function(e){function t(e){this.keys=[],this.namespace="",this.setNamespace(e)}Object.defineProperty(t.prototype,"length",{get:function(){return null!==this.getNameSpaceMatches()?this.getNameSpaceMatches().length:0},enumerable:!0,configurable:!0}),t.prototype.getItem=function(e){return this.getCookiesForNameSpace()[e]||null},t.prototype.setItem=function(e,t){document.cookie=encodeURIComponent(this.namespace+e)+"="+encodeURIComponent(t)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/"},t.prototype.deleteItem=function(e){document.cookie=encodeURIComponent(this.namespace+e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/"},t.prototype.setNamespace=function(e){e&&(this.namespace=e+":",this.reg=new RegExp("^"+this.namespace+"[a-zA-Z0-9]*","g"))},t.prototype.empty=function(){for(var e in this.getCookiesForNameSpace())this.deleteItem(e)},t.prototype.getNameSpaceMatches=function(){var t=this,e=decodeURIComponent(document.cookie).split("; ");return console.log(e),e.filter(function(e){return null!==e.match(t.reg)&&0<e.match(t.reg).length})},t.prototype.getCookiesForNameSpace=function(){var t=this,i={};return this.getNameSpaceMatches().forEach(function(e){e=e.replace(t.namespace,"").split("=");i[e[0]]=e[1]}),i},e.CookieStorage=t}(Quartz=Quartz||{}),this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),__extends=(!function(l){d=Phaser.BitmapText,__extends(t,d),t.prototype.setPinned=function(e,t,i){void 0!==t&&void 0!==i&&(this.base=new Phaser.Point(t,i)),this.pinned=e,this.onResize()},t.prototype.onResize=function(){var e,t;null!==this.game&&(e=null,this.game.width>this.game.height&&null!==this.landscapeScalingConfig?e=this.landscapeScalingConfig:null!==this.portraitScalingConfig&&(e=this.portraitScalingConfig),null!==e&&(this.game.scale.scaleObjectDynamicly(this,e.percentage,e.percentageOfWidth,e.scaleAnyway),t=this.scale,this.base=new Phaser.Point(e.x*t.x,e.y*t.y),this.pinned=e.pinnedPosition),t=this.game.getPinnedBase(this.pinned),this.x=this.base.x+t.x,this.y=this.base.y+t.y)},t.prototype.destroy=function(e){d.prototype.destroy.call(this,e),this.base=null,this.pinned=null,this.landscapeScalingConfig=null,this.portraitScalingConfig=null},t.prototype.setPortraitScaling=function(e,t,i,n,s,a){void 0===t&&(t=!0),void 0===i&&(i=!1),s=s||0,a=a||0,this.portraitScalingConfig=n?new l.ScalingConfig(e,t,i,n,s,a):new l.ScalingConfig(e,t,i),this.onResize()},t.prototype.setLandscapeScaling=function(e,t,i,n,s,a){void 0===t&&(t=!0),void 0===i&&(i=!1),s=s||0,a=a||0,this.landscapeScalingConfig=n?new l.ScalingConfig(e,t,i,n,s,a):new l.ScalingConfig(e,t,i),this.onResize()};var d,e=t;function t(e,t,i,n,s,a,o,r){var h=this;void 0===r&&(r=l.PinnedPosition.topLeft),d.call(this,e,t,i,n,s,a,o),this.portraitScalingConfig=null,this.landscapeScalingConfig=null,this.game.scale.onSizeChange.add(function(){return h.onResize()},null),this.base=new Phaser.Point(t||0,i||0),this.setPinned(r)}l.ResponsiveBitmapText=e}(Fabrique=Fabrique||{}),!function(c){g=Phaser.Button,__extends(t,g),t.prototype.setPinned=function(e,t,i){void 0!==t&&void 0!==i&&(this.base=new Phaser.Point(t,i)),this.pinned=e,this.onResize()},t.prototype.onResize=function(){var e,t;null!==this.game&&(e=null,this.game.width>this.game.height&&null!==this.landscapeScalingConfig?e=this.landscapeScalingConfig:null!==this.portraitScalingConfig&&(e=this.portraitScalingConfig),null!==e&&(this.game.scale.scaleObjectDynamicly(this,e.percentage,e.percentageOfWidth,e.scaleAnyway),t=this.scale,this.base=new Phaser.Point(e.x*t.x,e.y*t.y),void 0!==e.pinnedPosition)&&(this.pinned=e.pinnedPosition),t=this.game.getPinnedBase(this.pinned),this.x=this.base.x+t.x,this.y=this.base.y+t.y)},t.prototype.destroy=function(e){g.prototype.destroy.call(this,e),this.base=null,this.pinned=null,this.landscapeScalingConfig=null,this.portraitScalingConfig=null},t.prototype.setPortraitScaling=function(e,t,i,n,s,a){void 0===t&&(t=!0),void 0===i&&(i=!1),s=s||0,a=a||0,this.portraitScalingConfig=void 0!==n?new c.ScalingConfig(e,t,i,n,s,a):new c.ScalingConfig(e,t,i),this.onResize()},t.prototype.setLandscapeScaling=function(e,t,i,n,s,a){void 0===t&&(t=!0),void 0===i&&(i=!1),s=s||0,a=a||0,this.landscapeScalingConfig=void 0!==n?new c.ScalingConfig(e,t,i,n,s,a):new c.ScalingConfig(e,t,i),this.onResize()};var g,e=t;function t(e,t,i,n,s,a,o,r,h,l,d){var u=this;void 0===d&&(d=c.PinnedPosition.topLeft),g.call(this,e,t,i,n,s,a,o,r,h,l),this.portraitScalingConfig=null,this.landscapeScalingConfig=null,this.game.scale.onSizeChange.add(function(){return u.onResize()},this),this.base=new Phaser.Point(t||0,i||0),this.setPinned(d)}c.ResponsiveButton=e}(Fabrique=Fabrique||{}),!function(d){u=Phaser.Group,__extends(t,u),t.prototype.setPinned=function(e,t,i){void 0!==t&&void 0!==i&&(this.base=new Phaser.Point(t,i)),this.pinned=e,this.onResize()},t.prototype.onResize=function(){var e,t;null!==this.game&&(e=null,this.game.width>this.game.height&&null!==this.landscapeScalingConfig?e=this.landscapeScalingConfig:null!==this.portraitScalingConfig&&(e=this.portraitScalingConfig),null!==e&&(this.game.scale.scaleObjectDynamicly(this,e.percentage,e.percentageOfWidth,e.scaleAnyway),t=this.scale,this.base=new Phaser.Point(e.x*t.x,e.y*t.y),void 0!==e.pinnedPosition)&&(this.pinned=e.pinnedPosition),t=this.game.getPinnedBase(this.pinned),this.x=this.base.x+t.x,this.y=this.base.y+t.y)},t.prototype.destroy=function(e){u.prototype.destroy.call(this,e),this.base=null,this.pinned=null,this.landscapeScalingConfig=null,this.portraitScalingConfig=null},t.prototype.setPortraitScaling=function(e,t,i,n,s,a){void 0===t&&(t=!0),void 0===i&&(i=!1),s=s||0,a=a||0,this.portraitScalingConfig=void 0!==n?new d.ScalingConfig(e,t,i,n,s,a):new d.ScalingConfig(e,t,i),this.onResize()},t.prototype.setLandscapeScaling=function(e,t,i,n,s,a){void 0===t&&(t=!0),void 0===i&&(i=!1),s=s||0,a=a||0,this.landscapeScalingConfig=void 0!==n?new d.ScalingConfig(e,t,i,n,s,a):new d.ScalingConfig(e,t,i),this.onResize()};var u,e=t;function t(e,t,i,n,s,a,o,r,h){var l=this;void 0===h&&(h=d.PinnedPosition.topLeft),u.call(this,e,t,i,n,s,a),this.portraitScalingConfig=null,this.landscapeScalingConfig=null,this.game.scale.onSizeChange.add(function(){return l.onResize()},null),this.base=new Phaser.Point(o||0,r||0),this.setPinned(h)}d.ResponsiveGroup=e}(Fabrique=Fabrique||{}),!function(r){h=Phaser.Image,__extends(t,h),t.prototype.setPinned=function(e,t,i){void 0!==t&&void 0!==i&&(this.base=new Phaser.Point(t,i)),this.pinned=e,this.onResize()},t.prototype.onResize=function(){var e,t;null!==this.game&&(e=null,this.game.width>this.game.height&&null!==this.landscapeScalingConfig?e=this.landscapeScalingConfig:null!==this.portraitScalingConfig&&(e=this.portraitScalingConfig),null!==e&&(this.game.scale.scaleObjectDynamicly(this,e.percentage,e.percentageOfWidth,e.scaleAnyway),t=this.scale,this.base=new Phaser.Point(e.x*t.x,e.y*t.y),void 0!==e.pinnedPosition)&&(this.pinned=e.pinnedPosition),t=this.game.getPinnedBase(this.pinned),this.x=this.base.x+t.x,this.y=this.base.y+t.y)},t.prototype.destroy=function(e){h.prototype.destroy.call(this,e),this.base=null,this.pinned=null,this.landscapeScalingConfig=null,this.portraitScalingConfig=null},t.prototype.setPortraitScaling=function(e,t,i,n,s,a){void 0===t&&(t=!0),void 0===i&&(i=!1),s=s||0,a=a||0,this.portraitScalingConfig=void 0!==n?new r.ScalingConfig(e,t,i,n,s,a):new r.ScalingConfig(e,t,i),this.onResize()},t.prototype.setLandscapeScaling=function(e,t,i,n,s,a){void 0===t&&(t=!0),void 0===i&&(i=!1),s=s||0,a=a||0,this.landscapeScalingConfig=void 0!==n?new r.ScalingConfig(e,t,i,n,s,a):new r.ScalingConfig(e,t,i),this.onResize()};var h,e=t;function t(e,t,i,n,s,a){var o=this;void 0===a&&(a=r.PinnedPosition.topLeft),h.call(this,e,t,i,n,s),this.portraitScalingConfig=null,this.landscapeScalingConfig=null,this.game.scale.onSizeChange.add(function(){return o.onResize()},null),this.base=new Phaser.Point(t||0,i||0),this.setPinned(a)}r.ResponsiveImage=e}(Fabrique=Fabrique||{}),!function(r){h=Phaser.Sprite,__extends(t,h),t.prototype.setPinned=function(e,t,i){void 0!==t&&void 0!==i&&(this.base=new Phaser.Point(t,i)),this.pinned=e,this.onResize()},t.prototype.onResize=function(){var e,t;null!==this.game&&(e=null,this.game.width>this.game.height&&null!==this.landscapeScalingConfig?e=this.landscapeScalingConfig:null!==this.portraitScalingConfig&&(e=this.portraitScalingConfig),null!==e&&(this.game.scale.scaleObjectDynamicly(this,e.percentage,e.percentageOfWidth,e.scaleAnyway),t=this.scale,this.base=new Phaser.Point(e.x*t.x,e.y*t.y),void 0!==e.pinnedPosition)&&(this.pinned=e.pinnedPosition),t=this.game.getPinnedBase(this.pinned),this.x=this.base.x+t.x,this.y=this.base.y+t.y)},t.prototype.destroy=function(e){h.prototype.destroy.call(this,e),this.base=null,this.pinned=null,this.landscapeScalingConfig=null,this.portraitScalingConfig=null},t.prototype.setPortraitScaling=function(e,t,i,n,s,a){void 0===t&&(t=!0),void 0===i&&(i=!1),s=s||0,a=a||0,this.portraitScalingConfig=void 0!==n?new r.ScalingConfig(e,t,i,n,s,a):new r.ScalingConfig(e,t,i),this.onResize()},t.prototype.setLandscapeScaling=function(e,t,i,n,s,a){void 0===t&&(t=!0),void 0===i&&(i=!1),s=s||0,a=a||0,this.landscapeScalingConfig=void 0!==n?new r.ScalingConfig(e,t,i,n,s,a):new r.ScalingConfig(e,t,i),this.onResize()};var h,e=t;function t(e,t,i,n,s,a){var o=this;void 0===a&&(a=r.PinnedPosition.topLeft),h.call(this,e,t,i,n,s),this.portraitScalingConfig=null,this.landscapeScalingConfig=null,this.game.scale.onSizeChange.add(function(){return o.onResize()},null),this.base=new Phaser.Point(t||0,i||0),this.setPinned(a)}r.ResponsiveSprite=e}(Fabrique=Fabrique||{}),!function(r){h=Phaser.Text,__extends(t,h),t.prototype.setPinned=function(e,t,i){void 0!==t&&void 0!==i&&(this.base=new Phaser.Point(t,i)),this.pinned=e,this.onResize()},t.prototype.onResize=function(){var e,t;null!==this.game&&(e=null,this.game.width>this.game.height&&null!==this.landscapeScalingConfig?e=this.landscapeScalingConfig:null!==this.portraitScalingConfig&&(e=this.portraitScalingConfig),null!==e&&(this.game.scale.scaleObjectDynamicly(this,e.percentage,e.percentageOfWidth,e.scaleAnyway),t=this.scale,this.base=new Phaser.Point(e.x*t.x,e.y*t.y),void 0!==e.pinnedPosition)&&(this.pinned=e.pinnedPosition),t=this.game.getPinnedBase(this.pinned),this.x=this.base.x+t.x,this.y=this.base.y+t.y)},t.prototype.destroy=function(e){h.prototype.destroy.call(this,e),this.base=null,this.pinned=null,this.landscapeScalingConfig=null,this.portraitScalingConfig=null},t.prototype.setPortraitScaling=function(e,t,i,n,s,a){void 0===t&&(t=!0),void 0===i&&(i=!1),s=s||0,a=a||0,this.portraitScalingConfig=void 0!==n?new r.ScalingConfig(e,t,i,n,s,a):new r.ScalingConfig(e,t,i),this.onResize()},t.prototype.setLandscapeScaling=function(e,t,i,n,s,a){void 0===t&&(t=!0),void 0===i&&(i=!1),s=s||0,a=a||0,this.landscapeScalingConfig=void 0!==n?new r.ScalingConfig(e,t,i,n,s,a):new r.ScalingConfig(e,t,i),this.onResize()};var h,e=t;function t(e,t,i,n,s,a){var o=this;void 0===a&&(a=r.PinnedPosition.topLeft),h.call(this,e,t,i,n,s),this.portraitScalingConfig=null,this.landscapeScalingConfig=null,this.game.scale.onSizeChange.add(function(){return o.onResize()},null),this.base=new Phaser.Point(t||0,i||0),this.setPinned(a)}r.ResponsiveText=e}(Fabrique=Fabrique||{}),!function(e){var t;(t=e.PinnedPosition||(e.PinnedPosition={}))[t.topLeft=0]="topLeft",t[t.topCenter=1]="topCenter",t[t.topRight=2]="topRight",t[t.middleLeft=3]="middleLeft",t[t.middleCenter=4]="middleCenter",t[t.middleRight=5]="middleRight",t[t.bottomLeft=6]="bottomLeft",t[t.bottomCenter=7]="bottomCenter",t[t.bottomRight=8]="bottomRight",e.PinnedPosition}(Fabrique=Fabrique||{}),!function(u){var e,n;function t(e,t){var i=this;n.call(this,e,t),e.hasOwnProperty("getPinnedBase")||Object.defineProperty(e,"getPinnedBase",{value:function(e){switch(e){case u.PinnedPosition.topLeft:return new Phaser.Point(0,0);case u.PinnedPosition.topCenter:return new Phaser.Point(i.game.width/2,0);case u.PinnedPosition.topRight:return new Phaser.Point(i.game.width,0);case u.PinnedPosition.middleLeft:return new Phaser.Point(0,i.game.height/2);case u.PinnedPosition.middleCenter:return new Phaser.Point(i.game.width/2,i.game.height/2);case u.PinnedPosition.middleRight:return new Phaser.Point(i.game.width,i.game.height/2);case u.PinnedPosition.bottomLeft:return new Phaser.Point(0,i.game.height);case u.PinnedPosition.bottomCenter:return new Phaser.Point(i.game.width/2,i.game.height);case u.PinnedPosition.bottomRight:return new Phaser.Point(i.game.width,i.game.height)}}}),this.addResponsiveFactory(),this.addResponsiveCreator(),this.addResponsiveScaleManager()}e=u.Plugins||(u.Plugins={}),n=Phaser.Plugin,__extends(t,n),t.prototype.addResponsiveScaleManager=function(){Phaser.ScaleManager.prototype.scaleObjectDynamicly=function(e,t,i,n){var s,a,o;void 0===i&&(i=!0),void 0===n&&(n=!1),this.game.device.desktop&&!n||(e.scale.set(1,1),i?(s=this.game.width*t/100,e.width,o=s/e.width,(a=e.height*o)>this.game.height&&(o=(this.game.height-10)/e.height)):(a=this.game.height*t/100,e.height,o=a/e.height,(s=e.width*o)>this.game.width&&(o=(this.game.width-10)/e.width)),e.scale.set(o,o))}},t.prototype.addResponsiveFactory=function(){Phaser.GameObjectFactory.prototype.responsiveImage=function(e,t,i,n,s,a){return(a=void 0===a?this.world:a).add(new u.ResponsiveImage(this.game,e,t,i,n,s))},Phaser.GameObjectFactory.prototype.responsiveButton=function(e,t,i,n,s,a,o,r,h,l,d){return(d=void 0===d?this.world:d).add(new u.ResponsiveButton(this.game,e,t,i,n,s,a,o,r,h,l))},Phaser.GameObjectFactory.prototype.responsiveSprite=function(e,t,i,n,s,a){return(a=void 0===a?this.world:a).add(new u.ResponsiveSprite(this.game,e,t,i,n,s))},Phaser.GameObjectFactory.prototype.responsiveText=function(e,t,i,n,s,a){return(a=void 0===a?this.world:a).add(new u.ResponsiveText(this.game,e,t,i,n,s))},Phaser.GameObjectFactory.prototype.responsiveBitmapText=function(e,t,i,n,s,a,o,r){return(r=void 0===r?this.world:r).add(new u.ResponsiveBitmapText(this.game,e,t,i,n,s,a,o))},Phaser.GameObjectFactory.prototype.responsiveGroup=function(e,t,i,n,s,a,o,r){return new u.ResponsiveGroup(this.game,e,t,i,n,s,a,o,r)}},t.prototype.addResponsiveCreator=function(){Phaser.GameObjectCreator.prototype.responsiveImage=function(e,t,i,n,s){return new u.ResponsiveImage(this.game,e,t,i,n,s)},Phaser.GameObjectCreator.prototype.responsiveButton=function(e,t,i,n,s,a,o,r,h,l,d){return new u.ResponsiveButton(this.game,e,t,i,n,s,a,o,r,h,l)},Phaser.GameObjectCreator.prototype.responsiveSprite=function(e,t,i,n,s){return new u.ResponsiveSprite(this.game,e,t,i,n,s)},Phaser.GameObjectCreator.prototype.responsiveText=function(e,t,i,n,s){return new u.ResponsiveText(this.game,e,t,i,n,s)},Phaser.GameObjectCreator.prototype.responsiveBitmapText=function(e,t,i,n,s,a,o){return new u.ResponsiveBitmapText(this.game,e,t,i,n,s,a,o)},Phaser.GameObjectCreator.prototype.responsiveGroup=function(e,t,i,n,s,a,o,r){return new u.ResponsiveGroup(this.game,e,t,i,n,s,a,o,r)}},e.Responsiveness=t}(Fabrique=Fabrique||{}),(Fabrique||(Fabrique={})).ScalingConfig=function(e,t,i,n,s,a){void 0===t&&(t=!0),void 0===i&&(i=!1),this.pinnedPosition=void 0,this.x=0,this.y=0,this.percentage=e,this.percentageOfWidth=t,this.scaleAnyway=i,void 0!==n&&(this.pinnedPosition=n),s&&(this.x=s),a&&(this.y=a)},this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])}))(e,t)};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}()),Tile=(!function(i){t=Phaser.Game,__extends(n,t),n.prototype.statePreloader=function(){},n.prototype.stateCreator=function(){function e(){t.recursiveUpdateText(t.stage)}var t=this;this.plugins.add(PhaserSuperStorage.StoragePlugin),this.plugins.add(PhaserSpine.SpinePlugin),this.plugins.add(Fabrique.Plugins.Responsiveness),this.plugins.add(PhaserCachebuster.CacheBuster),this.plugins.add(PhaserInput.Plugin),this.state.add(Fabrique.Boot.Name,Fabrique.Boot,!1),this.state.add(i.Menu.Name,i.Menu,!1),this.state.add(i.Gameplay.Name,i.Gameplay,!1),this.storage.forcePromises=!0;WebFont.load({custom:{families:["Balsamiq Sans Bold"],urls:["assets/css/BalsamiqSans-Bold.css"]},active:e,inactive:e}),this.state.start(Fabrique.Boot.Name),this.state.remove("game")},n.prototype.recursiveUpdateText=function(e){var t=this;e instanceof Phaser.Text&&(e.dirty=!0),e.children&&0<e.children.length&&e.children.forEach(function(e){t.recursiveUpdateText(e)})};var t,e=n;function n(){var e=t.call(this,{enableDebug:!1,width:Fabrique.ScaleManager.GameWidth,height:Fabrique.ScaleManager.GameHeight,renderer:Phaser.AUTO,parent:"content",transparent:!0,antialias:!0,preserveDrawingBuffer:!1,physicsConfig:null,seed:"",state:null,forceSetTimeOut:!1})||this;return e.clearBeforeRender=!1,window.hasOwnProperty("fbrqSA")&&!0===window.fbrqSA&&(h5branding.Utils.ASSET_LOCATION="assets/"),Fabrique.LocalizationHandler.getInstance(e).initBrowserDetect(),e.state.add("game",{create:e.stateCreator.bind(e),preload:e.statePreloader.bind(e)},!0),AzerionIntegration.AdEventTracker.register(),h5branding.SplashLoader.getInstance({gameId:Constants.GD_GAME_ID,gameName:Constants.GAME_TITLE,gameTitle:Constants.GAME_TITLE,libs:[],version:"1.0"}).create().catch(function(e){console.log(e)}),e}i.Game=e}(ButterflyKyodai=ButterflyKyodai||{}),!function(e){function i(){}i.init=function(e){i.game=e,i.isInited=!0},i.addSound=function(e,t,i){this.sounds[e]={sound:this.game.add.audio(e,t=void 0===t?1:t,i=void 0===i?!1:i),volume:t,loop:i}},i.playSound=function(e){this.sounds[e]&&this.sounds[e].sound.play()},i.playRandomSound=function(e){var t=Math.floor(Math.random()*e.length);i.playSound(e[t])},i.stopSound=function(e){this.sounds[e]&&this.sounds[e].sound.stop()},i.isPlaying=function(e){return this.sounds[e].sound.isPlaying},i.sounds={},e.AudioManager=i}(ButterflyKyodai=ButterflyKyodai||{}),!function(e){function t(){this.gameover=!1,this.score=0,this.success=!1}t.prototype.handleGameMove=function(e){},t.prototype.generateResponse=function(){return{score:this.score,gameover:this.gameover,success:this.success,config:{}}},e.BackendGame=t}(Fabrique=Fabrique||{}),function(e,t,i,n,s){this.hintImageNumber=0,this.id=e,this.suitId=t,this.x=i,this.y=n,this.selected=s}),PathNode=function(e,t,i,n,s){this.x=e,this.y=t,this.turns=i,this.direction=n,this.parent=s},SaveTile=function(e,t,i){this.i=e,this.j=t,this.tileType=i},LevelObject=function(e,t,i,n,s,a,o,r,h){this.level=e,this.tileTypes=t,this.tileDropDir=i,this.emptyTiles=s,this.repeatingTiles=a,this.totalTileCount=o,this.levelName=r,this.levelMap=h,this.bushCount=n},Backend=function(i){function T(e){var t=i.call(this)||this;return t.tilesLeft=140,t.tileTypes=10,t.tileDropDirection="none",t.selectedTile=null,t.tileRemoveArray=[],t.selectedTiles=[],t.score=0,t.orderArray=[1,2,3,4],t.levelConfig=[new LevelObject(1,16,"none",0,0,2,140,"Level_1",[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),new LevelObject(2,16,"none",0,0,2,140,"Level_2",[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2]),new LevelObject(3,16,"none",0,0,2,140,"Level_3",[2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2]),new LevelObject(4,16,"none",0,0,0,140,"Level_4",[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2]),new LevelObject(5,16,"none",0,0,0,140,"Level_5",[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2]),new LevelObject(6,16,"none",4,0,0,136,"Level_6",[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2]),new LevelObject(7,16,"none",8,0,0,132,"Level_7",[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,1,1,1,1,1,1,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2]),new LevelObject(8,16,"none",10,0,0,130,"Level_8",[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,1,1,1,1,1,1,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2]),new LevelObject(9,16,"none",12,0,0,128,"Level_9",[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,1,1,1,1,1,1,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2])],t.shuffled=!1,t.gameover=!1,t.complete=!1,t.timeOver=!1,t.isHintEnabled=!1,t.callback=e,t}return __extends(T,i),T.prototype.handleGameMove=function(e){switch(this.call=e.call,e.call){case"init":this.initGame();break;case"tileClicked":this.onTileClicked(e.tileX,e.tileY);break;case"showHint":this.hintTiles=[],e.isTutorial?this.showHint(!1):0<Constants.CURRENT_HINTS&&!this.isHintEnabled&&(Constants.CURRENT_HINTS--,this.showHint(!1));break;case"onMoveFinished":var t,i,n,s;this.showHint(!0)||(this.tilesLeft<=0?(console.log("move finished called, no tiles left"),this.score+=Math.round(e.timeLeft*T.POINTS_PER_SECCOND),this.finishLevel()):2==this.tilesLeft?(T.MAX_TURNS=3,this.showHint(!0),t=this.hintTiles[0],i=this.hintTiles[1],n=new PathNode(t.x,t.y,0,"",null),s=new PathNode(i.x,i.y,0,"",null),this.connectingPath=this.getPathBetweenTiles(n,s,!1),T.MAX_TURNS=2,0<this.connectingPath.length&&(this.connectingPath.push(n),this.call="connectTiles",this.score+=T.MATCH_SCORE,this.tileRemoveArray=[t,i],this.removeTiles(t,i),this.dropTiles())):0<Constants.CURRENT_RESETS?(this.shuffleBoard(),this.shuffled=!0,Constants.CURRENT_RESETS--):(this.gameover=!0,this.timeOver=!1));break;case"timeEnd":this.gameover=!0,this.timeOver=!0;break;case"makeShufle":0<Constants.CURRENT_RESETS&&(this.shuffleBoard(),this.shuffled=!0,Constants.CURRENT_RESETS--);break;case"makeShufleWithoutReset":this.shuffleBoard(),this.shuffled=!0,this.gameover=!1,this.timeOver=!1;break;case"diselect":this.selectedTile=null;break;case"checkTiles":this.showHint(!0)||this.tilesLeft<=0&&(Constants.isGameOver=!0)}var a=this.generateResponse();this.callback(a),this.shuffled=!1},T.prototype.initGame=function(){if(this.score=Constants.CURRENT_SCORE,console.log("starting level score: "+Constants.CURRENT_SCORE),1<ButterflyKyodai.Hlp.Load().current_wings)for(var e=0,t=this.levelConfig;e<t.length;e++)t[e].tileTypes+=7;var i=this.levelConfig[Constants.CURRENT_LEVEL-1];this.tileDropDirection=i.tileDropDir,this.tileTypes=i.tileTypes,this.tilesLeft=T.NUMBER_OF_TILES,this.createShuffledArray(),this.createGrid()},T.prototype.createGrid=function(){this.grid=[];for(var e=0;e<this.shuffledArray.length;e++){this.grid[e]=[];for(var t=0;t<this.shuffledArray[e].length;t++)this.shuffledArray[e][t]==T.EMPTY_TILE_ID?this.grid[e][t]={tile:null}:this.grid[e][t]={tile:new Tile(this.shuffledArray[e][t],this.shuffledArray[e][t],e,t,!1)}}},T.prototype.createTile=function(e,t,i){},T.prototype.dropTiles=function(){switch(this.tileDropDirection){case"none":break;case"north":case"east":case"south":case"west":case"center":this.moveAmountTiles(this.tileDropDirection,this.grid.length,this.grid[0].length);break;case"partVertical":this.moveAmountTiles("west",this.grid.length/2,this.grid[0].length),this.moveAmountTiles("east",this.grid.length/2,this.grid[0].length);break;case"partHorizontal":this.moveAmountTiles("north",this.grid.length,this.grid[0].length/2),this.moveAmountTiles("south",this.grid.length,this.grid[0].length/2)}},T.prototype.moveAmountTiles=function(e,t,i){var n,s,a,o,r,h,l=0;switch(e){case"north":for(s=this.grid.length,r=0;r<s;r++)for(a=i,h=l=0;h<a;h++)0!=r&&0!=h&&r!=this.grid.length-1&&h!=this.grid[r].length-1&&(null==this.grid[r][h].tile?l++:this.grid[r][h].tile.suitId==T.BUSH_TILE_ID?l=0:(n=this.grid[r][h].tile,0<l&&(n.x=r,n.y=h-l,this.grid[r][h].tile=null,this.grid[r][h-l].tile=n)));break;case"east":for(a=this.grid[0].length,h=0;h<a;h++)for(o=l=0,this.grid.length!=t&&(o=t),r=this.grid.length-1;o<=r;r--)0!=r&&0!=h&&r!=this.grid.length-1&&h!=this.grid[r].length-1&&(null==this.grid[r][h].tile?l++:this.grid[r][h].tile.suitId==T.BUSH_TILE_ID?l=0:(n=this.grid[r][h].tile,0<l&&(n.x=r+l,n.y=h,this.grid[r][h].tile=null,this.grid[r+l][h].tile=n)));break;case"south":for(s=this.grid.length,r=0;r<s;r++)for(this.grid[o=l=0].length!=i&&(o=i),h=this.grid[r].length-1;o<=h;h--)0!=r&&0!=h&&r!=this.grid.length-1&&h!=this.grid[r].length-1&&(null==this.grid[r][h].tile?l++:this.grid[r][h].tile.suitId==T.BUSH_TILE_ID?l=0:(n=this.grid[r][h].tile,0<l&&(n.x=r,n.y=h+l,this.grid[r][h].tile=null,this.grid[r][h+l].tile=n)));break;case"west":for(a=this.grid[0].length,h=0;h<a;h++)for(s=t,r=l=0;r<s;r++)0!=r&&0!=h&&r!=this.grid.length-1&&h!=this.grid[r].length-1&&(null==this.grid[r][h].tile?l++:this.grid[r][h].tile.suitId==T.BUSH_TILE_ID?l=0:(n=this.grid[r][h].tile,0<l&&(n.x=r-l,n.y=h,this.grid[r][h].tile=null,this.grid[r-l][h].tile=n)));break;case"center":for(var d=0;d<this.orderArray.length;d++)switch(this.orderArray[d]){case 1:for(s=this.grid.length,r=0;r<s;r++)for(h=(a=this.grid[l=0].length/2)-1;0<h;h--)0!=r&&0!=h&&r!=this.grid.length-1&&h!=this.grid[r].length-1&&(null==this.grid[r][h].tile?l++:this.grid[r][h].tile.suitId==T.BUSH_TILE_ID?l=0:(n=this.grid[r][h].tile,0<l&&(n.x=r,n.y=h+l,this.grid[r][h].tile=null,this.grid[r][h+l].tile=n)));break;case 2:for(a=this.grid[0].length,h=0;h<a;h++)for(l=0,r=this.grid.length/2;r<this.grid.length;r++)0!=r&&0!=h&&r!=this.grid.length-1&&h!=this.grid[r].length-1&&(null==this.grid[r][h].tile?l++:this.grid[r][h].tile.suitId==T.BUSH_TILE_ID?l=0:(n=this.grid[r][h].tile,0<l&&(n.x=r-l,n.y=h,this.grid[r][h].tile=null,this.grid[r-l][h].tile=n)));break;case 3:for(s=this.grid.length,r=0;r<s;r++)for(o=this.grid[l=0].length/2,h=this.grid[0].length/2;h<this.grid[r].length-1;h++)0!=r&&0!=h&&r!=this.grid.length-1&&h!=this.grid[r].length-1&&(null==this.grid[r][h].tile?l++:this.grid[r][h].tile.suitId==T.BUSH_TILE_ID?l=0:(n=this.grid[r][h].tile,0<l&&(n.x=r,n.y=h-l,this.grid[r][h].tile=null,this.grid[r][h-l].tile=n)));break;case 4:for(a=this.grid[0].length,h=0;h<a;h++)for(r=this.grid[l=0].length/2+1;0<r;r--)0!=r&&0!=h&&r!=this.grid.length-1&&h!=this.grid[r].length-1&&(null==this.grid[r][h].tile?l++:this.grid[r][h].tile.suitId==T.BUSH_TILE_ID?l=0:(n=this.grid[r][h].tile,0<l&&(n.x=r+l,n.y=h,this.grid[r][h].tile=null,this.grid[r+l][h].tile=n)))}this.orderArray.unshift(this.orderArray.splice(this.orderArray.length-1,1)[0])}},T.prototype.createShuffledArray=function(){var e,t=this.levelConfig[Constants.CURRENT_LEVEL-1],i=[],n=(T.NUMBER_OF_TILES-t.bushCount)/2,s=0,a=0,o=t.repeatingTiles;for(r=0;r<n;r++)r<t.emptyTiles/2?i.push(T.EMPTY_TILE_ID):(i.push(s),e=Math.random(),a<o&&.7<e&&r+2<n&&(i.push(s),r+=1,a++),++s>this.tileTypes&&(s=0));var r,h,l=T.NUMBER_OF_TILES/T.NUMBER_OF_ROWS+2,d=T.NUMBER_OF_ROWS+2,t=(this.shuffledArray=[],this.levelConfig[Constants.CURRENT_LEVEL-1]),u=this.getShuffledTileArray(t.tileTypes,t.totalTileCount),c=0;for(r=0;r<l;r++)for(this.shuffledArray[r]=[],h=0;h<d;h++)0==t.levelMap[16*h+r]?this.shuffledArray[r][h]=T.EMPTY_TILE_ID:2==t.levelMap[16*h+r]?this.shuffledArray[r][h]=T.BUSH_TILE_ID:(this.shuffledArray[r][h]=u[c],c++)},T.prototype.getRandomNumber=function(e,t){return e+Math.floor((t-e+1)*Math.random())},T.prototype.getShuffledPosArray=function(e){for(var t=[],i=0;i<e;)t[i]=i,i++;for(var n,s,a=0;a<e-1;)a!==(n=this.getRandomNumber(a,e-1))&&(s=t[a],t[a]=t[n],t[n]=s),a++;return t},T.prototype.getShuffledTileArray=function(e,t){for(var i=this.getShuffledPosArray(t),n=[],s=0;s<i.length;s++)n.push(0);for(var a,o=0;o<t;)a=this.getRandomNumber(1,e),n[i[o]]=a,n[i[t-1-o]]=a,o++;return n},T.prototype.findPotentialTiles=function(e){for(var t=[],i=0;i<this.shuffledArray.length;i++)for(var n=0;n<this.shuffledArray[i].length;n++)if(this.shuffledArray[i][n]==T.EMPTY_TILE_ID)for(var s=i-1;s<=i+1;s++)for(var a=n-1;a<=n+1;a++)if(!(s==i&&a==n||s==i-1&&a==n-1||s==i-1&&a==n+1||s==i+1&&a==n-1||s==i+1&&a==n+1)&&this.shuffledArray[s]&&0==this.shuffledArray[s][a]){for(var o=!1,r=0;r<t.length;r++)if(t[r][0]==s&&t[r][1]==a){o=!0;break}o||(t[t.length]=[],t[t.length-1][0]=s,t[t.length-1][1]=a)}return t},T.prototype.onTileClicked=function(e,t){var i=this.grid[e][t].tile;if(null!=this.selectedTile){if(null===i||this.selectedTile.x==e&&this.selectedTile.y==t)return;if(this.selectedTile.suitId==i.suitId){e=new PathNode(this.selectedTile.x,this.selectedTile.y,0,"",null),t=new PathNode(i.x,i.y,0,"",null);if(this.connectingPath=this.getPathBetweenTiles(e,t,!1),0<this.connectingPath.length)return this.connectingPath.push(e),this.call="connectTiles",this.score+=T.MATCH_SCORE,this.tileRemoveArray=[this.selectedTile,i],this.removeTiles(this.selectedTile,i),void this.dropTiles()}}this.call="selectTile",this.selectedTile=i},T.prototype.removeTiles=function(e,t){this.grid[e.x][e.y].tile=null,this.grid[t.x][t.y].tile=null,this.selectedTile=null},T.prototype.generateResponse=function(){var e="";return this.levelConfig.length>Constants.CURRENT_LEVEL-1&&(e=this.levelConfig[Constants.CURRENT_LEVEL-1].levelName),{success:this.success,gameover:this.gameover,complete:this.complete,timeOver:this.timeOver,score:this.score,tiles:this.grid,call:this.call,selectedTile:this.selectedTile,tileRemoveArray:this.tileRemoveArray,selectedTiles:this.selectedTiles,connectingPath:this.connectingPath,hintTiles:this.hintTiles,shuffled:this.shuffled,levelName:e}},T.prototype.getPathBetweenTiles=function(e,t,i){for(var n,s,a,o,r,h,l={},d=(l[e.x+"_"+e.y+"_"+e.direction]=e,{});0<Object.keys(l).length;)for(h in l){if(n=l[h],delete l[h],n.x==t.x&&n.y==t.y)return this.constructPath(n);for(d[n.x+"_"+n.y+"_"+n.direction]=n,a=this.getNeighbors(n,t,i),s=0;s<a.length;s++)o=a[s],d.hasOwnProperty(o.x+"_"+o.y+"_"+o.direction)||(!l.hasOwnProperty(o.x+"_"+o.y+"_"+o.direction)||(r=l[o.x+"_"+o.y+"_"+o.direction],o.turns<r.turns))&&(l[o.x+"_"+o.y+"_"+o.direction]=o)}return[]},T.prototype.getNeighbors=function(e,t,i){var n,s=[],a=0;return i?(0!=e.x&&(null==this.shuffledArray[e.x-1][e.y]||e.x-1==t.x&&e.y==t.y||this.shuffledArray[e.x-1][e.y]==T.EMPTY_TILE_ID)&&(n="west",a=e.turns,""!=e.direction&&e.direction!=n&&a++,a<=T.MAX_TURNS)&&s.push(new PathNode(e.x-1,e.y,a,n,e)),e.x+1<this.shuffledArray.length&&(null==this.shuffledArray[e.x+1][e.y]||e.x+1==t.x&&e.y==t.y||this.shuffledArray[e.x+1][e.y]==T.EMPTY_TILE_ID)&&(n="east",a=e.turns,""!=e.direction&&e.direction!=n&&a++,a<=T.MAX_TURNS)&&s.push(new PathNode(e.x+1,e.y,a,n,e)),0!=e.y&&(null==this.shuffledArray[e.x][e.y-1]||e.x==t.x&&e.y-1==t.y||this.shuffledArray[e.x][e.y-1]==T.EMPTY_TILE_ID)&&(n="north",a=e.turns,""!=e.direction&&e.direction!=n&&a++,a<=T.MAX_TURNS)&&s.push(new PathNode(e.x,e.y-1,a,n,e)),e.y+1<this.shuffledArray[e.x].length&&(null==this.shuffledArray[e.x][e.y+1]||e.x==t.x&&e.y+1==t.y||this.shuffledArray[e.x][e.y+1]==T.EMPTY_TILE_ID)&&(n="south",a=e.turns,""!=e.direction&&e.direction!=n&&a++,a<=T.MAX_TURNS)&&s.push(new PathNode(e.x,e.y+1,a,n,e))):(0!=e.x&&(null==this.grid[e.x-1][e.y].tile||e.x-1==t.x&&e.y==t.y||this.grid[e.x-1][e.y].tile.suitId==T.EMPTY_TILE_ID)&&(n="west",a=e.turns,""!=e.direction&&e.direction!=n&&a++,a<=T.MAX_TURNS)&&s.push(new PathNode(e.x-1,e.y,a,n,e)),e.x+1<this.grid.length&&(null==this.grid[e.x+1][e.y].tile||e.x+1==t.x&&e.y==t.y||this.grid[e.x+1][e.y].tile.suitId==T.EMPTY_TILE_ID)&&(n="east",a=e.turns,""!=e.direction&&e.direction!=n&&a++,a<=T.MAX_TURNS)&&s.push(new PathNode(e.x+1,e.y,a,n,e)),0!=e.y&&(null==this.grid[e.x][e.y-1].tile||e.x==t.x&&e.y-1==t.y||this.grid[e.x][e.y-1].tile.suitId==T.EMPTY_TILE_ID)&&(n="north",a=e.turns,""!=e.direction&&e.direction!=n&&a++,a<=T.MAX_TURNS)&&s.push(new PathNode(e.x,e.y-1,a,n,e)),e.y+1<this.grid[e.x].length&&(null==this.grid[e.x][e.y+1].tile||e.x==t.x&&e.y+1==t.y||this.grid[e.x][e.y+1].tile.suitId==T.EMPTY_TILE_ID)&&(n="south",a=e.turns,""!=e.direction&&e.direction!=n&&a++,a<=T.MAX_TURNS)&&s.push(new PathNode(e.x,e.y+1,a,n,e))),s},T.prototype.constructPath=function(e){for(var t=[],i=e;null!=i.parent;)t.push(i),i=i.parent;return t},T.prototype.showHint=function(e){for(var t,i,n,s,a=[],o=this.grid.length,r=this.tilesLeft=0;r<o;r++)for(n=this.grid[r].length,s=0;s<n;s++)null!=(t=this.grid[r][s].tile)&&t.suitId!=T.EMPTY_TILE_ID&&t.suitId!=T.BUSH_TILE_ID&&(this.tilesLeft++,a.push(t));for(o=a.length,r=0;r<o;r++)for(t=a[r],n=a.length,s=0;s<n;s++)if((t.x!=(i=a[s]).x||t.y!=i.y)&&t.suitId==i.suitId&&0<this.getPathBetweenTiles(new PathNode(t.x,t.y,0,"",null),new PathNode(i.x,i.y,0,"",null),!1).length)return e||(this.call="showHint"),this.hintTiles=[t,i],!0;return!1},T.prototype.shuffleBoard=function(){var e,t=[],i=this.grid.length;for(p=0;p<i;p++)for(a=this.grid[p].length,m=0;m<a;m++)if(null!=(e=this.grid[p][m].tile)&&e.suitId!=T.BUSH_TILE_ID&&e.suitId!=T.EMPTY_TILE_ID&&0!=e.suitId){t.push(e.suitId);for(var n=p;n<i;n++)for(var s,a=this.grid[n].length,o=0;o<a;o++)n==p&&o==m||null!=(s=this.grid[n][o].tile)&&s.suitId==e.suitId&&(s.suitId=0,s.id=0,o=a,n=i);e.suitId=0,e.id=0}this.shuffledArray=[];var r,h=[];for(p=0;p<this.grid.length;p++)for(this.shuffledArray[p]=[],m=0;m<this.grid[p].length;m++)null==this.grid[p][m].tile?this.shuffledArray[p][m]=T.EMPTY_TILE_ID:this.grid[p][m].tile.suitId==T.BUSH_TILE_ID?this.shuffledArray[p][m]=T.BUSH_TILE_ID:(this.shuffledArray[p][m]=0,h[h.length]=[],h[h.length-1][0]=p,h[h.length-1][1]=m);for(var l=[],d=Fabrique.Helper.getRandomRange(0,h.length),u=h[d][0],c=h[d][1],g=[],p=0;p<h.length;p++)u==h[p][0]&&c==h[p][1]||0<this.getPathBetweenTiles(new PathNode(u,c,0,"",null),new PathNode(h[p][0],h[p][1],0,"",null),!0).length&&(g[g.length]=[],g[g.length-1][0]=h[p][0],g[g.length-1][1]=h[p][1]);var d=Fabrique.Helper.getRandomRange(0,g.length),f=(r=g[d=void 0===g[d]?Fabrique.Helper.getRandomRange(0,g.length):d][0],d=g[d][1],t.splice(Fabrique.Helper.getRandomRange(0,t.length),1)[0]);for(l.push(new SaveTile(u,c,f)),l.push(new SaveTile(r,d,f)),this.shuffledArray[u][c]=T.EMPTY_TILE_ID,this.shuffledArray[r][d]=T.EMPTY_TILE_ID;0<t.length;){for(var m,_,y=this.findPotentialTiles(l),p=y.length;p;)m=Math.floor(p--*Math.random()),_=y[p],y[p]=y[m],y[m]=_;for(var S=Fabrique.Helper.getRandomRange(0,y.length),p=0;p<y.length;p++)if(p!=S&&0<this.getPathBetweenTiles(new PathNode(y[S][0],y[S][1],0,"",null),new PathNode(y[p][0],y[p][1],0,"",null),!0).length){f=t.splice(Fabrique.Helper.getRandomRange(0,t.length),1)[0];l.push(new SaveTile(y[S][0],y[S][1],f)),l.push(new SaveTile(y[p][0],y[p][1],f)),this.shuffledArray[y[S][0]][y[S][1]]=T.EMPTY_TILE_ID,this.shuffledArray[y[p][0]][y[p][1]]=T.EMPTY_TILE_ID;break}}for(p=0;p<l.length;p++)this.shuffledArray[l[p].i][l[p].j]=l[p].tileType;this.createGrid(),this.call="tilesUpdated"},T.prototype.finishLevel=function(){Constants.CURRENT_LEVEL!=T.TOTAL_LEVELS?(this.call="finishLevel",Constants.CURRENT_SCORE=this.score,console.log("finsished level score: "+Constants.CURRENT_SCORE)):(this.call="finishGame",this.gameover=!0,this.complete=!0)},T.prototype.getTileAt=function(e,t){return this.grid[e][t].tile},T.TOTAL_LEVELS=9,T.NUMBER_OF_TILES=140,T.NUMBER_OF_ROWS=10,T.MAX_TURNS=2,T.MATCH_SCORE=1,T.POINTS_PER_SECCOND=3.16,T.EMPTY_TILE_ID=99,T.BUSH_TILE_ID=100,T}(Fabrique.BackendGame),Atlases=(!function(e){function t(e,t){this.game=e,this.lineGroup=t}t.prototype.create=function(e,t,i,n,s){for(var a=0;a<e.length-1;a++){var o=0==a,r=a==e.length-2;o&&this.createStartLineSegment(e[a],e[a+1],t,s),r&&this.createStartLineSegment(e[a+1],e[a],t,s,!0),a<e.length-2&&this.createAngleSprite(e[a],e[a+1],e[a+2],t,n),this.createStraightLineSegment(e[a],e[a+1],t,i,o,r)}},t.prototype.createStartLineSegment=function(e,t,i,n,s){void 0===s&&(s=!1);var a=t.x-e.x,t=t.y-e.y,t=Phaser.Math.radToDeg(Math.atan2(t,a)),a=this.game.add.sprite(e.x,e.y,i,n);this.startLineWidth=a.width,a.anchor.setTo(.5,.5),a.angle=t-90,s&&(a.scale.x=-1),this.lineGroup.add(a)},t.prototype.createStraightLineSegment=function(e,t,i,n,s,a){void 0===s&&(s=!1),void 0===a&&(a=!1);var s=t.x-e.x,a=t.y-e.y,a=Phaser.Math.radToDeg(Math.atan2(a,s)),s=.5*this.startLineWidth-1,o=Math.cos(a*(Math.PI/180))*s,s=Math.sin(a*(Math.PI/180))*s,o=(e=new Phaser.Point(e.x+o,e.y+s),t=new Phaser.Point(t.x-o,t.y-s),Phaser.Math.distance(e.x,e.y,t.x,t.y)),s=this.game.add.sprite(e.x,e.y,i,n);s.anchor.set(.5,0),s.scale.set(1,o/s.height),s.angle=a-90,s.scale.x=-1,this.lineGroup.add(s)},t.prototype.createAngleSprite=function(e,t,i,n,s){var n=this.game.add.sprite(t.x,t.y,n,s),s=(n.anchor.setTo(.5,.5),0),a=t.x-e.x,e=t.y-e.y,o=i.x-t.x,i=i.y-t.y;0<a?s=0<i?180:-90:a<0?s=0<i?90:0:0<e?s=0<o?0:-90:e<0&&(s=0<o?90:180),n.angle=s,this.lineGroup.add(n)},e.CustomLineFactory=t}(ButterflyKyodai=ButterflyKyodai||{}),function(){function e(){}return e.wingsIdlePack="wings_idle_pack_0",e.wingsFlyPack="wings_fly_pack_0",e.kWings_default="wings_idle_pack_0",e.kWings_2="wings_idle_pack_1",e.kWings_3="wings_idle_pack_2",e.kWings_4="wings_idle_pack_3",e.kWings_5="wings_idle_pack_4",e.kWings_6="wings_idle_pack_5",e.wings_fly_default="wings_fly_pack_0",e.wings_fly_2="wings_fly_pack_1",e.wings_fly_3="wings_fly_pack_2",e.wings_fly_4="wings_fly_pack_3",e.wings_fly_5="wings_fly_pack_4",e.wings_fly_6="wings_fly_pack_5",e.game_scene_ui="game_ui",e.kGui_2="gui-2",e.preloadList=[e.kWings_default,e.kWings_2,e.kWings_3,e.kWings_4,e.kWings_5,e.kWings_6,e.wings_fly_default,e.wings_fly_2,e.wings_fly_3,e.wings_fly_4,e.wings_fly_5,e.wings_fly_6,e.game_scene_ui],e}()),Constants=function(){function e(){}return e.GAME_SCALE=1,e.GAME_WIDTH=1600,e.GAME_HEIGHT=1200,e.CALCULATED_WIDTH=0,e.CALCULATED_HEIGHT=0,e.kVersion="1.3.1",e.SPLASH_BACKGROUND=11119017,e.SPLASH_IMAGE="OG_logo_fullcolor",e.SPLASH_URL="http://www.funnygames.nl",e.MORE_GAMES_URL="http://www.funnygames.nl",e.GAME_TITLE="butterfly_kyodai",e.GD_GAME_ID="b35775a1725241d3bb619614da205a09",e.CURRENT_LEVEL=0,e.CURRENT_SCORE=0,e.CURRENT_HINTS=0,e.CURRENT_RESETS=0,e.CURRENT_FREEZES=0,e.CURRENT_CONTINUES=0,e.CURRENT_VIDEO_HINTS=0,e.CURRENT_VIDEO_RESETS=0,e.CURRENT_VIDEO_FREEZES=0,e.WIN_COINS_BASE=10,e.WIN_COINS_PER_LEVEL=5,e.WIN_FREEZES=2,e.WIN_HINTS=3,e.WIN_SHUFFLES=1,e.isGameOver=!1,e.AVAILABLE_LANGUAGES=["en","de","es","fr","it","ja"],e}(),Images=function(){function e(){}return e.MenuBackImage="background_menu",e.MenuGameLogo="menuGameLogo",e.backGround="backGround",e.back_1="background_game_1",e.back_2="background_game_2",e.GameOverImage="gameOverImage",e.Logo="Logo.png",e.Fon="Fon.png",e.LoaderBarFn="LoaderBarFn.png",e.LoaderBarBg="LoaderBarBg.png",e.dustParticle="dust-particle",e.listSL=[e.Logo,e.LoaderBarFn,e.LoaderBarBg,e.Fon],e.preloadList=[e.back_1,e.back_2,e.MenuBackImage,e.MenuGameLogo,e.dustParticle],e}(),Sounds=function(){function e(){}return e.themeMusic="music_theme",e.buttonClick="any_button_press",e.hintShuffleFreeze="hint_shuffle_freeze_usage",e.butterfliesAppearOnScreen="butterflies_appear_on_screen",e.butterflyFlap="butterfly_flies_away_after_connected",e.preloadList=[e.buttonClick,e.butterfliesAppearOnScreen,e.butteflyConnectionCompleted_1="butterfly_connection",e.butteflyConnectionCompleted_2="butterfly_connection2",e.butteflyConnectionCompletedDefault="butterfly_connection3",e.butterflyFlap,e.levelCompleted="level_completed",e.hintShuffleFreeze,e.levelLost="loss"],e}(),SpriteNames=function(){function e(){}return e.PAUSE_BUTTON="game_button_pause.png",e.STORE_BUTTON="game_button_store.png",e.SOUND_BUTTON_ON="game_sound_on.png",e.SOUND_BUTTON_OFF="game_sound_off.png",e.SCORE_COUNTER="game_score_counter.png",e.SCORE_COUNTER_STAR="game_score_counter_star.png",e.TIMER_BACKGROUND="game_time_progress_back.png",e.TIMER_BACKGROUND_DOT="game_time_progress_dot_front.png",e.TIMER_FRONT="game_time_progress_front.png",e.TIMER_FREEZE="game_time_progress_freeze.png",e.FREEZE_BUTTON="game_button_freeze_active.png",e.FREEZE_BUTTON_DOT="game_button_freeze_dot.png",e.FREEZE_BUTTON_PASSIVE="game_button_freeze_passive.png",e.HINT_BUTTON="game_button_hint_active.png",e.HINT_BUTTON_DOT="game_button_hint_dot.png",e.HINT_BUTTON_PASSIVE="game_button_hint_passive.png",e.SHUFFLE_BUTTON="game_button_shaffle_active.png",e.SHUFFLE_BUTTON_DOT="game_button_shaffle_dot.png",e.SHUFFLE_BUTTON_PASSIVE="game_button_shaffle_passive.png",e.TILE_SELECTOR="game_board_selector.png",e.START_BUTTON="main_button_play.png",e.START_BUTTON_ICON="pause_icon_play.png",e.MAIN_LOGO="main_logo.png",e.POP_UP_BACKGROUND="pause_back.png",e.PAUSE_BUTTON_LONG="pause_button_long.png",e.PAUSE_BUTTON_SMALL="pause_button_small.png",e.PAUSE_ICON_HOME="pause_icon_home.png",e.PAUSE_ICON_PLAY="pause_icon_play.png",e.AD_ICON="store_title_icon_ad.png",e.FINISH_FRONT_BACKGROUND="finish_back_front.png",e.FINISH_BUTTON="finish_button.png",e.FINISH_ICON_FREEZE="finish_icon_freeze.png",e.FINISH_ICON_SHUFFLE="finish_icon_shaffle.png",e.FINISH_ICON_HINT="finish_icon_hint.png",e.COIN="store_title_counter_coin.png",e.FINISH_VERTICAL_LINE="finish_line_vertical.png",e.LINE_STRAIGHT="line_ straight.png",e.LINE_ANGLE="line_angle.png",e.LINE_START="line_start.png",e.BOARD_PEACE_LIGHT="game_boar_piece_bright.png",e.BOARD_PEACE_DARK="game_boar_piece_darck.png",e.HINT="game_board_hint_selector.png",e.FLOWER="Flower_new.png",e.STORE_ITEM_WING_SELECTED="store_item_selected_back.png",e.STORE_ITEM_WING_UNSELECTED="store_item_unselected_back.png",e.STORE_BACKGROUND="store_back.png",e.STORE_ITEM_BACKGROUND_1="store_item_bg_1.png",e.STORE_ITEM_BACKGROUND_2="store_item_bg_2.png",e.STORE_ITEM_BACKGROUND_SELECTED="store_item_selected_back_long.png",e.STORE_TITLE_BUTTON="store_title_button.png",e.STORE_CLOSE_BUTTON="store_cross.png",e.STORE_TITLE_COUNTER="store_title_counter_back.png",e.STORE_PURCHASE_ITEM_BUTTON="Frame 18.png",e.STORE_ITEM_SELECTED_ICON="store_item_selected_check.png",e}(),SplashLoader=(!function(e){(i=t=e.IntegrationEvents||(e.IntegrationEvents={})).SPLASH_LOAD_COMPLETE="splash_load_complete",i.RESUME_GAME="resume_game",i.EXIT_GAME_FROM_PAUSE_SCREEN="exit_game_from_pause_screen",i.NEXT_LEVEL="next_level",i.CLAIM_FREEZE="claim_freeze",i.CLAIM_HINT="claim_hint",i.CLAIM_SHUFFLE="claim_shuffle",i.CLAIM_EXTRA_TURN="claim_extra_turn",i.CLAIM_BONUS="claim_bonus",i.CLAIM_COINS="claim_coins",i.EXIT_SHOP_FROM_MENU="exit_shop_from_menu",i.EXIT_SHOP_FROM_GAME="exit_shop_from_game",i.REPLAY="replay",i.START_GAME_FROM_MAIN="start_game_from_main",n.getEventNames=function(){return this.eventsToCreate},n.register=function(){n.eventsToCreate.map(function(e){n.events.push(new Event(e))})},n.dispatch=function(t){var e=n.events.filter(function(e){return e.type===t});e&&0<e.length&&document.dispatchEvent(e[0])},n.clear=function(){n.events=[]},n.eventsToCreate=[t.SPLASH_LOAD_COMPLETE,t.RESUME_GAME,t.NEXT_LEVEL,t.REPLAY,t.CLAIM_COINS,t.CLAIM_BONUS,t.CLAIM_EXTRA_TURN,t.CLAIM_FREEZE,t.CLAIM_SHUFFLE,t.CLAIM_HINT,t.EXIT_GAME_FROM_PAUSE_SCREEN,t.EXIT_SHOP_FROM_GAME,t.EXIT_SHOP_FROM_MENU],n.events=[];var t,i=n;function n(){}e.AdEventTracker=i}(AzerionIntegration=AzerionIntegration||{}),!function(a){(e=o=o||{}).PAUSED="Paused",e.RESUMED="Resumed",t.getInstance=function(){return t.instance=t.instance?t.instance:new t},t.prototype.init=function(){this.disableAds=!1,this.azAdWrapper=new window.h5ads.AdWrapper(window._azerionIntegration.advType,window._azerionIntegration.gdId)},t.prototype.showAd=function(e,t,i){var n=this;AzerionIntegration.AdEventTracker.dispatch(e),a.LoaderHelper.show(),this.azAdWrapper.once(h5ads.AdEvents.CONTENT_PAUSED,function(){a.LoaderHelper.hide(),i&&i.call(n),n.contentStatus=o.PAUSED,a.PauseHandler.getInstance().pause()}),this.azAdWrapper.once(h5ads.AdEvents.CONTENT_RESUMED,function(){a.LoaderHelper.hide(),n.azAdWrapper.removeAllListeners(h5ads.AdEvents.CONTENT_PAUSED),n.azAdWrapper.removeAllListeners(h5ads.AdEvents.CONTENT_RESUMED),n.contentStatus=o.RESUMED,a.PauseHandler.getInstance().resume(),t&&t.call(n),n.azAdWrapper.preloadAd(h5ads.AdType.interstitial)}),this.azAdWrapper.showAd(h5ads.AdType.interstitial)},t.prototype.showRewardedAd=function(e,t,i){var n=this,s=(a.LoaderHelper.show(),this.azAdWrapper.once(h5ads.AdEvents.CONTENT_PAUSED,function(){a.LoaderHelper.hide(),n.contentStatus=o.PAUSED,a.PauseHandler.getInstance().pause()}),!1);this.azAdWrapper.once(h5ads.AdEvents.AD_REWARDED,function(){s=!0}),this.azAdWrapper.once(h5ads.AdEvents.CONTENT_RESUMED,function(){a.LoaderHelper.hide(),n.contentStatus=o.RESUMED,(s?t:i)(),n.azAdWrapper.removeAllListeners(h5ads.AdEvents.CONTENT_PAUSED),n.azAdWrapper.removeAllListeners(h5ads.AdEvents.CONTENT_RESUMED),n.azAdWrapper.removeAllListeners(h5ads.AdEvents.AD_REWARDED),n.azAdWrapper.preloadAd(h5ads.AdType.rewarded),a.PauseHandler.getInstance().resume()}),this.azAdWrapper.showAd(h5ads.AdType.rewarded)},t.prototype.isAdPlaying=function(){return this.contentStatus===o.PAUSED},t.instance=null;var o,e=t;function t(){this.disableAds=!1,this.contentStatus=o.RESUMED}a.AdHandler=e}(Fabrique=Fabrique||{}),!function(e){var s;function t(e,t,i){void 0===i&&(i=null);var n=s.call(this,e)||this;n.beginFill(t,1),n.drawRect(0,0,n.game.width,n.game.height);e.add.group(n,"white",!0).add(n);t=n.game.add.tween(n);return t.to({alpha:0},100),t.onComplete.add(function(){null!==i&&i()}),t.start(),n}e=e.Effects||(e.Effects={}),s=Phaser.Graphics,__extends(t,s),e.FadeFromColor=t}(Fabrique=Fabrique||{}),!function(e){var a;function t(e,t,i,n){var s=a.call(this,e)||this,t=(s.alpha=0,s.beginFill(t,1),s.drawRect(0,0,s.game.width,s.game.height),e.add.existing(s),s.game.add.tween(s));return t.to({alpha:1},100),t.onComplete.add(function(){e.state.start(i,!0,!1,n)}),t.start(),s}e=e.Effects||(e.Effects={}),a=Phaser.Graphics,__extends(t,a),e.FadeToColor=t}(Fabrique=Fabrique||{}),!function(i){(e=i.GameEventType||(i.GameEventType={})).LEVEL_START="START",e.LEVEL_FAIL="FAIL",e.UNLOCK_ITEM="UNLOCK_ITEM",e.USE_BOOSTER="USE_BOOSTER",e.REWARD_AFTER_AD="REWARD_AFTER_AD",t.setConfig=function(e){this.biConfig=e},t.getMilestoneDescription=function(e,t){return this.biConfig[e].eventName.replace("%%",t)},t.sendEvent=function(e,t){e=i.GameEvents.getMilestoneDescription(e,t);window.gdsdk&&window.gdsdk.sendEvent({eventName:"track-milestone",data:{milestoneDescription:e}})},t.configName="biConfig";var e=t;function t(){}i.GameEvents=e}(AzerionIntegration=AzerionIntegration||{}),!function(e){function t(){}t.show=function(){var e=document.getElementById("loader");e&&(e.style.display="block")},t.hide=function(){var e=document.getElementById("loader");e&&(e.style.display="none")},e.LoaderHelper=t}(Fabrique=Fabrique||{}),!function(e){(t=i=e.LocalizationType||(e.LocalizationType={})).English="en",t.German="de",t.Spanish="es",t.French="fr",t.Italian="it",t.Japanese="ja",n.getInstance=function(e){return n.instance=n.instance?n.instance:new n(e)},n.prototype.initBrowserDetect=function(){languageDetector=new i18nextBrowserLanguageDetector(null,{order:["navigator","querystring","cookie","localStorage","sessionStorage","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"]})},n.prototype.initI18Next=function(){var t=this;i18next.use(languageDetector).init({fallbackLng:"en",debug:!1,resources:{en:{translation:this.game.cache.getJSON(i.English)},de:{translation:this.game.cache.getJSON(i.German)},es:{translation:this.game.cache.getJSON(i.Spanish)},fr:{translation:this.game.cache.getJSON(i.French)},it:{translation:this.game.cache.getJSON(i.Italian)},ja:{translation:this.game.cache.getJSON(i.Japanese)}}}).then(function(e){i18next.changeLanguage(t.getDefaultLanguage()),console.log("Translation loaded")})},n.prototype.getDefaultLanguage=function(){var e=i18next.language;return-1!==e.indexOf("-")&&(e=e.split("-")[0]),e=-1===Constants.AVAILABLE_LANGUAGES.indexOf(e)?i.English:e},n.prototype.getValue=function(e){return i18next.t(e)},n.prototype.getInterpolatedValue=function(e,t){return i18next.t(e,t)};var i,t=n;function n(e){this.game=e}e.LocalizationHandler=t}(Fabrique=Fabrique||{}),!function(e){function o(e,t,i){void 0===e&&(e=52),void 0===t&&(t=1),void 0===i&&(i=0),this.cards=[],this.rndm=Math,this.cardsPerDeck=e,this.numberOfDecks=t,this.numberOfJokers=i;for(var n,s=this.numberOfDecks*this.cardsPerDeck,a=0;a<s;a+=1)this.cards.push(a%this.cardsPerDeck+1);for(n=1;n<=this.numberOfJokers;n+=1)this.cards.push(o.JOKER_ID)}o.prototype.shuffle=function(){var e=this.cards.length,t=this.cards;if(0===e)return null;for(;--e;){var i=Math.floor(this.rndm.random()*(e+1)),n=t[e];t[e]=t[i],t[i]=n}return this.cards=t,this},o.prototype.getBlackJackCardValue=function(e){return 52<e||e<1?0:0===(e=this.getCardValue(e))||10<e?10:e},o.prototype.deal=function(){return this.cards.pop()},o.prototype.size=function(){return this.cards.length},o.prototype.peak=function(){return this.cards[this.cards.length-1]},o.prototype.isJoker=function(e){return e===o.JOKER_ID},o.prototype.getCardValue=function(e){return e%13},o.prototype.getSuit=function(e){return Math.ceil(e/13)%4},o.prototype.addCard=function(e){this.cards.push(e)},o.prototype.isBlackSuit=function(e){e=this.getSuit(e);return e===o.SUIT_SPADES||e===o.SUIT_CLUBS},o.SUIT_HEARTS=0,o.SUIT_DIAMONDS=2,o.SUIT_SPADES=1,o.SUIT_CLUBS=3,o.JOKER_ID=53,e.Deck=o}(Fabrique=Fabrique||{}),!function(e){i=e.ResponsiveGroup,__extends(n,i),n.prototype.updateTimeLeft=function(e){this.bar.scale.x=(e=(e=void 0===e?0:e)<0?0:e)/this.start,this.timerText.text=this.formatTime(e)},n.prototype.SetFreezeShow=function(e){this.freeze_top_.visible=e},n.prototype.formatTime=function(e){var t=Math.floor(e/60),e=e-60*t;return t+":"+((e=Math.floor(e))<10?"0"+e:""+e)};var i,t=n;function n(e,t){e=i.call(this,e,null,"timer",!0)||this,e.start=0,e.start=t,t=new Phaser.Image(e.game,0,0,Atlases.game_scene_ui,SpriteNames.TIMER_BACKGROUND);return e.add(t),e.bar=new Phaser.Image(e.game,0,0,Atlases.game_scene_ui,SpriteNames.TIMER_FRONT),e.bar.x=t.width-e.bar.width-8,e.bar.height=e.bar.height,e.bar.y=(t.height-e.bar.height)/2,e.add(e.bar),e.bar.bringToTop(),e.freeze_top_=new Phaser.Image(e.game,0,0,Atlases.game_scene_ui,SpriteNames.TIMER_FREEZE),e.freeze_top_.visible=!1,e.freeze_top_.position.set(40,0),e.add(e.freeze_top_),e.timerDotSprite=new Phaser.Sprite(e.game,0,0,Atlases.game_scene_ui,SpriteNames.TIMER_BACKGROUND_DOT),e.add(e.timerDotSprite),e.timerDotSprite.position.set(4,4),e.stageNumber=new Phaser.Text(e.game,0,0,Constants.CURRENT_LEVEL.toString(),{font:"40px 'Balsamiq Sans Bold'",fill:"#ffffff",stroke:"#5F2E95",strokeThickness:4}),e.stageNumber.anchor.set(.5,.5),e.stageNumber.position.set(38,38),e.timerDotSprite.addChild(e.stageNumber),e.timerText=new Phaser.Text(e.game,0,0,"2:30",{font:"30px 'Balsamiq Sans Bold'",fill:"#ffffff",align:"center",stroke:"#2B5DBF",strokeThickness:4}),e.add(e.timerText),e.timerText.anchor.set(.5,.5),e.timerText.position.set(250,45),e}e.Timer=t}(Fabrique=Fabrique||{}),!function(e){function t(e){this.game=e,this.focused=!0}t.getInstance=function(e){return t.instance=t.instance?t.instance:new t(e)},t.prototype.init=function(){var e=this;this.game.stage.disableVisibilityChange=!0,this.onPauseCallback=new Phaser.Signal,this.onResumeCallback=new Phaser.Signal,h5branding.Utils.isOnDevice()&&(document.addEventListener("pause",function(){return e.onPause()}),document.addEventListener("resume",function(){return e.onResume()})),this.game.onBlur.add(this.onBlur,this),this.game.onFocus.add(this.onFocus,this),this.game.onPause.add(this.onPause,this),this.game.onResume.add(this.onResume,this)},t.prototype.onBlur=function(){console.log("blur"),this.focused=!1,this.game.onPause.dispatch()},t.prototype.onFocus=function(){console.log("focus"),this.focused=!0,e.AdHandler.getInstance().isAdPlaying()||this.game.onResume.dispatch()},t.prototype.onPause=function(){console.log("pause"),this.game.sound.setMute(),this.onPauseCallback&&this.onPauseCallback.dispatch()},t.prototype.onResume=function(){console.log("resume"),this.game.sound.unsetMute(),this.onResumeCallback&&this.onResumeCallback.dispatch()},t.prototype.pause=function(){this.game.onPause.dispatch()},t.prototype.resume=function(){this.game.onResume.dispatch()},Object.defineProperty(t.prototype,"hasFocus",{get:function(){return this.focused},enumerable:!1,configurable:!0}),e.PauseHandler=t}(Fabrique=Fabrique||{}),!function(e){function s(){}s.init=function(e){(s.game=e).scale.pageAlignHorizontally=!0,e.scale.pageAlignVertically=!0,e.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,window.onresize=function(){s.SizeCalculation(e)},s.SizeCalculation(e)},s.SizeCalculation=function(e){var t=s.GameWidth,i=s.GameHeight,n=Math.min(window.innerWidth/s.GameWidth,window.innerHeight/s.GameHeight);document.getElementById("content").style.minHeight=window.innerHeight.toString()+"px",t=t*n<window.innerWidth?window.innerWidth/n:t,i=i*n<window.innerHeight?window.innerHeight/n:i,s.scale=n,e.scale.setUserScale(n,n,0,0),e.scale.setGameSize(t,i),e.scale.refresh()},s.bkgX=function(){return(s.GameWidth-s.MaxWidth)/2},s.bkgY=function(){return(s.GameHeight-s.MaxHeight)/2},s.handleIncorrect=function(){e.Services.isDesktop()||(document.getElementById("turn").style.display="block",s.game.world.isPaused=!0)},s.handleCorrect=function(){e.Services.isDesktop()||(document.getElementById("turn").style.display="none",s.game.world.isPaused=!1),setTimeout("window.scrollTo(0,0)",1e3)},s.GameWidth=1600,s.GameHeight=1200,s.MaxWidth=1600,s.MaxHeight=1200,e.ScaleManager=s}(Fabrique=Fabrique||{}),!function(e){function t(){}t.init=function(e){t.game=e},t.isDesktop=function(){return t.game.device.desktop},e.Services=t}(Fabrique=Fabrique||{}),function(i){function n(t){var e=i.call(this,t)||this;return e.isLocalLoadComplete=!1,Images.listSL.forEach(function(e){return t.load.image(e,"assets/images/"+e)}),t.load.onLoadComplete.add(function(){e.initItems(),e.rescale(),e.isLocalLoadComplete=!0,e.isEnable=!0,e.startTime=(new Date).getTime()}),e.currentProgres=0,e}return __extends(n,i),n.prototype.initItems=function(){this.logoGroup=this.game.make.group();this.fonBg=this.game.add.image(0,0,Images.Fon),this.logo=this.game.add.image(0,-25,Images.Logo),this.text=this.game.add.text(0,25,"0%",{font:"24px Arial",fill:"#ffffff"}),this.loaderBg=this.game.add.image(-n.LOAD_BAR_W/2,25+this.text.height,Images.LoaderBarBg),this.loaderFn=this.game.add.image(-n.LOAD_BAR_W/2,25+this.text.height,Images.LoaderBarFn),this.fonBg.anchor.set(.5),this.loaderBg.anchor.set(0,.5),this.loaderFn.anchor.set(0,.5),this.logo.anchor.set(.5,1),this.text.anchor.set(.5,0),this.logo.scale.set(.5),this.addChild(this.fonBg),this.addChild(this.logoGroup),this.logoGroup.addChild(this.logo),this.logoGroup.addChild(this.text),this.logoGroup.addChild(this.loaderBg),this.logoGroup.addChild(this.loaderFn),this.rescale()},n.prototype.rescale=function(){var e=this.game.width/2,t=this.game.height/2;this.fonBg.width=this.game.width,this.fonBg.height=this.game.height,this.x=e,this.y=t,this.logoGroup.y=250,this.loaderBg.height=n.LOAD_BAR_H,this.loaderFn.height=n.LOAD_BAR_H,this.loaderBg.width=n.LOAD_BAR_W,this.game.height>this.game.width?this.scale.set(1.5,1.5):this.scale.set(1.2,1.2)},n.prototype.setProgres=function(e){this.currentProgres=e},n.prototype.closePopUp=function(){this.visible=!1},n.prototype.update=function(){if(0!=this.isEnable){var e=(new Date).getTime();if(this.isLocalLoadComplete){var t=(e-this.startTime)/1500;if(1<t)return void(this.isLocalLoadComplete=!1);this.loaderFn.width=n.LOAD_BAR_W*t,this.text.text=Math.round(100*t)+"%"}100<=this.currentProgres&&e>this.startTime+1500&&(this.onLoadComplete(),this.closePopUp(),this.isEnable=!1)}},n.LOAD_BAR_W=200,n.LOAD_BAR_H=5,n.MOVE_LIMIT=60,n}(Phaser.Group));!function(e){t=Phaser.State,__extends(n,t),n.prototype.create=function(){},n.Name="default";var t,i=n;function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.name=n.Name,e}e.State=i}(Fabrique=Fabrique||{}),function(i){t=i.State,__extends(o,t),o.prototype.init=function(){var e=this;ButterflyKyodai.Hlp.init(this.game),i.AdHandler.getInstance().init(),i.PauseHandler.getInstance(this.game).init(),h5branding.SplashLoader.getInstance().destroy(),this.game.input.maxPointers=1,this.game.canvas.oncontextmenu=function(e){e.preventDefault()},this.game.device.desktop?(this.game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.fullScreenScaleMode=Phaser.ScaleManager.SHOW_ALL):(this.game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.fullScreenScaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.setResizeCallback(this.mobileResizeCallback,this),this.game.scale.pageAlignVertically=!0,this.game.scale.windowConstraints.right="layout",this.game.scale.onSizeChange.add(function(){e.game.state.getCurrentState().resize()},this)),this.game.scale.pageAlignHorizontally=!0,this.game.scale.windowConstraints.bottom="visual"},o.prototype.mobileResizeCallback=function(e){var t=window.innerWidth,i=window.innerHeight,n=(o.setScaling(e.game),Constants.GAME_WIDTH*Constants.GAME_SCALE),s=Constants.GAME_HEIGHT*Constants.GAME_SCALE,a=1;a/=i<t?i/s:i/n,Constants.CALCULATED_WIDTH=Math.ceil(t*a),Constants.CALCULATED_HEIGHT=Math.ceil(i*a),e.setGameSize(Constants.CALCULATED_WIDTH,Constants.CALCULATED_HEIGHT),e.setUserScale(1/a,1/a)},o.prototype.checkOrientation=function(){var e=document.getElementById("dummy").getBoundingClientRect().left;document.getElementById("dummy").getBoundingClientRect().top<e?this.leaveIncorrectOrientation():this.enterIncorrectOrientation()},o.prototype.enterIncorrectOrientation=function(){document.getElementById("orientation").style.display="block",document.getElementById("content").style.display="none"},o.prototype.leaveIncorrectOrientation=function(){document.getElementById("orientation").style.display="none",document.getElementById("content").style.display="block"},o.prototype.preload=function(){var t=this;i.LoaderHelper.hide(),ButterflyKyodai.Hlp.restore(),this.splashLoader=new SplashLoader(this.game),this.game.world.moveUp(this.splashLoader),this.game.load.onFileComplete.add(function(e){t.splashLoader.setProgres(e)}),this.splashLoader.onLoadComplete=function(){i.LocalizationHandler.getInstance().initI18Next(),AzerionIntegration.GameEvents.setConfig(t.cache.getJSON(AzerionIntegration.GameEvents.configName)),h5branding.Utils.inGDGameZone()?t.game.state.start(ButterflyKyodai.Menu.Name):i.AdHandler.getInstance().showAd(AzerionIntegration.IntegrationEvents.SPLASH_LOAD_COMPLETE,function(){t.game.state.start(ButterflyKyodai.Menu.Name)})},Constants.AVAILABLE_LANGUAGES.forEach(function(e){t.load.json(e,"assets/languages/"+e+".json")}),this.load.json("biConfig","assets/json/config.json"),this.game.load.crossOrigin="anonymous",h5branding.Utils.getBrandingDomain()!==h5branding.BrandingDomain.Neutral&&this.game.load.image("branding_logo",h5branding.Branding.brandingLogoUrl),Images.preloadList.forEach(function(e){t.game.load.image(e,"assets/images/"+e+".png")}),Atlases.preloadList.forEach(function(e){t.game.load.atlas(e,"assets/atlas/"+e+".png","assets/atlas/"+e+".json")}),Sounds.preloadList.forEach(function(e){t.game.load.audio(e,["assets/sound/"+e+".mp3"])}),this.game.load.audio(Sounds.themeMusic,["assets/sound/"+Sounds.themeMusic+".ogg"])},o.setScaling=function(e){var t=window.innerWidth>window.innerHeight?window.innerWidth:window.innerHeight;t*=e.device.pixelRatio,Constants.GAME_SCALE=t<650?.5:1050<t?1:.75},o.Name="boot";var t,e=o;function o(){var e=t.call(this)||this;return e.name=o.Name,e}i.Boot=e}(Fabrique=Fabrique||{}),function(e){function t(){}t.getRandomRange=function(e,t){return Math.random()*(t-e)+e|0},t.intTimeToString=function(e){var t=Math.floor(e/3600),i=Math.floor(e/60),e=e%60;return(t<10?"0"+t:t.toString())+":"+(i<10?"0"+i:i.toString())+":"+(e<10?"0"+e:e.toString())},e.Helper=t}(Fabrique=Fabrique||{}),function(d){var i,e;function u(){}u.init=function(e){(u.game=e).storage.setNamespace("BKyoDaiDx")},u.GetLevelPassCoinsAward=function(e){return Constants.WIN_COINS_BASE+e*Constants.WIN_COINS_PER_LEVEL},u.UpdateCurrentTiles=function(){switch(u.Load().current_wings){case 1:Atlases.wingsIdlePack=Atlases.kWings_default,Atlases.wingsFlyPack=Atlases.wings_fly_default;break;case 2:Atlases.wingsIdlePack=Atlases.kWings_2,Atlases.wingsFlyPack=Atlases.wings_fly_2;break;case 3:Atlases.wingsIdlePack=Atlases.kWings_3,Atlases.wingsFlyPack=Atlases.wings_fly_3;break;case 4:Atlases.wingsIdlePack=Atlases.kWings_4,Atlases.wingsFlyPack=Atlases.wings_fly_4;break;case 5:Atlases.wingsIdlePack=Atlases.kWings_5,Atlases.wingsFlyPack=Atlases.wings_fly_5;break;case 6:Atlases.wingsIdlePack=Atlases.kWings_6,Atlases.wingsFlyPack=Atlases.wings_fly_6}},u.UpdateCurrentBackground=function(){switch(u.Load().current_backs){case 1:Images.backGround=Images.back_1;break;case 2:Images.backGround=Images.back_2}},u.GenerateAward=function(){var e=Math.random();return e<.23?new t(i.kCoins,5):e<.39?new t(i.kCoins,10):e<.44?new t(i.kCoins,20):e<.61?new t(i.kHints,1):e<.68?new t(i.kHints,2):e<.78?new t(i.kResets,1):e<.81?new t(i.kResets,2):new t(i.kFrezes,e<.95?1:2)},u.restore=function(){var t,i=this,n={current_wings:1,current_backs:1,buyed_wings:[1,0,0,0,0],buyed_backs:[1,0,0,0],coins:0,last_daily_time:0,daily_coins:0,daily_freezes:0,daily_resets:0,daily_hints:0,awards:0,shop_ad_time:0};this.game.storage.getItem(u.kSaveId).then(function(e){if(console.log("SaveGame; constructor; loading save data; storedItem",e),null==e)t=JSON.stringify(n);else try{t=e}catch(e){t=JSON.stringify(n),console.warn("Unable to parse save game.",e)}u.save_=JSON.parse(t),i.SetDefaultValues(n,u.save_)})},u.Load=function(){return u.save_},u.Save=function(){var e=this.Load();try{this.game.storage.setItem(u.kSaveId,JSON.stringify(e))}catch(e){console.warn("Unable to save game.",e)}},u.loadScores=function(){this.game.storage.getItem("scores").then(function(e){console.log("SaveGame; constructor; loading save data; storedItem",e);var t=null;try{t=e}catch(e){console.warn("Unable to parse save game.",e)}return t})},u.SaveScores=function(e){try{this.game.storage.setItem("scores",JSON.stringify(e))}catch(e){console.warn("Unable to save game.",e)}},u.NewCenteredSprite=function(e,t,i){e=new Phaser.Sprite(e,0,0,t,i);return e.anchor.setTo(.5,.5),e},u.NewFullCenteredSprite=function(e,t,i,n,s,a,o){void 0===n&&(n=0),void 0===s&&(s=0),void 0===a&&(a=1),void 0===o&&(o=null);e=new Phaser.Sprite(e,0,0,t,i);return e.anchor.setTo(.5,.5),e.x=n,e.y=s,e.alpha=a,null!=o&&(e.name=o),e},u.ButtonLikeOld=function(e,t,i){var n=new Phaser.Sprite(e,0,0),s=(n.name="__normal",n.addChild(u.NewFullCenteredSprite(e,t,i+"_shape")),n.addChild(u.NewFullCenteredSprite(e,t,i+"_alpha",0,0,.1)),new Phaser.Sprite(e,0,0)),a=(s.name="__over",s.addChild(u.NewFullCenteredSprite(e,t,i+"_shape",0,-2)),s.addChild(u.NewFullCenteredSprite(e,t,i+"_alpha",0,-2,0)),new Phaser.Sprite(e,0,0)),o=(a.name="__down",a.addChild(u.NewFullCenteredSprite(e,t,i+"_shape",0,5)),a.addChild(u.NewFullCenteredSprite(e,t,i+"_alpha",0,5,.4)),new Phaser.Sprite(e,0,0)),t=(o.name="__disabled",o.addChild(u.NewFullCenteredSprite(e,t,i+"_shape")),o.addChild(u.NewFullCenteredSprite(e,t,i+"_alpha",0,0,.8)),new d.Button(e));return t.SetStates(n,s,a,o),t},u.NewButtonBitmapScaling=function(e,t,i,n,s,a,o){void 0===s&&(s=null),void 0===a&&(a=null),void 0===o&&(o=null);var r,h=new d.Button(e,0,0,n=void 0===n?!1:n),l=(h.OnClick().add(function(){return d.AudioManager.playSound(Sounds.buttonClick)}),u.NewCenteredSprite(e,t,i)),a=null==a?1:a,o=null==o?1:o;return n?(n=e.add.tween(h.scale).to({x:+a,y:+o},50,Phaser.Easing.Linear.None),r=e.add.tween(h.scale).to({x:1.075*a,y:1.075*o},50,Phaser.Easing.Linear.None),a=e.add.tween(h.scale).to({x:.95*a,y:.95*o},50,Phaser.Easing.Linear.None),h.setTweens(n,r,a),null!=s?(o=u.NewCenteredSprite(e,t,s),h.setStateSprites(l,o)):h.setStateSprites(l)):(l.name=this.normal_face,(n=u.NewCenteredSprite(e,t,i)).name=this.over_face,n.scale.setTo(1.05,1.05),(r=u.NewCenteredSprite(e,t,i)).name=this.down_face,r.scale.setTo(.95,.95),(a=u.NewCenteredSprite(e,t,i)).name=this.disabled_face,h.SetStates(l,n,r,a)),h},u.NewSoundButton=function(e,t,i,n,s){var a=new d.SoundButton(e,0,0,n=void 0===n?!1:n),i=(a.OnClick().add(function(){return d.AudioManager.playSound(Sounds.buttonClick)}),u.NewCenteredSprite(e,t,i)),t=u.NewCenteredSprite(e,t,s);return n&&(s=e.add.tween(a.scale).to({x:1,y:1},50,Phaser.Easing.Linear.None),n=e.add.tween(a.scale).to({x:1.1,y:1.1},50,Phaser.Easing.Linear.None),e=e.add.tween(a.scale).to({x:.9,y:.9},50,Phaser.Easing.Linear.None),a.setTweens(s,n,e)),a.setupToggleSprites(i,t),a},u.GetChildByName=function(e,t){if(null!=e)for(var i=0,n=e.children;i<n.length;i++){var s=n[i];if(s.name==t)return s}return null},u.GetSpriteByName=function(e,t){return u.GetChildByName(e,t)},u.GetTextByName=function(e,t){return u.GetChildByName(e,t)},u.SetChildsAlpha=function(e,t){for(var i=0,n=e.children;i<n.length;i++)n[i].alpha=t},u.SetTextByName=function(e,t,i){e=u.GetChildByName(e,t);null!=e&&(e.text=i)},u.SetAlphaByName=function(e,t,i){e=u.GetChildByName(e,t);null!=e&&(e.alpha=i)},u.SetButtonText=function(e,t,i){u.SetTextByName(u.GetSpriteByName(e,u.normal_face),t,i),u.SetTextByName(u.GetSpriteByName(e,u.over_face),t,i),u.SetTextByName(u.GetSpriteByName(e,u.down_face),t,i),u.SetTextByName(u.GetSpriteByName(e,u.disabled_face),t,i)},u.SetButtonAlpha=function(e,t,i){u.SetAlphaByName(u.GetSpriteByName(e,u.normal_face),t,i),u.SetAlphaByName(u.GetSpriteByName(e,u.over_face),t,i),u.SetAlphaByName(u.GetSpriteByName(e,u.down_face),t,i),u.SetAlphaByName(u.GetSpriteByName(e,u.disabled_face),t,i)},u.SetDefaultValues=function(e,t){for(var i in e)console.log(i),"object"!=typeof e[i]||Array.isArray(e[i])?null==t[i]&&(t[i]=e[i]):(null==t[i]&&(t[i]={}),this.SetDefaultValues(e[i],t[i]))},u.fitTextToBounds=function(e,t,i){t=this.getTextScale(e,t,i),t=Phaser.Math.clamp(t,0,1);return e.scale.set(t,t),t},u.getTextScale=function(e,t,i){var n=e.width,e=e.height;return Math.min(t/n,i/e)},u.kShowedAdCoinsReward=50,u.normal_face="__normal",u.over_face="__over",u.down_face="__down",u.disabled_face="__disabled",u.kSaveId="ButterflyKyodai",u.save_=null,d.Hlp=u,(e=i=d.AwardType||(d.AwardType={}))[e.kNone=1]="kNone",e[e.kCoins=2]="kCoins",e[e.kFrezes=3]="kFrezes",e[e.kResets=4]="kResets",e[e.kHints=5]="kHints";var t=function(e,t){this.type=i.kNone,this.amount=0,this.type=e,this.amount=t};d.Award=t}(ButterflyKyodai=ButterflyKyodai||{}),function(e){(t=a=a||{})[t.kNormal=1]="kNormal",t[t.kOver=2]="kOver",t[t.kDown=3]="kDown",t[t.kDisabled=4]="kDisabled",o=Phaser.Sprite,__extends(i,o),i.prototype.SetStates=function(e,t,i,n){this.removeChildren(),this.normal_=e,null!=this.normal_&&this.addChild(this.normal_),this.over_=t,null!=this.over_&&this.addChild(this.over_),this.down_=i,null!=this.down_&&this.addChild(this.down_),this.disabled_=n,null!=this.disabled_&&this.addChild(this.disabled_),this.UpdateState()},i.prototype.setTweens=function(e,t,i){this.normalTween=e,this.overTween=t,this.downTween=i},i.prototype.setStateSprites=function(e,t){this.normalSprite=e,null!=t&&(this.disabledSprite=t,this.disabledSprite.alpha=0,this.addChild(this.disabledSprite)),this.addChild(this.normalSprite)},i.prototype.disabled=function(){return this.state_==a.kDisabled},i.prototype.set_disabled=function(e){this.state_=e?a.kDisabled:a.kNormal,this.set_input_disabled(e),this.useTween?this.updateTweenState():this.UpdateState()},i.prototype.input_disabled=function(){return!this.inputEnabled},i.prototype.set_input_disabled=function(e){e?this.inputEnabled=!1:(this.inputEnabled=!0,this.input.useHandCursor=!0)},i.prototype.state=function(){return this.state_},i.prototype.OnClick=function(){return this.on_click_},i.prototype.destroy=function(e){this.on_click_.dispose(),this.on_click_=null,o.prototype.destroy.call(this,e)},i.prototype.updateTweenState=function(){switch(null!=this.normalSprite&&(this.normalSprite.alpha=0),null!=this.disabledSprite&&(this.disabledSprite.alpha=0),this.state_){case a.kNormal:this.normalTween.start(),null!=this.normalSprite&&(this.normalSprite.alpha=1);break;case a.kOver:this.overTween.start(),null!=this.normalSprite&&(this.normalSprite.alpha=1);break;case a.kDown:this.downTween.start(),null!=this.normalSprite&&(this.normalSprite.alpha=1);break;case a.kDisabled:this.downTween.start(),null!=this.disabledSprite&&(this.disabledSprite.alpha=1)}},i.prototype.SetState=function(e){this.state_!=a.kDisabled&&(e==a.kDisabled?this.state_=e:this.over_on_?this.down_on_?this.state_=a.kDown:this.state_=a.kOver:this.state_=a.kNormal)},i.prototype.UpdateState=function(){null!=this.normal_&&(this.normal_.alpha=0),null!=this.over_&&(this.over_.alpha=0),null!=this.down_&&(this.down_.alpha=0),null!=this.disabled_&&(this.disabled_.alpha=0);var e=null;switch(this.state_){case a.kNormal:e=this.normal_;break;case a.kOver:e=this.over_;break;case a.kDown:e=this.down_;break;case a.kDisabled:e=this.disabled_}null!=e&&(e.alpha=1)};var a,o,t=i;function i(e,t,i,n){void 0===n&&(n=!1);var s=o.call(this,e,t=void 0===t?0:t,i=void 0===i?0:i)||this;return s.useTween=!1,s.on_click_=new Phaser.Signal,s.normal_=null,s.over_=null,s.down_=null,s.disabled_=null,s.down_on_=!1,s.over_on_=!1,s.state_=a.kNormal,s.anchor.setTo(.5,.5),s.inputEnabled=!0,s.input.useHandCursor=!0,s.useTween=n,s.events.onInputOver.add(function(){s.over_on_=!0,s.SetState(a.kOver),n?s.updateTweenState():s.UpdateState()}),s.events.onInputOut.add(function(){s.over_on_=!1,s.SetState(a.kNormal),n?s.updateTweenState():s.UpdateState()}),s.events.onInputDown.add(function(){s.down_on_=!0,s.SetState(a.kDown),n?s.updateTweenState():s.UpdateState()}),s.events.onInputUp.add(function(){s.down_on_=!1,s.over_on_&&s.state_!=a.kDisabled&&s.on_click_.dispatch(),s.SetState(a.kNormal),n?s.updateTweenState():s.UpdateState()}),s}e.Button=t}(ButterflyKyodai=ButterflyKyodai||{}),function(i){function n(){}n.loadScores=function(){var e=i.Hlp.loadScores();if(null!==e)try{this.SCORES=JSON.parse(e)}catch(e){}},n.saveScore=function(e,t){n.loadScores(),n.SCORES.push({name:e,score:t}),n.SCORES.sort(function(e,t){return e.score<t.score?1:e.score>t.score?-1:0}),10<n.SCORES.length&&(n.SCORES.length=10),i.Hlp.SaveScores(n.SCORES)},n.SCORES=[],i.GameScores=n}(ButterflyKyodai=ButterflyKyodai||{}),function(s){a=Fabrique.ResponsiveGroup,__extends(t,a),t.prototype.resize=function(){this.background&&this.game&&this.noAdsTxt&&this.returnTxt&&this.playAgainBtn&&(this.background.clear(),this.background.beginFill(0),this.background.drawRect(0,-this.game.height,this.game.width,this.game.height),this.background.endFill(),this.background.y=this.game.height,this.noAdsTxt.x=this.game.width/2,this.noAdsTxt.y=this.game.height/2,this.returnTxt.x=this.game.width/2,this.returnTxt.y=this.game.height/2+110,this.playAgainBtn.x=this.game.width/2,this.playAgainBtn.y=this.game.height/3)},t.prototype.removeGroup=function(){this.playAgain.removeAll(),console.log("Dispatching remove"),this.destroy()};var a,e=t;function t(e,t,i){var n=a.call(this,e,null,"NextLevelGroup")||this,e=(n.portrait=!1,n.noAdsTxt=null,n.returnTxt=null,n.playAgainTxt=null,n.playAgainBtn=null,n.playAgain=new Phaser.Signal,n.setPinned(Fabrique.PinnedPosition.middleCenter,0,0),n.game=e,n.nextLevelCloseSignal=t,n.portrait=i,n.background=n.game.add.graphics(0,0),n.background.beginFill(0),n.background.drawRect(-n.game.width,-n.game.height,2*n.game.width,2*n.game.height),n.background.endFill(),n.add(n.background),new Phaser.Image(n.game,0,0,Images.GameOverImage)),t=(e.inputEnabled=!0,e.anchor.set(.5,.5),e.scale.set(1.1,1.1),n.add(e),Fabrique.LocalizationHandler.getInstance().getValue("no_ads"));n.noAdsTxt=new Phaser.Text(n.game,0,-130,t,{font:"34px 'Noto Sans Bold'",fill:"#0000ff"}),n.noAdsTxt.anchor.setTo(.5,.5),n.add(n.noAdsTxt),t=Fabrique.LocalizationHandler.getInstance().getValue("try_later"),n.returnTxt=new Phaser.Text(n.game,0,-20,t,{font:"28px 'Noto Sans Bold'",fill:"#336600",align:"center"}),n.returnTxt.anchor.setTo(.5,.5),n.add(n.returnTxt),n.playAgainBtn=s.Hlp.ButtonLikeOld(n.game,Atlases.kGui_2,"claim"),n.playAgainBtn.position.setTo(0,170),n.playAgainBtn.OnClick().add(function(){n.playAgain.dispatch(),n.nextLevelCloseSignal.dispatch(),n.removeGroup()},n),n.add(n.playAgainBtn),t=Fabrique.LocalizationHandler.getInstance().getValue("play_again_btn");return n.playAgainTxt=new Phaser.Text(n.game,0,172,t,{font:"20px 'Noto Sans Bold'",fill:"#013e65"}),n.playAgainTxt.anchor.setTo(.5,.5),n.playAgainTxt.smoothed=!0,n.add(n.playAgainTxt),n.game.scale.onSizeChange.add(function(){n.resize()},n),n}s.NoAdsContainer=e}(ButterflyKyodai=ButterflyKyodai||{}),function(a){o=Fabrique.ResponsiveGroup,__extends(t,o),t.prototype.buildStage=function(){this.bgBlurImage=this.game.make.graphics(0,0),this.bgBlurImage.beginFill(0),this.bgBlurImage.drawRect(-450,-10,this.game.width,this.game.height),this.bgBlurImage.alpha=.7,this.add(this.bgBlurImage),this.backgroundBorder=this.game.make.graphics(0,0),this.backgroundBorder.beginFill(this.bgBorderColor),this.backgroundBorder.drawRect(0,0,576,680),this.add(this.backgroundBorder),this.background=this.game.make.graphics(0,0),this.background.beginFill(this.bgColor),this.background.drawRect(9,9,556,660),this.add(this.background);var e;this.topTenText=this.game.add.text(200,25,"Top Ten",{font:"bold 60px 'DS Marker Felt'",fill:"#00ccff",boundsAlignH:"left",boundsAlignV:"middle"},this),this.closeButtonImage=this.game.make.graphics(0,0),this.closeButtonImage.beginFill(52479),this.closeButtonImage.drawCircle(535,40,40),this.add(this.closeButtonImage);for(this.closeButtonText=this.game.add.text(528,23,"X",{font:"bold 25px 'DS Marker Felt'",fill:"#000000",boundsAlignH:"left",boundsAlignV:"middle"},this),this.closeButtonHitArea=this.game.add.button(530,15,"button",void 0,void 0,void 0,void 0,void 0,void 0,this),this.closeButtonHitArea.input.priorityID=5,this.closeButtonHitArea.width=30,this.closeButtonHitArea.alpha=0,this.closeButtonHitArea.events.onInputDown.add(this.removeGroup,this),e=0;e<10&&e<a.GameScores.SCORES.length;e++){var t={font:"bold 28px Tahoma",fill:"#ffffff",boundsAlignH:"left",boundsAlignV:"middle"},t=(this.game.add.text(55,140+48*e,a.GameScores.SCORES[e].name,t,this),this.game.add.text(520,140+48*e,a.GameScores.SCORES[e].score.toString(),t,this));t.x-=t.width}},t.prototype.removeGroup=function(){this.callback(this),this.destroy()};var o,e=t;function t(e,t,i,n,s){e=o.call(this,e,null,"top10list",!0)||this;return e.bgColor=0,e.bgBorderColor=16711782,e.setPinned(n,t,i),e.pivot.set(288,344),e.callback=s,a.GameScores.loadScores(),e.buildStage(),e}a.Top10List=e}(ButterflyKyodai=ButterflyKyodai||{}),function(e){function t(e,t){this.game=e,this.parentGroup=t}t.prototype.startParticle=function(e,t,i,n){this.emitterOnConnected.width=i,this.emitterOnConnected.height=n,this.emitterOnConnected.emitX=e,this.emitterOnConnected.emitY=t,this.emitterOnConnected.explode(this.emitterOnConnected.lifespan,15)},t.prototype.createParticleOnButterflyConnected=function(){this.emitterOnConnected=this.game.add.emitter(this.game.world.centerX,this.game.world.centerY,100),this.emitterOnConnected.makeParticles(Atlases.game_scene_ui,"particle_star_outline.png"),this.emitterOnConnected.setAlpha(1,0,this.emitterOnConnected.lifespan,Phaser.Easing.Linear.None),this.emitterOnConnected.setYSpeed(-100,100),this.emitterOnConnected.setXSpeed(-100,100),this.emitterOnConnected.gravity=0,this.emitterOnConnected.setScale(.7,1,.7,1,this.emitterOnConnected.lifespan,Phaser.Easing.Linear.None),this.parentGroup.add(this.emitterOnConnected)},t.prototype.playDustParicle=function(){this.dustEmitter=this.game.add.emitter(this.game.world.centerX,this.game.world.centerY,150),this.dustEmitter.lifespan=5e3,this.dustEmitter.makeParticles(Images.dustParticle),this.dustEmitter.gravity=0,this.dustEmitter.setAlpha(0,1,this.dustEmitter.lifespan,Phaser.Easing.Linear.None,!0),this.dustEmitter.minParticleScale=.3,this.dustEmitter.maxParticleScale=.8,this.dustEmitter.setYSpeed(-50,50),this.dustEmitter.setXSpeed(-50,50),this.dustEmitter.width=this.game.world.width,this.dustEmitter.height=this.game.world.height,this.dustEmitter.start(!1,this.dustEmitter.lifespan,60)},t.prototype.updateDustBounds=function(){this.dustEmitter.width=this.game.width,this.dustEmitter.height=this.game.height,this.dustEmitter.emitX=this.game.width/2,this.dustEmitter.emitY=this.game.height/2},e.ParticleManager=t}(ButterflyKyodai=ButterflyKyodai||{}),function(m){var i,n=Fabrique.Timer,e=(i=Fabrique.State,__extends(E,i),E.prototype.init=function(){var e,t=this;0===Constants.CURRENT_LEVEL&&(e=m.Hlp.Load(),Constants.CURRENT_FREEZES=1,Constants.CURRENT_RESETS=1,Constants.CURRENT_HINTS=1,Constants.CURRENT_LEVEL=1,Constants.CURRENT_CONTINUES=1,Constants.CURRENT_SCORE=0,Constants.CURRENT_VIDEO_HINTS=1,Constants.CURRENT_VIDEO_RESETS=1,Constants.CURRENT_VIDEO_FREEZES=1,this.isTutorialCompleted=e.isTutorialCompleted),this.checkLayoutMode(),this.game.input.maxPointers=1,this.backend=new Backend(function(e){return t.handleGameMove(e)}),AzerionIntegration.GameEvents.sendEvent(AzerionIntegration.GameEventType.LEVEL_START,"00"+Constants.CURRENT_LEVEL)},E.prototype.checkLayoutMode=function(){this.game.device.desktop||(this.game.height>this.game.width?this.isPortraitMode=!0:this.isPortraitMode=!1)},E.prototype.resize=function(){this.isGameResized=!0,this.checkLayoutMode(),this.butterflyHolder&&this.butterflyHolder.removeAll(!0,!0),this.placeTiles(this.lastReceivedTiles),this.gameOverPopUp&&(this.isPortraitMode?this.scaleImagePercentage(this.gameOverPopUp,26.5,!1):this.scaleImagePercentage(this.gameOverPopUp,27.6,!0)),this.isGameResized=!1},E.prototype.scaleImage=function(e,t,i){var n;void 0===i&&(i=!1),this.game.device.desktop&&!i||(e.scale.set(1,1),i=this.game.width/(e.width+t),n=this.game.height/(e.height+t),this.isPortraitMode&&(i=this.game.width/(e.height+t),n=this.game.height/(e.width+t)),i<n?e.scale.set(i,i):e.scale.set(n,n))},E.prototype.scaleImagePercentage=function(e,t,i,n){var s;void 0===n&&(n=!1),this.game.device.desktop&&!n||(e.scale.setTo(1,1),i?(s=this.game.width*t/100/e.width,e.height*s>this.game.height&&(s=(this.game.height-10)/e.height)):(s=this.game.height*t/100/e.height,e.width*s>this.game.width&&(s=(this.game.width-10)/e.width)),e.scale.setTo(s,s))},E.prototype.create=function(){var t=this;i.prototype.create.call(this);2<=m.Hlp.Load().current_wings&&(this.isWingsAdditionalPackSelected=!0,this.currentWingsPackKeyFly=Atlases.wingsFlyPack,this.currentWingsPackKeyIdle=Atlases.wingsIdlePack),this.backgroundHolder=this.game.add.responsiveGroup(null,"backgroundHolder",!0),this.game.add.existing(this.backgroundHolder),this.GUITopHolder=this.game.add.responsiveGroup(null,"GUITopHolder",!0),this.GUIBottomGroup=this.game.add.responsiveGroup(null,"GUIBottomHolder",!0),this.fieldHolder=this.game.add.responsiveGroup(null,"fieldHolder",!0),this.fieldHolder.setPinned(Fabrique.PinnedPosition.middleCenter,0,0);var e=Backend.NUMBER_OF_TILES/Backend.NUMBER_OF_ROWS+2;this.tileHolder=new Phaser.Group(this.game,null,"tileHolder"),this.tileHolder.x=-E.TILE_WIDTH*e/2,this.tileHolder.y=-(E.TILE_HEIGHT*(Backend.NUMBER_OF_ROWS+2))/2,this.fieldHolder.add(this.tileHolder),this.tileParticlesHolder=new Phaser.Group(this.game,null,"tileParticlesHolder"),this.tileParticlesHolder.x=-E.TILE_WIDTH*e/2,this.tileParticlesHolder.y=-(E.TILE_HEIGHT*(Backend.NUMBER_OF_ROWS+2))/2,this.fieldHolder.add(this.tileParticlesHolder),this.particleManager=new m.ParticleManager(this.game,this.tileParticlesHolder),this.particleManager.createParticleOnButterflyConnected(),this.particleManager.playDustParicle(),this.game.add.existing(this.fieldHolder),this.game.add.existing(this.GUIBottomGroup),this.game.add.existing(this.GUITopHolder),this.tileOutlineHolder=new Phaser.Group(this.game,null,"tileOutlineHolder"),this.tileOutlineHolder.x=this.tileHolder.x,this.tileOutlineHolder.y=this.tileHolder.y,this.fieldHolder.add(this.tileOutlineHolder),this.selectionHolder=new Phaser.Group(this.game,null,"selectionHolder"),this.selectionHolder.x=this.tileHolder.x,this.selectionHolder.y=this.tileHolder.y,this.fieldHolder.add(this.selectionHolder),this.lineHolder=new Phaser.Group(this.game,null,"lineHolder"),this.lineHolder.x=this.tileHolder.x,this.lineHolder.y=this.tileHolder.y,this.lineHolder.x+=E.TILE_WIDTH/2,this.lineHolder.y+=E.TILE_WIDTH/2,this.fieldHolder.add(this.lineHolder),this.butterflyConnectGroup=new Phaser.Group(this.game,null,"butterflyConnectGroup"),this.butterflyConnectGroup.x=this.tileHolder.x,this.butterflyConnectGroup.y=this.tileHolder.y,this.fieldHolder.add(this.butterflyConnectGroup),this.butterFlyConnect=new Phaser.Group(this.game,null,"butterFlyConnect"),this.butterflyConnectGroup.add(this.butterFlyConnect),this.butterflyHolder=new Phaser.Group(this.game,null,"butterflyHolder"),this.butterflyHolder.x=this.tileHolder.x,this.butterflyHolder.y=this.tileHolder.y,this.fieldHolder.add(this.butterflyHolder),this.shuffleHolder=this.game.add.group(this,"shuffleHolder",!0),this.game.add.existing(this.shuffleHolder),this.prevTime=Date.now(),this.fieldHolder.alpha=1,this.setupGui(),this.setupBottomUI(),this.setupUppperUI(),this.closePauseSignal=new Phaser.Signal,this.closePauseSignal.add(function(){t.onClickResume()}),this.nextLevelSignal=new Phaser.Signal,this.nextLevelSignal.add(function(e){t.nextLevelTimeout(),e&&t.goMidRollAd(AzerionIntegration.IntegrationEvents.NEXT_LEVEL),t.DisableAllInput(!1)}),this.gameOverSignal=new Phaser.Signal,this.gameOverSignal.add(function(){t.goGameOver(),t.goToMainMenu(),console.log("goToMainMenu---")}),this.noAdsSignal=new Phaser.Signal,this.backend.handleGameMove({call:"init"}),Fabrique.PauseHandler.getInstance().onPauseCallback.add(this.onBlurPause,this),Fabrique.PauseHandler.getInstance().onResumeCallback.add(function(){t.isRealPause||t.onClickResume()},this),this.isTutorialCompleted||(this.hintButton.set_disabled(!0),this.game.time.events.add(2e3,function(){m.AudioManager.playSound(Sounds.hintShuffleFreeze),t.backend.handleGameMove({call:"showHint",isTutorial:!0}),t.tutorialHintsNumber--}))},E.prototype.resumeState=function(){this.game.onResume.dispatch(),this.game.tweens.resumeAll()},E.prototype.goMidRollAd=function(e){var t=this;this.game.camera.fade(0,200),Fabrique.AdHandler.getInstance().showAd(e,function(){t.game.camera.resetFX(),t.nextLevelTimeout()})},E.prototype.setupGui=function(){this.backgroundHolder.setPinned(Fabrique.PinnedPosition.middleCenter,0,0),this.backGround=new Fabrique.ResponsiveImage(this.game,0,0,Images.backGround),this.backGround.anchor.setTo(.5,.5),this.backGround.scale.set(1.05,1.06),this.backImageWidth=this.backGround.width,this.backImageHeight=this.backImageHeight,this.backgroundHolder.add(this.backGround),this.backImage=new Fabrique.ResponsiveImage(this.game,0,0,Images.MenuBackImage),this.backImage.anchor.setTo(.5,.5),this.backgroundHolder.sendToBack(this.backGround),this.topGroup=this.game.add.group(null,"top_grp",!0)},E.prototype.setupUppperUI=function(){var e=this,t=(this.pauseButton=m.Hlp.NewButtonBitmapScaling(this.game,Atlases.game_scene_ui,SpriteNames.PAUSE_BUTTON,!0),this.pauseButton.position.x=490,this.pauseButton.anchor.set(.5,.5),this.GUITopHolder.add(this.pauseButton),this.pauseButton.OnClick().add(function(){return e.onClickPause(!0)},this),this.storeButton=m.Hlp.NewButtonBitmapScaling(this.game,Atlases.game_scene_ui,SpriteNames.STORE_BUTTON,!0),this.storeButton.position.x=380,this.storeButton.anchor.set(.5,.5),this.GUITopHolder.add(this.storeButton),Fabrique.LocalizationHandler.getInstance().getValue("store")),t=new Phaser.Text(this.game,0,0,t,{font:"30px 'Balsamiq Sans Bold'",fill:"#ffffff",align:"center"});t.position.x=this.storeButton.position.x,t.position.y=this.storeButton.position.y,t.position.y+=54,t.anchor.setTo(.5,.5),this.GUITopHolder.add(t),this.storeButton.OnClick().add(function(){e.isPause||(e.isPause=!0,e.DisableAllInput(!0),e.store=new m.Store(e.game,function(){Fabrique.AdHandler.getInstance().showAd(AzerionIntegration.IntegrationEvents.EXIT_SHOP_FROM_GAME,function(){e.store.destroy(),e.store=null,e.UpdateGraphics(),e.isPause=!1,e.DisableAllInput(!1)})},SpriteNames.STORE_BACKGROUND),e.topGroup.addChild(e.store))},this),this.soundButton=m.Hlp.NewSoundButton(this.game,Atlases.game_scene_ui,SpriteNames.SOUND_BUTTON_ON,!0,SpriteNames.SOUND_BUTTON_OFF),this.soundButton.position.x=272,this.soundButton.position.y=-8,this.soundButton.anchor.set(.5,.5),this.GUITopHolder.add(this.soundButton),this.scoreCounterSprite=new Phaser.Sprite(this.game,0,0,Atlases.game_scene_ui,SpriteNames.SCORE_COUNTER),this.scoreCounterSprite.anchor.set(.5,.5),this.scoreCounterSprite.position.set(40,-10),this.scoreCounterText=new Phaser.Text(this.game,0,0,Constants.CURRENT_SCORE.toString(),{font:"30px 'Balsamiq Sans Bold'",fill:"#ffffff",align:"center"}),this.scoreCounterText.anchor.set(.5,.5),this.scoreCounterText.position.set(10,2),this.scoreCounterSprite.addChild(this.scoreCounterText),this.scoreCounterStar=new Phaser.Sprite(this.game,0,0,Atlases.game_scene_ui,SpriteNames.SCORE_COUNTER_STAR),this.scoreCounterStar.anchor.set(.5,.5),this.scoreCounterText.addChild(this.scoreCounterStar),this.scoreCounterStar.position.set(-80,-5),this.GUITopHolder.add(this.scoreCounterSprite),this.gameTimer=new n(this.game,E.MAX_TIME),this.gameTimer.setPinned(Fabrique.PinnedPosition.topLeft,-540,-53),this.GUITopHolder.add(this.gameTimer)},E.prototype.setupBottomUI=function(){this.freezeButton=m.Hlp.NewButtonBitmapScaling(this.game,Atlases.game_scene_ui,SpriteNames.FREEZE_BUTTON,!0,SpriteNames.FREEZE_BUTTON_PASSIVE),this.freezeButton.position.set(-140,0),this.freezeButtonDotSprite=new Phaser.Sprite(this.game,0,0,Atlases.game_scene_ui,SpriteNames.FREEZE_BUTTON_DOT),this.freezeButtonDotSprite.anchor.set(0,1),this.freezeButtonDotSprite.position.x=24,this.freezeButtonDotSprite.position.y=-12,this.freezeButton.addChild(this.freezeButtonDotSprite),this.GUIBottomGroup.add(this.freezeButton),this.freezeNumberText=new Phaser.Text(this.game,0,0,Constants.CURRENT_FREEZES.toString(),{font:"24px 'Balsamiq Sans Bold'",fill:"#3A55B5"}),this.freezeNumberText.text="6",this.freezeNumberText.anchor.setTo(.5,.5),this.freezeNumberText.position.x=44,this.freezeNumberText.position.y=-32,this.freezeButton.addChild(this.freezeNumberText);for(var e=Fabrique.LocalizationHandler.getInstance().getValue("freeze"),t=new Phaser.Text(this.game,0,0,e,{font:"30px 'Balsamiq Sans Bold'",fill:"#ffffff",align:"center"}),i=(t.position.x=this.freezeButton.position.x,t.position.y=this.freezeButton.position.y,t.position.y+=54,t.anchor.setTo(.5,.5),this.GUIBottomGroup.add(t),this.freezeButton.OnClick().add(this.Freeze,this),this.freezeButton.OnClick().add(function(){return m.AudioManager.playSound(Sounds.hintShuffleFreeze)},this),this.hintButton=m.Hlp.NewButtonBitmapScaling(this.game,Atlases.game_scene_ui,SpriteNames.HINT_BUTTON,!0,SpriteNames.HINT_BUTTON_PASSIVE),this.hintButton.position.set(0,0),this.hintButtonDotSprite=new Phaser.Sprite(this.game,0,0,Atlases.game_scene_ui,SpriteNames.HINT_BUTTON_DOT),this.hintButtonDotSprite.anchor.set(0,1),this.hintButtonDotSprite.position.x=24,this.hintButtonDotSprite.position.y=-12,this.hintButton.addChild(this.hintButtonDotSprite),this.GUIBottomGroup.add(this.hintButton),this.hintNumberText=new Phaser.Text(this.game,0,0,Constants.CURRENT_HINTS.toString(),{font:"24px 'Balsamiq Sans Bold'",fill:"#317D3A"}),this.hintNumberText.text="6",this.hintNumberText.anchor.setTo(.5,.5),this.hintNumberText.position.x=44,this.hintNumberText.position.y=-32,this.hintButton.addChild(this.hintNumberText),e=Fabrique.LocalizationHandler.getInstance().getValue("hint"),new Phaser.Text(this.game,0,0,e,{font:"30px 'Balsamiq Sans Bold'",fill:"#ffffff",align:"center"})),e=(i.position.x=this.hintButton.position.x,i.position.y=this.hintButton.position.y,i.position.y+=54,i.anchor.setTo(.5,.5),this.GUIBottomGroup.add(i),this.hintButton.OnClick().add(this.hintPressed,this),this.hintButton.OnClick().add(function(){return m.AudioManager.playSound(Sounds.hintShuffleFreeze)},this),this.shuffleButton=m.Hlp.NewButtonBitmapScaling(this.game,Atlases.game_scene_ui,SpriteNames.SHUFFLE_BUTTON,!0,SpriteNames.SHUFFLE_BUTTON_PASSIVE),this.shuffleButton.position.set(140,0),this.shuffleButtonDotSprite=new Phaser.Sprite(this.game,0,0,Atlases.game_scene_ui,SpriteNames.SHUFFLE_BUTTON_DOT),this.shuffleButtonDotSprite.anchor.set(0,1),this.shuffleButtonDotSprite.position.x=24,this.shuffleButtonDotSprite.position.y=-12,this.GUIBottomGroup.add(this.shuffleButton),this.shuffleButton.addChild(this.shuffleButtonDotSprite),this.shuffleNumberText=new Phaser.Text(this.game,0,0,Constants.CURRENT_RESETS.toString(),{font:"24px 'Balsamiq Sans Bold'",fill:"#E04F00"}),this.shuffleNumberText.text="6",this.shuffleNumberText.anchor.setTo(.5,.5),this.shuffleNumberText.position.x=44,this.shuffleNumberText.position.y=-32,this.shuffleButton.addChild(this.shuffleNumberText),e=Fabrique.LocalizationHandler.getInstance().getValue("shuffle"),new Phaser.Text(this.game,0,0,e,{font:"30px 'Balsamiq Sans Bold'",fill:"#ffffff",align:"center"})),n=(e.position.x=this.shuffleButton.position.x,e.position.y=this.shuffleButton.position.y,e.position.y+=54,e.anchor.setTo(.5,.5),this.GUIBottomGroup.add(e),[i,e,t]),s=i.width,a=i,o=1;o<n.length;o++){var r=n[o];r.width>s&&(s=r.width,a=r)}var h=m.Hlp.getTextScale(a,150,88),h=Phaser.Math.clamp(h,0,1);e.scale.set(h,h),i.scale.set(h,h),t.scale.set(h,h),this.shuffleButton.OnClick().add(this.makeShufle,this),this.shuffleButton.OnClick().add(function(){return m.AudioManager.playSound(Sounds.hintShuffleFreeze)},this)},E.prototype.onClickPause=function(e){var t=this;this.isPause||this.isGameOver||this.isNextLevel||(this.isPause=!this.isPause,this.isRealPause=e,this.deselectTile(),this.backend.handleGameMove({call:"diselect"}),this.toggleTiles(!this.isPause),e&&(this.pausePopUp=new m.PopUpPause(this.game,function(){Fabrique.AdHandler.getInstance().showAd(AzerionIntegration.IntegrationEvents.RESUME_GAME,function(){return t.onClickResume()})},e),this.pausePopUp.quitSignal.add(function(){t.isPause=!1,t.goToMainMenu()}),this.game.add.existing(this.pausePopUp),this.game.world.bringToTop(this.pausePopUp),this.hintButton.set_input_disabled(!0),this.pauseButton.set_input_disabled(!0),this.storeButton.set_input_disabled(!0),this.freezeButton.set_input_disabled(!0),this.shuffleButton.inputEnabled=!1))},E.prototype.onBlurPause=function(){this.isPause||this.onClickPause(!1)},E.prototype.onClickResume=function(){this.isGameOver||this.isNextLevel||(this.isPause=!1,this.isRealPause=!1,this.toggleTiles(!this.isPause),this.prevTime=Date.now(),this.storeButton.set_input_disabled(!1),this.pauseButton.set_input_disabled(!1),this.freezeButton.set_input_disabled(!1),this.hintButton.set_input_disabled(!1),this.shuffleButton.set_input_disabled(!1),this.isNextLevel=!1,this.soundButton.updateState(),this.pausePopUp&&(this.pausePopUp.removeAll(!0,!0),this.pausePopUp.destroy(!0)))},E.prototype.goToMainMenu=function(){AzerionIntegration.GameEvents.sendEvent(AzerionIntegration.GameEventType.LEVEL_FAIL,"00"+Constants.CURRENT_LEVEL),Constants.CURRENT_LEVEL=0,this.game.onPause.removeAll(this),this.game.onResume.removeAll(this),this.game.state.start(m.Menu.Name,!0,!1),null!=this.selectedTile&&this.deselectTile()},E.prototype.toggleSound=function(){this.game.sound.mute?(this.game.sound.mute=!1,this.soundBtn.getChildAt(0).alpha=0):(this.game.sound.mute=!0,this.soundBtn.getChildAt(0).alpha=1)},E.prototype.updateAfterHintReward=function(){this.isPause=!this.isPause,++Constants.CURRENT_HINTS,--Constants.CURRENT_VIDEO_HINTS,AzerionIntegration.GameEvents.sendEvent(AzerionIntegration.GameEventType.REWARD_AFTER_AD,"hint"),this.backend.handleGameMove({call:"showHint"})},E.prototype.hintPressed=function(){var e=this;this.isPause||this.isGameOver||(0==Constants.CURRENT_HINTS&&0<Constants.CURRENT_VIDEO_HINTS?(this.isPause=!this.isPause,Fabrique.AdHandler.getInstance().showRewardedAd(AzerionIntegration.IntegrationEvents.CLAIM_HINT,function(){return e.updateAfterHintReward()},function(){return e.adFailed()})):(AzerionIntegration.GameEvents.sendEvent(AzerionIntegration.GameEventType.USE_BOOSTER,"hint"),this.backend.handleGameMove({call:"showHint"})))},E.prototype.MakeRealFreeze=function(){--Constants.CURRENT_FREEZES,this.freeze_counter_=E.FREEZE_TIME,this.gameTimer.SetFreezeShow(!0),this.updateFreezesNumber(),this.freezeButton.set_disabled(!0)},E.prototype.updateAfterFreezeReward=function(){this.isPause=!this.isPause,++Constants.CURRENT_FREEZES,--Constants.CURRENT_VIDEO_FREEZES,AzerionIntegration.GameEvents.sendEvent(AzerionIntegration.GameEventType.REWARD_AFTER_AD,"booster__freeze"),this.MakeRealFreeze()},E.prototype.Freeze=function(){var e=this;this.isPause||this.isGameOver||0<this.freeze_counter_||(Constants.CURRENT_FREEZES<=0?0<Constants.CURRENT_VIDEO_FREEZES&&(this.isPause=!this.isPause,Fabrique.AdHandler.getInstance().showRewardedAd(AzerionIntegration.IntegrationEvents.CLAIM_FREEZE,function(){return e.updateAfterFreezeReward()},function(){return e.adFailed()})):(AzerionIntegration.GameEvents.sendEvent(AzerionIntegration.GameEventType.USE_BOOSTER,"freeze"),this.MakeRealFreeze()))},E.prototype.UpdateGraphics=function(){m.Hlp.UpdateCurrentBackground(),this.backGround.loadTexture(Images.backGround)},E.prototype.nextLevelTimeout=function(){this.updateLevelText(),this.game.state.restart(!0,!1),this.isPause=!1,this.toggleTiles(this.isPause),this.closePauseSignal.removeAll(this),this.nextLevelSignal.removeAll(this),this.gameOverSignal.removeAll(this),this.game.onPause.removeAll(this),this.game.onResume.removeAll(this)},E.prototype.updateLevelText=function(){this.gameTimer.stageNumber.text=Constants.CURRENT_LEVEL.toString()},E.prototype.moreGames=function(){h5branding.Branding.openCampaignLink("butterfly_kyodai",h5branding.UtmTargets.more_games)},E.prototype.updateHintsNumber=function(){this.hintNumberText.text=Constants.CURRENT_HINTS.toString(),0==Constants.CURRENT_HINTS&&(0<Constants.CURRENT_VIDEO_HINTS?this.hintNumberText.text="Ad":(this.hintButton.removeChild(this.hintNumberText),this.hintButton.removeChild(this.hintButtonDotSprite),this.hintButton.set_disabled(!0)))},E.prototype.updateResetsNumber=function(){this.shuffleNumberText.text=Constants.CURRENT_RESETS.toString(),0==Constants.CURRENT_RESETS&&(0<Constants.CURRENT_VIDEO_RESETS?this.shuffleNumberText.text="Ad":(this.shuffleButton.removeChild(this.shuffleNumberText),this.shuffleButton.removeChild(this.shuffleButtonDotSprite),this.shuffleButton.set_disabled(!0)))},E.prototype.updateFreezesNumber=function(){this.freezeNumberText.text=Constants.CURRENT_FREEZES.toString(),0==Constants.CURRENT_FREEZES&&(0<Constants.CURRENT_VIDEO_FREEZES?this.freezeNumberText.text="Ad":(this.freezeButton.removeChild(this.freezeNumberText),this.freezeButton.removeChild(this.freezeButtonDotSprite),this.freezeButton.set_disabled(!0)))},E.prototype.handleGameMove=function(e){var t,i=this,n=this.currentScore,s=(this.currentScore=e.score,this.currentScore!==this.previousScore&&(this.previousScore=this.currentScore,this.updateScoreText(this.currentScore,!0)),""!=e.levelName&&this.levelName&&(this.levelName.text=e.levelName),E.TILE_WIDTH/2),a=E.TILE_HEIGHT/2;switch(e.call){case"init":this.game.time.events.add(1e3,this.resetGameOver,this),this.isGameResized=!0,this.isNextLevel=!1,this.placeTiles(e.tiles),this.isGameResized=!1,this.updateHintsNumber(),this.updateResetsNumber(),this.updateFreezesNumber(),this.timeCount=E.MAX_TIME,this.prevTime=Date.now(),this.scoreCounterText&&this.updateScoreText(this.currentScore,!1),this.isLevelFinished=!1,this.isGameOver=!1,m.AudioManager.isPlaying(Sounds.themeMusic)||m.AudioManager.playSound(Sounds.themeMusic);break;case"tilesUpdated":this.hideHint(),this.updateResetsNumber();this.tileHolder.forEach(function(e){var t=i.game.add.tween(e.scale).to({x:0,y:0},200,Phaser.Easing.Circular.InOut,!0);t.onComplete.add(function(){t.stop(),t.pendingDelete=!0},i)},null),this.game.time.events.add(100,function(){i.placeTiles(e.tiles)},this);break;case"selectTile":this.selectTile(e.selectedTile);break;case"deselectTile":(this.hintImage1&&this.hintImage2&&this.hintImage1.visible&&!this.hintImage2.visible||this.hintImage1&&this.hintImage2&&!this.hintImage1.visible&&this.hintImage2.visible)&&(this.hintImage1.visible=!0,this.hintImage2.visible=!0);var o=e.selectedTiles[0],o=this.getPosFromGridPos(o.x,o.y),r=(this.wrongSelectionSprite1.position.x=o.x+s,this.wrongSelectionSprite1.position.y=o.y+a+10,this.wrongSelectionSprite1.visible=!0,this.game.add.tween(this.wrongSelectionSprite1.scale).to({x:1,y:1},200,Phaser.Easing.Linear.None,!0,0,0,!0).onComplete.add(function(){i.wrongSelectionSprite1.visible=!1}),e.selectedTiles[1]),r=this.getPosFromGridPos(r.x,r.y);this.wrongSelectionSprite2.position.x=r.x+s,this.wrongSelectionSprite2.position.y=r.y+a+10,this.wrongSelectionSprite2.visible=!0,this.game.add.tween(this.wrongSelectionSprite2.scale).to({x:1,y:1},200,Phaser.Easing.Linear.None,!0,0,0,!0).onComplete.add(function(){i.wrongSelectionSprite2.visible=!1}),this.deselectTile();break;case"connectTiles":this.drawConnectLine(e.connectingPath,e.tileRemoveArray,e.tiles),this.animateButterflyConnecting(e.tileRemoveArray),1!==e.tileRemoveArray[0].hintImageNumber&&2!==e.tileRemoveArray[0].hintImageNumber&&1!==e.tileRemoveArray[1].hintImageNumber&&2!==e.tileRemoveArray[1].hintImageNumber&&this.isTutorialCompleted||(e.tileRemoveArray[0].hintImageNumber=0,e.tileRemoveArray[1].hintImageNumber=0,this.hideHint()),this.deselectTile(),m.AudioManager.playSound(Sounds.butterflyFlap),this.currentScore=e.score,this.timeCount+=1.2,this.timeCount>E.MAX_TIME&&(this.timeCount=E.MAX_TIME);var o=this.getPosFromGridPos(e.tileRemoveArray[0].x,e.tileRemoveArray[0].y),r=this.getPosFromGridPos(e.tileRemoveArray[1].x,e.tileRemoveArray[1].y),h=E.TILE_WIDTH;this.particleManager.startParticle(o.x+s,o.y+a,h,h),this.particleManager.startParticle(r.x+s,r.y+a,h,h);break;case"showHint":0<e.hintTiles.length&&(this.showHint(e.hintTiles),this.deselectTile(),this.updateHintsNumber(),this.hintButton.set_disabled(!0));break;case"finishLevel":Constants.isGameOver||(Constants.isGameOver=!0,o=Math.round(this.timeCount/5),r=e.score-n,this.scoreSteps=Math.round(r/o),this.currentScore=e.score,this.isNextLevel=!0,this.DisableAllInput(!0),h=new m.PopUpNextLevel(this.game,this.nextLevelSignal),this.game.add.existing(h),this.game.world.bringToTop(h),this.isLevelFinished=!0,Constants.CURRENT_LEVEL+=1,Constants.CURRENT_FREEZES+=Constants.WIN_FREEZES,Constants.CURRENT_HINTS+=Constants.WIN_HINTS,Constants.CURRENT_RESETS+=Constants.WIN_SHUFFLES,Constants.CURRENT_CONTINUES=1,Constants.CURRENT_VIDEO_HINTS=1,Constants.CURRENT_VIDEO_RESETS=1,Constants.CURRENT_VIDEO_FREEZES=1,m.Hlp.Load().coins+=m.Hlp.GetLevelPassCoinsAward(Constants.CURRENT_LEVEL-1),console.log("Hints: "+Constants.CURRENT_HINTS,"   Resets: "+Constants.CURRENT_RESETS),this.removeLines(),this.butterflyHolder.removeAll(!0,!0),this.butterFlyConnect.removeAll(!0,!0),m.AudioManager.playSound(Sounds.levelCompleted));break;case"finishGame":this.isLevelFinished=!0}e.gameover&&!this.isGameOver&&(this.isGameOver=!0,m.AudioManager.stopSound(Sounds.themeMusic),e.complete?m.AudioManager.playSound(Sounds.levelCompleted):m.AudioManager.playSound(Sounds.levelLost),this.hideHint(),this.deselectTile(),this.DisableAllInput(!0),(t=new m.PopUpGameOver(this.game,this.gameOverSignal,this.isPortraitMode,e.score,e.timeOver,e.complete)).continue.add(function(){Constants.isGameOver=!1,i.isGameOver=!1,i.isLevelFinished=!1,--Constants.CURRENT_CONTINUES,i.timeCount+=E.REWARD_CONTINUE_TIME,i.timeCount>E.MAX_TIME&&(i.timeCount=E.MAX_TIME),console.log("this.timeCount",i.timeCount),i.backend.handleGameMove({call:"makeShufleWithoutReset"}),i.DisableAllInput(!1),m.AudioManager.isPlaying(Sounds.themeMusic)||m.AudioManager.playSound(Sounds.themeMusic)},this),this.game.add.existing(t))},E.prototype.DisableAllInput=function(e){this.shuffleButton.set_input_disabled(e),this.hintButton.set_input_disabled(e),this.pauseButton.set_input_disabled(e),this.storeButton.set_input_disabled(e),this.freezeButton.set_input_disabled(e),this.toggleTiles(!e)},E.prototype.resetGameOver=function(){Constants.isGameOver=!1},E.prototype.toggleTiles=function(t){this.tileHolder&&(this.isPause?this.tileHolder.forEach(function(e){null!=e.input&&(e.input.enabled=t)},null):this.isGameOver?this.tileHolder.forEach(function(e){null!=e.input&&(e.inputEnabled=t)},null):this.isPause||this.tileHolder.forEach(function(e){null!=e.input&&(e.input.enabled=t)},null))},E.prototype.placeTiles=function(e,t){var i,n,s=this;for(void 0===t&&(t=!0),this.isShuffled||m.AudioManager.playSound(Sounds.butterfliesAppearOnScreen),this.lastReceivedTiles=e,this.tileHolder.removeAll(!0),this.tileSpritesArray=[],i=0;i<e.length;i++)for(this.tileSpritesArray[i]=[],n=0;n<e[i].length;n++)this.tileSpritesArray[i][n]=null;var a,o,r,h,l=!1,t=(this.outline||(this.outline=this.game.add.graphics(0,0),l=!1),h=this.isShuffled?(r=50,200):(r=150,400),this.isPortraitMode?e[0].length*r:e.length*r);for(this.isInputBlocked=!0,this.game.time.events.add(t,function(){return s.isInputBlocked=!1},this),n=0;n<e[0].length;n++)for(i=0;i<e.length;i++)if(null!=(a=e[i][n].tile)&&a.suitId!=Backend.EMPTY_TILE_ID){var d=void 0,d=this.isWingsAdditionalPackSelected&&a.suitId>this.defaultWingsNumber?this.game.add.sprite(0,0,this.currentWingsPackKeyIdle):this.game.add.sprite(0,0,Atlases.kWings_default),u=void 0,u=(n+i)%2==0?SpriteNames.BOARD_PEACE_DARK:SpriteNames.BOARD_PEACE_LIGHT,u=this.game.add.sprite(0,0,Atlases.game_scene_ui,u),c=(a.backgroundSprite=u,a.wingSprite=d,this.isPortraitMode?i:n);if(a.suitId!=Backend.BUSH_TILE_ID){for(var g=a.suitId-1,p=[],f=0;f<this.wingFrames;f++)p.push("butterfly_"+g+"-wing_0"+f+".png");d.animations.add("rightSway",p,36,!0),d.frameName="butterfly_"+g+"-wing_00.png",d.anchor.set(.5,.5),d.name="tile_"+(i<10?"0"+i:i.toString())+"_"+(n<10?"0"+n:n.toString()),d.width=E.TILE_WIDTH,d.height=E.TILE_HEIGHT,o=this.getPosFromGridPos(a.x,a.y),d.x=o.x+.5*E.TILE_WIDTH,d.y=o.y+.5*E.TILE_HEIGHT,u.anchor.set(.5,.5),u.x=o.x+.5*E.TILE_WIDTH,u.y=o.y+.5*E.TILE_HEIGHT+12,d.scale.set(0,0),u.scale.set(0,0),this.game.add.tween(d.scale).to({x:.51,y:.51},h,Phaser.Easing.Circular.InOut,!0,c*r),this.game.add.tween(u.scale).to({x:1,y:1},h,Phaser.Easing.Circular.InOut,!0,c*r),this.isGameOver||(d.inputEnabled=!0,d.input.useHandCursor=!0,d.events.onInputOver.add(this.onOver,this),d.events.onInputOut.add(this.onOut,this),d.events.onInputUp.add(this.onUp,this))}else d.destroy(),u.destroy(),(d=this.game.add.sprite(0,0,Atlases.game_scene_ui,SpriteNames.FLOWER)).x=E.TILE_WIDTH/2,d.y=E.TILE_HEIGHT/2,d.width=E.TILE_WIDTH,d.height=E.TILE_HEIGHT,o=this.getPosFromGridPos(a.x,a.y),d.x=o.x+.5*E.TILE_WIDTH,d.y=o.y+.5*E.TILE_WIDTH+12,d.name="flower",d.anchor.set(.5,.5),this.isShuffled?d.scale.set(.65,.65):(d.scale.set(0,0),this.game.add.tween(d.scale).to({x:.65,y:.65},h,Phaser.Easing.Circular.InOut,!0,c*r));this.tileSpritesArray[a.x][a.y]=d,this.tileHolder.add(u),this.tileHolder.add(d),l&&(this.outline.lineStyle(1,0),this.outline.drawRect(o.x,o.y,E.TILE_WIDTH,E.TILE_HEIGHT),this.tileOutlineHolder.add(this.outline))}this.isShuffled=!1,this.isGameResized&&(this.deselectTile(),this.backend.handleGameMove({call:"diselect"}),this.isPause&&this.toggleTiles(!this.isPause),this.resizeGame()),this.selectionHolder.contains(this.tileOnOverSprite)&&this.selectionHolder.remove(this.tileOnOverSprite),this.selectionHolder.contains(this.hintImage1)&&this.selectionHolder.remove(this.hintImage1),this.selectionHolder.contains(this.hintImage2)&&this.selectionHolder.remove(this.hintImage2),this.tileOnOverSprite=this.game.add.sprite(0,0,Atlases.game_scene_ui,SpriteNames.TILE_SELECTOR),this.tileOnOverSprite.alpha=0,this.tileOnOverSprite.anchor.set(.5,.5),this.tileOnOverSprite.scale.set(.9,.9),this.selectionHolder.add(this.tileOnOverSprite),this.tileSelectorSprite=this.game.add.sprite(0,0,Atlases.game_scene_ui,SpriteNames.TILE_SELECTOR),this.tileSelectorSprite.alpha=0,this.tileSelectorSprite.scale.set(.9,.9),this.tileSelectorSprite.anchor.set(.5,.5),this.selectionHolder.add(this.tileSelectorSprite),this.hintImage1=this.game.add.sprite(0,0,Atlases.game_scene_ui),this.selectionHolder.add(this.hintImage1),this.hintImage1.frameName=SpriteNames.HINT,this.hintImage1.width=E.TILE_WIDTH,this.hintImage1.height=E.TILE_HEIGHT,this.hintImage1.visible=!1,this.hintImage2=this.game.add.sprite(0,0,Atlases.game_scene_ui),this.selectionHolder.add(this.hintImage2),this.hintImage2.frameName=SpriteNames.HINT,this.hintImage2.width=E.TILE_WIDTH,this.hintImage2.height=E.TILE_HEIGHT,this.hintImage2.visible=!1,this.wrongSelectionSprite1=this.game.add.sprite(0,0,Atlases.game_scene_ui,SpriteNames.TILE_SELECTOR),this.wrongSelectionSprite1.visible=!1,this.wrongSelectionSprite1.scale.set(.9,.9),this.wrongSelectionSprite1.anchor.set(.5,.5),this.wrongSelectionSprite1.tint=16724016,this.selectionHolder.add(this.wrongSelectionSprite1),this.wrongSelectionSprite2=this.game.add.sprite(0,0,Atlases.game_scene_ui,SpriteNames.TILE_SELECTOR),this.wrongSelectionSprite2.visible=!1,this.wrongSelectionSprite2.scale.set(.9,.9),this.wrongSelectionSprite2.anchor.set(.5,.5),this.wrongSelectionSprite2.tint=16724016,this.selectionHolder.add(this.wrongSelectionSprite2)},E.prototype.resizeGame=function(){var e,t=.075*this.game.height,i=t-10,n=(this.particleManager&&this.particleManager.updateDustBounds(),this.game.width/this.game.height);this.isPortraitMode?(this.fieldHolder.angle=n<.8?90:0,this.backgroundHolder.angle=90):(this.fieldHolder.angle=0,this.backgroundHolder.angle=0),this.isPortraitMode?(.6<=n&&n<.8&&(i-=35),this.fieldHolder.scale.setTo(1,1),this.backgroundHolder.scale.setTo(1,1),this.GUITopHolder.scale.setTo(1,1),this.backGround.height=1.1*this.game.width,this.backGround.width=1.1*this.game.height,e=1.5*this.game.width/this.game.height,this.GUITopHolder.scale.setTo(e,e),n<.8&&(e=1.75*n,e=Phaser.Math.clamp(e,0,1.1),this.fieldHolder.scale.setTo(e,e))):this.game.device.desktop?(this.backGround.width=this.game.width,this.backGround.height=this.game.height,this.backgroundHolder.setPinned(Fabrique.PinnedPosition.middleCenter,0,0)):(this.game.width,this.game.height,this.backgroundHolder.setPinned(Fabrique.PinnedPosition.middleCenter,0,0),this.GUITopHolder.setPinned(Fabrique.PinnedPosition.topCenter,0,i),1.7<this.game.width/this.game.height&&this.backgroundHolder.setPinned(Fabrique.PinnedPosition.middleCenter,0,0),this.backgroundHolder.scale.setTo(1,1),this.GUITopHolder.scale.setTo(1,1),this.backGround.width=1.1*this.game.width,this.backGround.height=1.25*this.game.height,n=.9*this.game.height/this.GUITopHolder.width,this.GUITopHolder.scale.setTo(n,n),this.fieldHolder.scale.setTo(1,1),this.GUIBottomGroup.scale.setTo(1,1)),this.GUITopHolder.setPinned(Fabrique.PinnedPosition.topCenter,0,i),this.GUIBottomGroup.setPinned(Fabrique.PinnedPosition.bottomCenter,0,-t),this.fieldHolder.setPinned(Fabrique.PinnedPosition.middleCenter,0,0)},E.prototype.getPosFromGridPos=function(e,t){var i=E.TILE_WIDTH,n=E.TILE_HEIGHT,s=new Phaser.Point;return s.x=0+i*e,s.y=n*t-4,s},E.prototype.onUp=function(e,t){this.isInputBlocked||(m.AudioManager.playSound(Sounds.buttonClick),this.backend.handleGameMove({call:"tileClicked",tileX:parseInt(e.name.substr(5,2)),tileY:parseInt(e.name.substr(8,2))}))},E.prototype.onOver=function(e,t){var i;this.isInputBlocked||this.game.device.desktop&&(i=e.position.x,e=e.position.y+8,this.tileOnOverSprite.position.set(i,e),this.tileOnOverSprite.alpha=.6)},E.prototype.onOut=function(e,t){this.isInputBlocked||(e.alpha=1,this.tileOnOverSprite.alpha=0)},E.prototype.update=function(){this.isGameOver||(this.isLevelFinished?0<this.timeCount&&(this.timeCount-=5,this.gameTimer.updateTimeLeft(this.timeCount),this.timeCount<0)&&(this.timeCount=0,this.updateScoreText(this.currentScore,!0)):this.isBoardShuffled?0<this.timeCount&&(this.timeCount-=5,this.timeCount<0)&&(this.timeCount=0):(!1===this.isPause&&0<=this.timeCount&&(this.timeDiff=this.game.time.elapsedMS/1e3,this.freeze_counter_<=0?this.timeCount-=this.timeDiff:(this.freeze_counter_-=this.timeDiff,this.freeze_counter_<=0&&(this.freeze_counter_=0,this.gameTimer.SetFreezeShow(!1),0<Constants.CURRENT_FREEZES||0<Constants.CURRENT_VIDEO_FREEZES)&&this.freezeButton.set_disabled(!1)),this.gameTimer.updateTimeLeft(this.timeCount),this.prevTime=Date.now()),this.timeCount<0&&this.backend.handleGameMove({call:"timeEnd"})))},E.prototype.removeTiles=function(e){for(var t=0;t<e.length;t++)this.tileHolder.remove(this.tileSpritesArray[e[t].x][e[t].y])},E.prototype.removeWing1=function(e){this.tileHolder.remove(this.tileSpritesArray[e[0].x][e[0].y])},E.prototype.removeWing2=function(e){this.tileHolder.remove(this.tileSpritesArray[e[1].x][e[1].y])},E.prototype.selectTile=function(e){var t,i;null!==e&&(this.deselectTile(),t=this.getPosFromGridPos(e.x,e.y),(this.hintImage1&&this.hintImage2&&this.hintImage1.visible&&!this.hintImage2.visible||this.hintImage1&&this.hintImage2&&!this.hintImage1.visible&&this.hintImage2.visible)&&(this.hintImage1.visible=!0,this.hintImage2.visible=!0),0===e.hintImageNumber&&(this.tileOnOverSprite.alpha=0,this.tileSelectorSprite.position.x=e.wingSprite.position.x,this.tileSelectorSprite.position.y=e.wingSprite.position.y+8,this.tileSelectorSprite.alpha=1,this.tileSelectorSprite.scale.set(.9,.9),this.tileSelectorTween=this.game.add.tween(this.tileSelectorSprite.scale).to({x:.95,y:.95},300,Phaser.Easing.Linear.None,!0,0,-1,!0)),1===e.hintImageNumber?this.hintImage1.visible=!1:2===e.hintImageNumber&&(this.hintImage2.visible=!1),this.selectedTileImage||(this.selectedTileImage=this.game.add.sprite(0,0,Atlases.game_scene_ui),this.selectedTileImage.frameName="body.png",this.selectionHolder.add(this.selectedTileImage),this.selectedTileImage.width=E.TILE_WIDTH,this.selectedTileImage.height=E.TILE_HEIGHT),i=this.tileSpritesArray[e.x][e.y],this.tileSpritesArray[e.x][e.y].x=t.x+.2*i.width,this.tileSpritesArray[e.x][e.y].animations.play("rightSway"),this.selectedTile=e,this.selectedTileImage.visible=!0,this.selectedTileImage.scale.setTo(.4,.4),this.selectedTileImage.x=this.tileSpritesArray[e.x][e.y].x+.4*i.width,this.selectedTileImage.y=t.y+12,this.selectedTile=e,this.isTileSelected=!0,e.wingSprite.inputEnabled=!1)},E.prototype.deselectTile=function(){var e,t,i,n;this.selectedTileImage&&(this.selectedTileImage.visible=!1),this.isTileSelected&&null!=this.selectedTile&&(e=this.getPosFromGridPos(this.selectedTile.x,this.selectedTile.y),t=this.selectedTile.x,i=this.selectedTile.y,this.tileSpritesArray[t][i].animations.stop("rightSway"),this.tileSpritesArray[t][i].anchor.set(.5,.5),n=this.selectedTile.suitId-1,this.tileSpritesArray[t][i].frameName="butterfly_"+n+"-wing_00.png",this.tileSpritesArray[t][i].x=e.x+.5*E.TILE_WIDTH,this.selectedTile.wingSprite.inputEnabled=!0,this.selectedTile=null,this.tileSelectorTween&&this.tileSelectorTween.isRunning&&this.tileSelectorTween.stop(),this.tileSelectorSprite.alpha=0)},E.prototype.animateButterflyConnecting=function(e){this.butterFlyConnect.removeAll(!0,!0),t=this.isWingsAdditionalPackSelected&&e[0].suitId>this.defaultWingsNumber?this.game.add.sprite(0,0,this.currentWingsPackKeyIdle):this.game.add.sprite(0,0,Atlases.kWings_default);for(var t,i=e[0].suitId-1,n=[],s=0;s<this.wingFrames;s++)n.push("butterfly_"+i+"-wing_0"+s+".png");t.animations.add("rightSway",n,24,!0),t.animations.play("rightSway"),t.anchor.setTo(1,.5),t.width=E.TILE_WIDTH,t.height=E.TILE_HEIGHT;e=this.game.add.sprite(0,0,Atlases.game_scene_ui);e.frameName="body.png",e.scale.setTo(.4),e.anchor.setTo(.5,.5),this.butterFlyConnect.scale.set(1.15,1.15),this.butterFlyConnect.addChild(t),this.butterFlyConnect.addChild(e)},E.prototype.endPoint=function(e,t){var i=new Phaser.Point(0,0);return 0<=t&&(i.x=e.x+ +Math.cos(t*Math.PI/180)),i.y=e.y+ +Math.sin(t*Math.PI/180),i},E.prototype.animateButterflyMovingAway=function(e){var t=this;if(this.butterflyHolder){this.butterflyHolder.forEach(function(e){e.visible||t.butterflyHolder.remove(e,!0)},null);for(var i,n,s=new Phaser.Group(this.game),a=(this.butterflyHolder.add(s),0),o=0,r=this.getPosFromGridPos(e[1].x,e[1].y),h=(r.x+=E.TILE_WIDTH/2,r.y+=E.TILE_HEIGHT/2,90*h5branding.Utils.getRandomRange(0,2)),h=(0===h&&(h=-90),o=this.isPortraitMode?(a=0<h?1.5*this.game.height:-this.game.height/2,this.fieldHolder.width*Math.random()):(a=0<h?1.5*this.game.width:-this.game.width/2,this.fieldHolder.height*Math.random()),s.x=r.x,s.y=r.y,a-r.x),l=o-r.y,l=Math.atan2(l,h)*(180/Math.PI)+90,h=Phaser.Math.distance(r.x,r.y,a,o)/150*1e3,d=this.game.add.tween(s).to({angle:l},700,Phaser.Easing.Back.Out,!0,0,0),u=this.game.add.tween(s).to({y:o},h,this.sineWaveEasing,!0,0,0),c=(this.game.add.tween(s).to({x:a},h,Phaser.Easing.Linear.None,!0,0,0),this.game.add.tween(s.scale).to({x:1.3*s.scale.x,y:1.3*s.scale.y},3e3,Phaser.Easing.Linear.None,!0,0,0),i=this.isWingsAdditionalPackSelected&&e[0].suitId>this.defaultWingsNumber?this.game.add.sprite(0,0,this.currentWingsPackKeyFly):this.game.add.sprite(0,0,Atlases.wings_fly_default),e[0].suitId-1),g=[],p=this.isWingsAdditionalPackSelected&&e[0].suitId>this.defaultWingsNumber?"-fly_":"-fly2_",f=0;f<12;f++)g.push(10<=f?"butterfly_"+c+p+f+".png":"butterfly_"+c+p+"0"+f+".png");i.animations.add("rightSway",g,36,!0),i.animations.play("rightSway"),i.width=E.TILE_WIDTH,i.height=E.TILE_HEIGHT+12,i.anchor.setTo(1,.5),i.scale.x*=-1,i.x-=2,s.add(i),(n=this.isWingsAdditionalPackSelected&&e[0].suitId>this.defaultWingsNumber?this.game.add.sprite(0,0,this.currentWingsPackKeyFly):this.game.add.sprite(0,0,Atlases.wings_fly_default)).animations.add("rightSway",g,36,!0),n.animations.play("rightSway"),n.anchor.setTo(1,.5),n.width=E.TILE_WIDTH,n.height=E.TILE_HEIGHT+12,n.x+=2,s.add(n);var m,r=new Phaser.Point(-20,30),_=this.isWingsAdditionalPackSelected&&e[0].suitId>this.defaultWingsNumber?this.game.add.sprite(0,0,this.currentWingsPackKeyFly):this.game.add.sprite(0,0,Atlases.wings_fly_default),l=.02*n.width,o=(_.animations.add("fly",g,36,!0),_.animations.play("fly"),_.tint=0,_.anchor.setTo(1,.5),_.alpha=.2,_.width=n.width,_.height=n.height,_.x=n.x+l,_.y=n.y,s.add(_),m=this.isWingsAdditionalPackSelected&&e[0].suitId>this.defaultWingsNumber?this.game.add.sprite(0,0,this.currentWingsPackKeyFly):this.game.add.sprite(0,0,Atlases.wings_fly_default),.05*-i.width),y=(m.animations.add("fly",g,36,!0),m.animations.play("fly"),m.tint=0,m.alpha=.2,m.anchor.setTo(1,.5),m.width=i.width,m.height=i.height,m.x=i.x+o,m.y=i.y,s.add(m),this.game.add.tween(_).to({x:3*r.x+l,y:3*r.y},3e3,Phaser.Easing.Quadratic.InOut,!0,0,0)),S=this.game.add.tween(m).to({x:3*r.x+o,y:3*r.y},3e3,Phaser.Easing.Quadratic.InOut,!0,0,0),T=this.game.add.sprite(0,0,Atlases.game_scene_ui,"body.png"),v=(T.anchor.setTo(.5),T.scale.setTo(.6),s.add(T),this.game.add.sprite(0,0,Atlases.game_scene_ui,"body.png")),w=(v.tint=0,v.alpha=.2,v.anchor.setTo(.5),v.scale.setTo(.6),this.game.add.tween(v).to({x:3*r.x+3,y:3*r.y},3e3,Phaser.Easing.Quadratic.InOut,!0,0,0));v.x=T.x,v.y=T.y,s.add(v),i.checkWorldBounds=!0,i.bringToTop(),n.bringToTop(),T.bringToTop(),u.onComplete.add(function(){i.destroy(),n.destroy(),_.destroy(),m.destroy(),T.destroy(),v.destroy(),y.stop(),S.stop(),d.stop(),this.game.tweens.remove(u),this.game.tweens.remove(y),this.game.tweens.remove(S),this.game.tweens.remove(w),this.game.tweens.remove(d)},this)}},E.prototype.sineWaveEasing=function(e){return e+.05*Math.sin(2*Math.PI*5*e)},E.prototype.drawConnectLine=function(e,t,i){this.butterflyTween&&(this.butterflyTween.stop(),this.finishButterflyMoved(this.oldButterflyTweenIdArray)),this.backend.handleGameMove({call:"checkTiles"}),this.removeLines(),h=[],this.butterflyPath=[],this.butterflyPath.push(this.getPosFromGridPos(e[0].x,e[0].y));for(var n,s,a,o="",r=0;r<e.length;r++)n=e[r],a="",0!==r&&(s=e[r-1],n.x>s.x?a="right":n.x<s.x?a="left":n.y>s.y?a="down":n.y<s.y&&(a="up")),""!==o&&o!==a&&this.butterflyPath.push(this.getPosFromGridPos(s.x,s.y)),this.getPosFromGridPos(n.x,n.y),o=a;this.butterflyPath.push(this.getPosFromGridPos(e[e.length-1].x,e[e.length-1].y)),this.butterflyPath.reverse(),this.lineHolder.removeAll(!0,!0),this.lineFactory=new m.CustomLineFactory(this.game,this.lineHolder),this.lineFactory.create(this.butterflyPath,Atlases.game_scene_ui,SpriteNames.LINE_STRAIGHT,SpriteNames.LINE_ANGLE,SpriteNames.LINE_START),this.removeWing1(t),this.currPointArrId=0,h.reverse();var h=this.butterflyPath.shift(),h=(this.butterFlyConnect.x=h.x+E.TILE_WIDTH/2,this.butterFlyConnect.y=h.y+E.TILE_HEIGHT/2,this.butterFlyConnect.alpha=1,this.butterflyPath.shift());this.butterflyTween=this.game.add.tween(this.butterFlyConnect).to({x:h.x+E.TILE_WIDTH/2,y:h.y+E.TILE_HEIGHT/2},250,Phaser.Easing.Back.In,!0,0,0),this.butterflyTween.onComplete.addOnce(this.onButterflyMoved,this,1,t),this.oldButterflyTweenIdArray=t,Constants.isGameOver&&(Constants.isGameOver=!1)},E.prototype.onButterflyMoved=function(e,t,i){var n,s=this;this.butterFlyConnect.alpha=1,this.butterflyPath.length?(n=this.butterflyPath.shift(),this.butterflyTween=this.game.add.tween(this.butterFlyConnect).to({x:n.x+E.TILE_WIDTH/2,y:n.y+E.TILE_HEIGHT/2},250,Phaser.Easing.Linear.None,!0,0,0),this.butterflyTween.onComplete.addOnce(this.onButterflyMoved,this,1,i)):(this.finishButterflyMoved(i),this.game.time.events.add(.5*Phaser.Timer.SECOND,function(){return s.onMoveFinished()},this))},E.prototype.finishButterflyMoved=function(t){this.tileOnOverSprite.alpha=0,this.butterFlyConnect.alpha=0,this.removeWing2(t),this.removeLines(),this.animateButterflyMovingAway(t),this.butterflyTween=null,this.oldButterflyTweenIdArray=null;for(var e=[],i=(e.push(Sounds.butteflyConnectionCompleted_1),e.push(Sounds.butteflyConnectionCompleted_2),m.AudioManager.playRandomSound(e),m.AudioManager.playSound(Sounds.butteflyConnectionCompletedDefault),this),n=0;n<t.length;n++)!function(e){i.game.add.tween(t[e].backgroundSprite.scale).to({x:0,y:0},200,Phaser.Easing.Circular.InOut,!0).onComplete.add(function(){t[e].backgroundSprite.destroy()})}(n);this.isTutorialCompleted||(0<this.tutorialHintsNumber?(m.AudioManager.playSound(Sounds.hintShuffleFreeze),this.backend.handleGameMove({call:"showHint",isTutorial:!0}),this.tutorialHintsNumber--):(m.Hlp.Load().isTutorialCompleted=!0,m.Hlp.Save(),this.isTutorialCompleted=!0,this.hintButton.set_disabled(!1)))},E.prototype.removeLines=function(){this.lineHolder.removeAll(!0,!0)},E.prototype.onMoveFinished=function(){this.isInputBlocked=!1,this.backend.handleGameMove({call:"onMoveFinished",timeLeft:this.timeCount})},E.prototype.goGameOver=function(){this.toggleTiles(!1),this.tileHolder.removeAll(!0),this.gameTimer.alpha=0,this.removeLines()},E.prototype.randomIntFromInterval=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},E.prototype.randomFloatBetween=function(e,t){return Math.random()*(t-e)+e},E.prototype.showHint=function(e){var t=this.getPosFromGridPos(e[0].x,e[0].y);this.hintImage1.scale.set(.9,.9),this.hintImage1Tween=this.game.add.tween(this.hintImage1.scale).to({x:.95,y:.95},300,Phaser.Easing.Linear.None,!0,0,-1,!0),this.hintImage1.anchor.set(.5,.5),this.hintImage1.visible=!0,this.hintImage1.x=t.x+E.TILE_WIDTH/2,this.hintImage1.y=t.y+E.TILE_HEIGHT/2+8,t=this.getPosFromGridPos(e[1].x,e[1].y),this.hintImage2.scale.set(.9,.9),this.hintImage2Tween=this.game.add.tween(this.hintImage2.scale).to({x:.95,y:.95},300,Phaser.Easing.Linear.None,!0,0,-1,!0),this.hintImage2.anchor.set(.5,.5),this.hintImage2.visible=!0,this.hintImage2.x=t.x+E.TILE_WIDTH/2,this.hintImage2.y=t.y+E.TILE_HEIGHT/2+8,this.backend.isHintEnabled=!0,e[0].hintImageNumber=1,e[1].hintImageNumber=2},E.prototype.intTimeToString=function(e){var t=Math.floor(e/3600),i=Math.floor(e/60),e=e%60;t<10||t.toString();return(i<10?"0"+i:i.toString())+":"+(e<10?"0"+e.toString().substring(0,1):e.toString().substring(0,2))},E.prototype.hideHint=function(){this.hintImage1&&this.hintImage1Tween&&(this.hintImage1.visible=!1,this.hintImage1Tween.stop()),this.hintImage2&&this.hintImage2Tween&&(this.hintImage2.visible=!1,this.hintImage2Tween.stop()),this.backend.isHintEnabled=!1,(0<Constants.CURRENT_HINTS||0<Constants.CURRENT_VIDEO_HINTS)&&this.isTutorialCompleted&&this.hintButton.set_disabled(!1)},E.prototype.makeRealShufle=function(){this.isShuffled=!0,this.isInputBlocked=!0,this.selectedTile&&(this.deselectTile(),this.backend.handleGameMove({call:"diselect"})),this.backend.handleGameMove({call:"makeShufle"})},E.prototype.updateShuffleAfterReward=function(){this.isPause=!this.isPause,++Constants.CURRENT_RESETS,--Constants.CURRENT_VIDEO_RESETS,this.makeRealShufle(),AzerionIntegration.GameEvents.sendEvent(AzerionIntegration.GameEventType.REWARD_AFTER_AD,"booster__shuffle")},E.prototype.makeShufle=function(){var e=this;this.isPause||this.isGameOver||(0===Constants.CURRENT_RESETS&&0<Constants.CURRENT_VIDEO_RESETS?(this.isPause=!this.isPause,Fabrique.AdHandler.getInstance().showRewardedAd(AzerionIntegration.IntegrationEvents.CLAIM_SHUFFLE,function(){return e.updateShuffleAfterReward()},function(){return e.adFailed()})):(AzerionIntegration.GameEvents.sendEvent(AzerionIntegration.GameEventType.USE_BOOSTER,"shuffle"),this.makeRealShufle()))},E.prototype.adFailed=function(){console.log("no ad available gameplay")},E.prototype.shutdown=function(){this.oldButterflyTweenIdArray&&this.finishButterflyMoved(this.oldButterflyTweenIdArray),this.selectedTileImage&&this.selectedTileImage.destroy(!0),this.selectedTileImage=null,this.hintImage1&&this.hintImage1.destroy(!0),this.hintImage1=null,this.hintImage2&&this.hintImage2.destroy(!0),Fabrique.PauseHandler.getInstance().onPauseCallback.removeAll(),Fabrique.PauseHandler.getInstance().onResumeCallback.removeAll(),this.hintImage2=null,this.tileHolder.destroy(!0),this.tileHolder=null,this.backgroundHolder.destroy(!0),this.GUITopHolder.destroy(!0),this.selectionHolder.destroy(!0),this.shuffleHolder.destroy(!0),this.lineHolder.destroy(!0),this.tileSpritesArray=null,this.backend=null,this.fieldHolder.destroy(!0),this.isBoardShuffled=!1,this.isGameOver=!1,this.tileOutlineHolder.destroy(!0),this.outline.destroy(!0),this.lastReceivedTiles=null,void 0!==this.backImage&&this.backImage.destroy(!0),void 0!==this.menuHolder&&this.menuHolder.destroy(!0),this.game.input.keyboard.removeKey(Phaser.Keyboard.H),this.game.input.keyboard.removeKey(Phaser.Keyboard.P),this.game.input.keyboard.removeKey(Phaser.Keyboard.I)},E.prototype.updateScoreText=function(e,t){this.scoreCounterText.setText(e.toString()),t&&(this.scoreTween&&this.scoreTween.stop(),this.scoreCounterStar.scale.set(1,1),this.scoreTween=this.game.add.tween(this.scoreCounterStar.scale).to({x:1.5,y:1.5},200,Phaser.Easing.Linear.None,!1,0,0,!0),this.scoreTween.start())},E.prototype.enableCheats=function(){var e=this;this.game.input.keyboard.addKey(Phaser.Keyboard.N).onDown.add(function(){Constants.CURRENT_LEVEL<9&&(e.handleGameMove({call:"finishLevel",score:e.currentScore}),console.warn("CHEATING"))},this)},E.Name="gameplay",E.MAX_TIME=200,E.REWARD_CONTINUE_TIME=30,E.FREEZE_TIME=10,E.TILE_WIDTH=75,E.TILE_HEIGHT=76,E);function E(){var e=i.call(this)||this;return e.name=E.Name,e.isPause=!1,e.isRealPause=!1,e.isInputBlocked=!1,e.isGameOver=!1,e.selectedTile=null,e.isTileSelected=!1,e.currentLevel=1,e.currentScore=0,e.previousScore=0,e.prevTime=0,e.timeCount=E.MAX_TIME,e.timeDiff=0,e.scoreSteps=0,e.isLevelFinished=!1,e.isNextLevel=!1,e.isPortraitMode=!1,e.isGameResized=!1,e.isBoardShuffled=!1,e.topGroup=null,e.store=null,e.freeze_counter_=0,e.wingsFPS=24,e.wingFrames=8,e.purchasedWingsNumber=7,e.defaultWingsNumber=16,e.isWingsAdditionalPackSelected=!1,e.isTutorialCompleted=!1,e.tutorialHintsNumber=3,e}m.Gameplay=e}(ButterflyKyodai=ButterflyKyodai||{}),function(i){t=Fabrique.State,__extends(n,t),n.prototype.init=function(){i.Hlp.UpdateCurrentTiles(),i.Hlp.UpdateCurrentBackground()},n.prototype.getDynamicLayout=function(){this.game.height>this.game.width?this.portrait=!0:this.portrait=!1},n.prototype.create=function(){var e=this,t=(Constants.CURRENT_LEVEL=0,this.game.world.shutdown(),this.getDynamicLayout(),this.logoButtonsGroup=this.game.add.responsiveGroup(null,"logoButtonsGroup",!0),this.backgroundGroup=this.game.add.responsiveGroup(null,"backgroundGroup",!0),this.logoGroup=this.game.add.group(null,"logoGroup",!0),this.logoGroup.x=this.game.width/2,this.logoGroup.y=this.game.height/4.5,this.backgroundGroup.setPinned(Fabrique.PinnedPosition.middleCenter,0,0),this.logoButtonsGroup.setPinned(Fabrique.PinnedPosition.bottomCenter,0,0),this.game.add.existing(this.backgroundGroup),this.particleManager=new i.ParticleManager(this.game,null),this.particleManager.playDustParicle(),this.game.add.existing(this.logoGroup),this.game.add.existing(this.logoButtonsGroup),this.backgroundImage=new Fabrique.ResponsiveImage(this.game,0,0,Images.MenuBackImage),this.backgroundImage.width=1.2*this.game.width,this.backgroundImage.height=1.2*this.game.height,this.backgroundImage.anchor.set(.5,.5),this.backgroundGroup.add(this.backgroundImage),this.logo=new Phaser.Image(this.game,0,0,Atlases.game_scene_ui,SpriteNames.MAIN_LOGO),this.logo.scale.setTo(1,1),this.logo.anchor.set(.5,.5),this.logo.y=-30,this.logoGroup.add(this.logo),this.startButton=i.Hlp.NewButtonBitmapScaling(this.game,Atlases.game_scene_ui,SpriteNames.START_BUTTON,!0),this.startButton.y=-435,this.startButton.OnClick().add(function(){Fabrique.AdHandler.getInstance().showAd(AzerionIntegration.IntegrationEvents.START_GAME_FROM_MAIN,function(){e.game.state.start(i.Gameplay.Name)})},this),this.startButonIcon=new Phaser.Sprite(this.game,0,0,Atlases.game_scene_ui,SpriteNames.START_BUTTON_ICON),this.startButonIcon.anchor.set(.5,.5),this.startButonIcon.position.set(0,-8),this.startButton.addChild(this.startButonIcon),this.logoButtonsGroup.add(this.startButton),this.soundButton=i.Hlp.NewSoundButton(this.game,Atlases.game_scene_ui,SpriteNames.SOUND_BUTTON_ON,!0,SpriteNames.SOUND_BUTTON_OFF),this.soundButton.position.set(720,-105),this.logoButtonsGroup.add(this.soundButton),this.topGroup=this.game.add.group(null,"top_grp",!0),this.shopButton=i.Hlp.NewButtonBitmapScaling(this.game,Atlases.game_scene_ui,SpriteNames.STORE_BUTTON,!0),this.shopButton.position.y=-100,this.shopButton.OnClick().add(function(){e.store=new i.Store(e.game,function(){Fabrique.AdHandler.getInstance().showAd(AzerionIntegration.IntegrationEvents.EXIT_SHOP_FROM_MENU,function(){e.store.destroy(),e.store=null})},SpriteNames.STORE_BACKGROUND),e.topGroup.addChild(e.store)},this),this.logoButtonsGroup.add(this.shopButton),Fabrique.LocalizationHandler.getInstance().getValue("store")),t=new Phaser.Text(this.game,0,0,t,{font:"30px 'Balsamiq Sans Bold'",fill:"#ffffff",align:"center"});t.position.x=this.shopButton.position.x,t.position.y=this.shopButton.position.y,t.position.y+=54,t.anchor.setTo(.5,.5),this.logoButtonsGroup.add(t),this.game.scale.onSizeChange.add(function(){e.resize()},this),this.resize(),i.AudioManager.isInited||(i.AudioManager.init(this.game),i.AudioManager.addSound(Sounds.themeMusic,.8,!0),i.AudioManager.addSound(Sounds.buttonClick),i.AudioManager.addSound(Sounds.butterfliesAppearOnScreen),i.AudioManager.addSound(Sounds.butteflyConnectionCompleted_1),i.AudioManager.addSound(Sounds.butteflyConnectionCompleted_2),i.AudioManager.addSound(Sounds.butteflyConnectionCompletedDefault),i.AudioManager.addSound(Sounds.butterflyFlap),i.AudioManager.addSound(Sounds.levelCompleted),i.AudioManager.addSound(Sounds.hintShuffleFreeze),i.AudioManager.addSound(Sounds.levelLost)),i.AudioManager.isPlaying(Sounds.themeMusic)||i.AudioManager.playSound(Sounds.themeMusic)},n.prototype.scaleImage=function(e,t,i){var n;this.game.device.desktop||(e.scale.setTo(1,1),i?(n=this.game.width*t/100/e.width,e.height*n>this.game.height&&(n=(this.game.height-10)/e.height)):(n=this.game.height*t/100/e.height,e.width*n>this.game.width&&(n=(this.game.width-10)/e.width)),e.scale.setTo(n,n))},n.prototype.resize=function(){this.getDynamicLayout(),this.particleManager&&this.particleManager.updateDustBounds();this.game.width,this.game.height;this.logoButtonsGroup.scale.setTo(1,1),this.logoGroup.x=this.game.width/2,this.logoGroup.y=this.game.height/4.5,this.backgroundImage.width=1.2*this.game.width,this.backgroundImage.height=1.2*this.game.height,this.soundButton.position.x=this.startButton.position.x+.45*this.game.width,this.game.device.desktop?this.game.width-this.backgroundGroup.width<0&&(this.backgroundGroup.setPinned(Fabrique.PinnedPosition.middleCenter,-45,0),this.logoGroup.x=this.game.width/2,this.logoGroup.y=this.game.height/3.5):(this.game.height,this.game.width,this.scaleImage(this.logoGroup,25,!1))},n.prototype.startGame=function(){this.game.state.start(i.Gameplay.Name)},n.prototype.shutdown=function(){this.logoButtonsGroup.destroy(!0),this.logo.destroy(!0),this.topGroup.destroy()},n.prototype.showInstructions=function(){this.instPres?(this.gameinsContainer.alpha=0,this.menuContainer.alpha=1,this.instPres=!1,this.gameInstBtn.inputEnabled=!0,this.closeInstBtn.inputEnabled=!1):(this.gameinsContainer.alpha=1,this.menuContainer.alpha=0,this.instPres=!0,this.closeInstBtn.inputEnabled=!0,this.gameInstBtn.inputEnabled=!1)},n.prototype.updtateLoadingText=function(){this.loadingText.text=this.loadingText.text+".",3<this.loadingText.text.length-n.LOADING_TEXT.length&&(this.loadingText.text=n.LOADING_TEXT)},n.prototype.ProcessAwardsAmount=function(){var e=i.Hlp.Load(),t=(new Date).getTime()/1e3;console.log("---",t-e.last_daily_time,t,e.last_daily_time),t-e.last_daily_time<86400||(e.awards=2,e.daily_coins=0,e.daily_freezes=0,e.daily_resets=0,e.daily_hints=0,e.last_daily_time=t,i.Hlp.Save())},n.Name="menu",n.LOADING_TEXT="loading";var t,e=n;function n(){var e=t.call(this)||this;return e.name=n.Name,e.portrait=!1,e.instPres=!1,e.topGroup=null,e.startButton=null,e.shopButton=null,e}i.Menu=e}(ButterflyKyodai=ButterflyKyodai||{}),function(e){s=Fabrique.ResponsiveGroup,__extends(i,s),i.prototype.resize=function(e){var t;void 0===e&&(e=!1),this.game&&(this.globalBackgroundGraphics.clear(),e?this.drawGlobalBackground(!0):this.drawGlobalBackground(),this.game.width<this.game.height?(t=1.5*this.game.width/this.game.height,e?(this.backgroundSprite.scale.set(.5,.5),this.game.add.tween(this.backgroundSprite.scale).to({x:t,y:t},this.showHideDuration,Phaser.Easing.Back.Out,!0)):this.backgroundSprite.scale.set(t,t)):e?(this.backgroundSprite.scale.set(.5,.5),this.game.add.tween(this.backgroundSprite.scale).to({x:1,y:1},this.showHideDuration,Phaser.Easing.Back.Out,!0)):this.backgroundSprite.scale.set(1,1))},i.prototype.drawGlobalBackground=function(e){void 0===e&&(e=!1),this.globalBackgroundGraphics.beginFill(0),this.globalBackgroundGraphics.drawRect(-this.game.width,2*-this.game.height,2*this.game.width,2*this.game.height),this.globalBackgroundGraphics.endFill(),this.globalBackgroundGraphics.y=this.game.height,e?(this.globalBackgroundGraphics.alpha=0,this.game.add.tween(this.globalBackgroundGraphics).to({alpha:.6},.5*this.showHideDuration,Phaser.Easing.Linear.None,!0)):this.globalBackgroundGraphics.alpha=.6};var s,t=i;function i(e,t,i){void 0===i&&(i=null);var n=s.call(this,e,null,"PopUpBase")||this;return n.showHideDuration=300,n.game=e,n.setPinned(Fabrique.PinnedPosition.middleCenter,0,0),n.globalBackgroundGraphics=n.game.add.graphics(0,0),n.add(n.globalBackgroundGraphics),n.globalBackgroundGraphics.alpha=0,n.globalBackgroundGraphics.inputEnabled=!0,i=null!==i?i:SpriteNames.POP_UP_BACKGROUND,n.backgroundSprite=new Phaser.Sprite(e,0,0,Atlases.game_scene_ui,i),n.backgroundSprite.anchor.set(.5,.5),n.add(n.backgroundSprite),n.resize(!0),n.game.scale.onSizeChange.add(function(){n.resize()},n),n}e.PopUpBase=t}(ButterflyKyodai=ButterflyKyodai||{}),function(r){h=r.PopUpBase,__extends(t,h),t.prototype.onClickClaim=function(){var e=this;Fabrique.AdHandler.getInstance().showRewardedAd(AzerionIntegration.IntegrationEvents.CLAIM_EXTRA_TURN,function(){e.continue.dispatch(),e.removeGroup()},function(){e.nextLevelCloseSignal.dispatch(),e.adFailed(),e.removeGroup()})},t.prototype.removeGroup=function(){this.continue.removeAll(),console.log("Dispatching it"),this.destroy()},t.prototype.adFailed=function(){console.log("no ad available GG")};var h,e=t;function t(e,t,i,n,s,a){var o=h.call(this,e,null)||this,t=(o.continue=new Phaser.Signal,o.portrait=!1,o.nextLevelCloseSignal=t,o.portrait=i,o.innerBackground=new Phaser.Sprite(e,0,0,Atlases.game_scene_ui,SpriteNames.FINISH_FRONT_BACKGROUND),o.innerBackground.anchor.set(.5,.5),o.innerBackground.position.y=-10,o.backgroundSprite.addChild(o.innerBackground),i=!a&&1<=Constants.CURRENT_CONTINUES?(o.continueButton=r.Hlp.NewButtonBitmapScaling(e,Atlases.game_scene_ui,SpriteNames.FINISH_BUTTON,!0),o.continueButton.anchor.set(.5,.5),o.continueButton.position.set(120,180),o.backgroundSprite.addChild(o.continueButton),t=Fabrique.LocalizationHandler.getInstance().getValue("continue"),(i=new Phaser.Text(o.game,0,0,t,{font:"30px 'Balsamiq Sans Bold'",fill:"#ffffff",stroke:"#3BA147",strokeThickness:4})).anchor.set(.5,.5),i.position.x=30,i.position.y=-4,o.continueButton.addChild(i),t=new Phaser.Sprite(e,0,0,Atlases.game_scene_ui,SpriteNames.AD_ICON),o.continueButton.addChild(t),t.anchor.set(.5,.5),t.position.set(-75,-4),o.continueButton.OnClick().add(o.onClickClaim,o),-120):0,o.playAgainButton=r.Hlp.NewButtonBitmapScaling(e,Atlases.game_scene_ui,SpriteNames.FINISH_BUTTON,!0),o.playAgainButton.anchor.set(.5,.5),o.playAgainButton.position.x=i,o.playAgainButton.position.y=180,o.backgroundSprite.addChild(o.playAgainButton),o.playAgainButton.OnClick().add(function(){Fabrique.AdHandler.getInstance().showAd(AzerionIntegration.IntegrationEvents.REPLAY,function(){o.nextLevelCloseSignal.dispatch(),o.removeGroup()})},o),Fabrique.LocalizationHandler.getInstance().getValue("play_again")),e=new Phaser.Text(o.game,0,0,t,{font:"30px 'Balsamiq Sans Bold'",fill:"#ffffff",stroke:"#3BA147",strokeThickness:4});return e.anchor.set(.5,.5),e.position.y=-4,o.playAgainButton.addChild(e),s?(t=Fabrique.LocalizationHandler.getInstance().getValue("time_out"),o.timeOutText=new Phaser.Text(o.game,0,0,t,{font:"60px 'Balsamiq Sans Bold'",fill:"#ffffff",stroke:"#5F2E95",strokeThickness:4})):a?(t=Fabrique.LocalizationHandler.getInstance().getValue("pass_all_stages"),o.timeOutText=new Phaser.Text(o.game,0,0,t,{font:"60px 'Balsamiq Sans Bold'",fill:"#ffffff",stroke:"#5F2E95",strokeThickness:4})):o.timeOutText=new Phaser.Text(o.game,0,0,"No resets",{font:"60px 'Balsamiq Sans Bold'",fill:"#ffffff",stroke:"#5F2E95",strokeThickness:4}),t=Fabrique.LocalizationHandler.getInstance().getValue("scores"),o.scoreLabelText=new Phaser.Text(o.game,0,0,t+":",{font:"52px 'Balsamiq Sans Bold'",fill:"#ffffff",stroke:"#5F2E95",strokeThickness:4}),o.scoreNumberText=new Phaser.Text(o.game,0,0,n.toString(),{font:"72px 'Balsamiq Sans Bold'",fill:"#ffffff",stroke:"#5F2E95",strokeThickness:4}),o.backgroundSprite.addChild(o.timeOutText),o.backgroundSprite.addChild(o.scoreLabelText),o.backgroundSprite.addChild(o.scoreNumberText),o.timeOutText.y=-190,o.scoreLabelText.y=-55,o.scoreNumberText.y=25,o.timeOutText.anchor.set(.5,.5),o.scoreLabelText.anchor.set(.5,.5),o.scoreNumberText.anchor.set(.5,.5),o}r.PopUpGameOver=e}(ButterflyKyodai=ButterflyKyodai||{}),function(a){n=a.PopUpBase,__extends(t,n),t.prototype.createUI=function(){var e=this,t=new Phaser.Sprite(this.game,0,0,Atlases.game_scene_ui,SpriteNames.FINISH_FRONT_BACKGROUND),t=(t.anchor.set(.5,.5),t.position.y=-10,this.backgroundSprite.addChild(t),a.Hlp.NewButtonBitmapScaling(this.game,Atlases.game_scene_ui,SpriteNames.FINISH_BUTTON,!0)),i=(t.anchor.set(.5,.5),t.position.x=-120,t.position.y=180,t.OnClick().add(function(){e.nextLevelCloseSignal.dispatch(!0),e.removeGroup()},this),this.backgroundSprite.addChild(t),Fabrique.LocalizationHandler.getInstance().getValue("next")),n=new Phaser.Text(this.game,0,0,i,{font:"32px 'Balsamiq Sans Bold'",fill:"#ffffff",stroke:"#3BA147",strokeThickness:4}),t=(n.anchor.set(.5,.5),n.position.y=-4,t.addChild(n),a.Hlp.NewButtonBitmapScaling(this.game,Atlases.game_scene_ui,SpriteNames.FINISH_BUTTON,!0)),n=(t.anchor.set(.5,.5),t.position.x=120,t.position.y=180,t.OnClick().add(this.onBonusButtonClicked,this),this.backgroundSprite.addChild(t),i=Fabrique.LocalizationHandler.getInstance().getValue("get_bonus"),new Phaser.Text(this.game,0,0,i,{font:"32px 'Balsamiq Sans Bold'",fill:"#ffffff",stroke:"#3BA147",strokeThickness:4,align:"center"})),n=(n.anchor.set(.5,.5),n.position.x=14,n.position.y=-4,n.wordWrap=!0,n.wordWrapWidth=.9*t.width,n.lineSpacing=-20,Fabrique.LocalizationHandler.getInstance().getDefaultLanguage()===Fabrique.LocalizationType.Japanese&&(n.scale.set(.5,.5),n.position.x=24),t.addChild(n),i=Fabrique.LocalizationHandler.getInstance().getValue("stage_pass"),new Phaser.Text(this.game,0,0,i,{font:"60px 'Balsamiq Sans Bold'",fill:"#ffffff",stroke:"#5F2E95",strokeThickness:4})),n=(n.position.y=-180,n.anchor.set(.5,.5),this.backgroundSprite.addChild(n),new Phaser.Sprite(this.game,0,0,Atlases.game_scene_ui,SpriteNames.AD_ICON)),t=(t.addChild(n),n.anchor.set(.5,.5),n.position.set(-75,-4),"+"+Constants.WIN_FREEZES),n=this.createReceivedReward(SpriteNames.FINISH_ICON_FREEZE,t),t=(n.position.set(-155,-100),this.backgroundSprite.addChild(n),"+"+Constants.WIN_HINTS),n=this.createReceivedReward(SpriteNames.FINISH_ICON_HINT,t),t=(n.position.set(-155,-50),this.backgroundSprite.addChild(n),"+"+Constants.WIN_SHUFFLES),n=this.createReceivedReward(SpriteNames.FINISH_ICON_SHUFFLE,t),t=(n.position.set(-155,0),this.backgroundSprite.addChild(n),"+"+a.Hlp.GetLevelPassCoinsAward(Constants.CURRENT_LEVEL)),n=this.createReceivedReward(SpriteNames.COIN,t,.5),t=(n.position.set(-155,50),this.backgroundSprite.addChild(n),new Phaser.Sprite(this.game,0,0,Atlases.game_scene_ui,SpriteNames.FINISH_VERTICAL_LINE)),n=(t.anchor.set(.5,.5),t.position.y=-10,this.backgroundSprite.addChild(t),this.generateRewards(),i=Fabrique.LocalizationHandler.getInstance().getValue("bonus"),new Phaser.Text(this.game,35,-100,i+":",{font:"32px 'Balsamiq Sans Bold'",fill:"#ffffff",stroke:"#5F2E95",strokeThickness:4}));this.backgroundSprite.addChild(n)},t.prototype.createReceivedReward=function(e,t,i){void 0===i&&(i=1);var n=new Phaser.Sprite(this.game,0,0),e=new Phaser.Sprite(this.game,0,0,Atlases.game_scene_ui,e),t=(n.addChild(e),new Phaser.Text(this.game,55,0,t,{font:"32px 'Balsamiq Sans Bold'",fill:"#ffffff",stroke:"#5F2E95",strokeThickness:4}));return e.scale.set(i,i),e.position.y=3,n.addChild(t),n},t.prototype.generateRewards=function(){this.rewards=[];for(var e=-51,t=0;t<3;++t){var i=a.Hlp.GenerateAward(),n=null,s=(a.Hlp.Load(),"+"+i.amount);switch(i.type){case a.AwardType.kCoins:n=this.createReceivedReward(SpriteNames.COIN,s,.5);break;case a.AwardType.kFrezes:n=this.createReceivedReward(SpriteNames.FINISH_ICON_FREEZE,s);break;case a.AwardType.kResets:n=this.createReceivedReward(SpriteNames.FINISH_ICON_SHUFFLE,s);break;case a.AwardType.kHints:n=this.createReceivedReward(SpriteNames.FINISH_ICON_HINT,s)}n.data=i,n.position.setTo(30,e),this.backgroundSprite.addChild(n),this.rewards.push(n),e+=50}},t.prototype.updateAwardsAfterAd=function(){for(var e=a.Hlp.Load(),t=0,i=this.rewards;t<i.length;t++){var n=i[t].data;switch(n.type){case a.AwardType.kCoins:e.coins+=n.amount;break;case a.AwardType.kFrezes:Constants.CURRENT_FREEZES+=n.amount;break;case a.AwardType.kResets:Constants.CURRENT_RESETS+=n.amount;break;case a.AwardType.kHints:Constants.CURRENT_HINTS+=n.amount}}this.nextLevelCloseSignal.dispatch(!1),this.removeGroup()},t.prototype.onBonusButtonClicked=function(){var e=this;Fabrique.AdHandler.getInstance().showRewardedAd(AzerionIntegration.IntegrationEvents.CLAIM_BONUS,function(){return e.updateAwardsAfterAd()},function(){e.nextLevelCloseSignal.dispatch(!0),e.removeGroup()})},t.prototype.removeGroup=function(){this.nextLevelCloseSignal.removeAll(),this.destroy()};var n,e=t;function t(e,t){var i=n.call(this,e,null)||this;return i.rewards=null,i.game=e,i.nextLevelCloseSignal=t,i.createUI(),i}a.PopUpNextLevel=e}(ButterflyKyodai=ButterflyKyodai||{}),function(s){a=s.PopUpBase,__extends(t,a),t.prototype.onHomeButtonClicked=function(){var e=this;Fabrique.AdHandler.getInstance().showAd(AzerionIntegration.IntegrationEvents.EXIT_GAME_FROM_PAUSE_SCREEN,function(){e.quitSignal.dispatch(),e.destroy()})},t.prototype.onPlayButtonClicked=function(){this.isRealPause&&this.pauseCloseSignal(),this.destroy()};var a,e=t;function t(e,t,i){var n=a.call(this,e,null)||this,t=(n.isRealPause=!1,n.quitSignal=new Phaser.Signal,n.pauseCloseSignal=t,n.isRealPause=i,n.playButton=s.Hlp.NewButtonBitmapScaling(e,Atlases.game_scene_ui,SpriteNames.PAUSE_BUTTON_LONG,!0),new Phaser.Sprite(e,0,0,Atlases.game_scene_ui,SpriteNames.PAUSE_ICON_PLAY)),i=(n.playButton.addChild(t),t.anchor.set(.5,.5),n.playButton.position.y=-60,t.position.y=-8,n.backgroundSprite.addChild(n.playButton),n.playButton.OnClick().add(n.onPlayButtonClicked,n),n.homeButton=s.Hlp.NewButtonBitmapScaling(e,Atlases.game_scene_ui,SpriteNames.PAUSE_BUTTON_SMALL,!0),new Phaser.Sprite(e,0,0,Atlases.game_scene_ui,SpriteNames.PAUSE_ICON_HOME)),t=(n.homeButton.addChild(i),i.anchor.set(.5,.5),i.position.y=-4,n.homeButton.position.x=-96,n.homeButton.position.y=125,n.backgroundSprite.addChild(n.homeButton),n.homeButton.OnClick().add(n.onHomeButtonClicked,n),n.soundButton=s.Hlp.NewSoundButton(e,Atlases.game_scene_ui,SpriteNames.SOUND_BUTTON_ON,!0,SpriteNames.SOUND_BUTTON_OFF),new Phaser.Sprite(e,0,0,Atlases.game_scene_ui,SpriteNames.PAUSE_BUTTON_SMALL)),i=(n.soundButton.addChildAt(t,0),n.sendToBack(t),t.anchor.set(.5,.5),n.soundButton.position.y=125,n.soundButton.position.x=96,n.backgroundSprite.addChild(n.soundButton),Fabrique.LocalizationHandler.getInstance().getValue("pause"));return n.pauseText=new Phaser.Text(n.game,0,0,i,{font:"64px 'Balsamiq Sans Bold'",fill:"#ffffff",stroke:"#5F2E95",strokeThickness:4}),n.pauseText.position.y=-200,n.pauseText.anchor.set(.5,.5),n.backgroundSprite.addChild(n.pauseText),n}s.PopUpPause=e}(ButterflyKyodai=ButterflyKyodai||{}),function(p){a=p.PopUpBase,__extends(t,a),t.prototype.update=function(){this.updateAds(),a.prototype.update.call(this)},t.prototype.initBackgroundItems=function(){for(var d=this,u=p.Hlp.Load(),c=500,g=this,e=0;e<2;e++)!function(e){var t=p.Hlp.NewButtonBitmapScaling(g.game,Atlases.game_scene_ui,"store_item_bg_"+(e+1)+".png",!0),i=new Phaser.Group(g.game,null),n=(g.backgroundItemsGroup.add(i),i.add(t),i.position.x=e*c-250,new Phaser.Sprite(g.game,0,0,Atlases.game_scene_ui,SpriteNames.STORE_ITEM_BACKGROUND_SELECTED)),s=(n.anchor.set(.5,.5),t.addChild(n),p.Hlp.NewButtonBitmapScaling(g.game,Atlases.game_scene_ui,SpriteNames.STORE_PURCHASE_ITEM_BUTTON,!0)),a=(s.anchor.set(.5,.5),i.add(s),s.position.y=80,new Phaser.Sprite(g.game,-30,-4,Atlases.game_scene_ui,SpriteNames.COIN)),a=(a.anchor.set(.5,.5),a.scale.set(.4,.4),s.addChild(a),u.buyed_backs[e]?0:g.backgroundItemPrice),o=new Phaser.Text(g.game,12,-2,a.toString(),{font:"25px 'Balsamiq Sans Bold'",fill:"#ffffff",align:"center"}),o=(o.anchor.set(.5,.5),s.addChild(o),new Phaser.Group(g.game,null)),r=new Phaser.Sprite(g.game,0,0,Atlases.game_scene_ui,SpriteNames.STORE_ITEM_SELECTED_ICON),h=(r.anchor.set(.5,.5),o.add(r),r.position.x=-60,Fabrique.LocalizationHandler.getInstance().getValue("selected")),h=new Phaser.Text(g.game,0,0,h,{font:"25px 'Balsamiq Sans Bold'",fill:"#ffffff",align:"center"}),l=(o.add(h),h.anchor.set(.5,.5),h.position.x=r.position.x+h.width/2+15,t.addChild(o),o.position.y=60,new f(t,e+1,a,u.current_backs==e+1,s,o,n,i));g.backgroundItems.push(l),g.updateBackgroundItem(l),l.button.OnClick().add(function(){u.buyed_backs[e]?d.selectBackground(e+1):l.price<=u.coins&&(u.coins-=l.price,l.price=0,u.buyed_backs[e]=1,p.Hlp.Save(),d.updateCoins(),d.selectBackground(e+1),d.updateItemPrices())},g),l.purchaseButton.OnClick().add(function(){l.price<=u.coins&&(u.coins-=l.price,l.price=0,u.buyed_backs[e]=1,d.sendThemePurchaseEvent(),p.Hlp.Save(),d.updateCoins(),d.updateItemPrices(),d.updateBackgroundItem(l))},g),g.backgroundGroups.push(i)}(e)},t.prototype.selectBackground=function(e){for(var t=0,i=this.backgroundItems;t<i.length;t++){var n=i[t];if(n.isSelected){n.isSelected=!1,this.updateBackgroundItem(n);break}}p.Hlp.Load().current_backs=e,p.Hlp.Save();e=this.backgroundItems[e-1];e.isSelected=!0,this.updateBackgroundItem(e),p.Hlp.UpdateCurrentBackground()},t.prototype.updateBackgroundItem=function(e){e.isSelected?(e.onSelectedSprite.alpha=1,e.onSelectedGroup.visible=!0,e.purchaseButton.visible=!1):(e.onSelectedSprite.alpha=0,e.onSelectedGroup.visible=!1),1===p.Hlp.Load().buyed_backs[e.buyId-1]?(e.purchaseButton.visible=!1,e.button.inputEnabled=!0):(e.purchaseButton.visible=!0,e.button.inputEnabled=!1)},t.prototype.initWingItems=function(){for(var d=this,u=p.Hlp.Load(),c=160,g=this,e=0;e<6;e++)!function(e){var t=p.Hlp.NewButtonBitmapScaling(g.game,Atlases.game_scene_ui,SpriteNames.STORE_ITEM_WING_UNSELECTED,!0,null,.8,.8),i=(t.scale.set(.8,.8),new Phaser.Sprite(g.game,0,0,Atlases.game_scene_ui,SpriteNames.STORE_ITEM_WING_SELECTED)),n=(i.anchor.set(.5,.5),t.addChild(i),new Phaser.Sprite(g.game,0,-15,Atlases.game_scene_ui,"store_item_wings_"+(e+1)+".png")),n=(t.addChild(n),n.anchor.set(.5,.5),new Phaser.Group(g.game,null)),s=(g.wingItemsGroup.add(n),n.add(t),n.position.x=e*c-400,p.Hlp.NewButtonBitmapScaling(g.game,Atlases.game_scene_ui,SpriteNames.STORE_PURCHASE_ITEM_BUTTON,!0,null,.8,.8)),a=(s.anchor.set(.5,.5),s.scale.set(.8,.8),n.add(s),s.position.y=65,new Phaser.Sprite(g.game,-30,-4,Atlases.game_scene_ui,SpriteNames.COIN)),a=(a.anchor.set(.5,.5),a.scale.set(.4,.4),s.addChild(a),u.buyed_wings[e]?0:g.wingItemPrice),o=new Phaser.Text(g.game,12,-2,a.toString(),{font:"25px 'Balsamiq Sans Bold'",fill:"#ffffff",align:"center"}),o=(o.anchor.set(.5,.5),s.addChild(o),new Phaser.Group(g.game,null)),r=new Phaser.Sprite(g.game,0,0,Atlases.game_scene_ui,SpriteNames.STORE_ITEM_SELECTED_ICON),h=(r.anchor.set(.5,.5),o.add(r),r.position.x=-55,Fabrique.LocalizationHandler.getInstance().getValue("selected")),h=new Phaser.Text(g.game,0,0,h,{font:"25px 'Balsamiq Sans Bold'",fill:"#ffffff",align:"center"}),l=(o.add(h),h.anchor.set(.5,.5),p.Hlp.fitTextToBounds(h,120,88),h.position.x=r.position.x+h.width/2+20,o.position.y=66,t.addChild(o),new m(t,e+1,a,u.current_wings==e+1,s,o,i,n));g.wingItems.push(l),g.updateWingItem(l),l.button.OnClick().add(function(){u.buyed_wings[e]&&d.selectWingPack(e+1)},g),l.purchaseButton.OnClick().add(function(){l.price<=u.coins&&(u.coins-=l.price,l.price=0,u.buyed_wings[e]=1,d.sendWingPurchaseEvent(e+1),p.Hlp.Save(),d.updateCoins(),d.updateItemPrices(),d.updateWingItem(l))},g),g.wingGroups.push(n)}(e)},t.prototype.selectWingPack=function(e){for(var t=0,i=this.wingItems;t<i.length;t++){var n=i[t];if(n.isSelected){n.isSelected=!1,this.updateWingItem(n);break}}p.Hlp.Load().current_wings=e,p.Hlp.Save();e=this.wingItems[e-1];e.isSelected=!0,this.updateWingItem(e),p.Hlp.UpdateCurrentTiles()},t.prototype.updateWingItem=function(e){e.isSelected?(e.onSelectedSprite.alpha=1,e.onSelectedGroup.visible=!0,e.purchaseButton.visible=!1):(e.onSelectedSprite.alpha=0,e.onSelectedGroup.visible=!1),1===p.Hlp.Load().buyed_wings[e.buyId-1]?(e.purchaseButton.visible=!1,e.button.inputEnabled=!0):(e.purchaseButton.visible=!0,e.button.inputEnabled=!1)},t.prototype.onCloseButtonClicked=function(){this.closeSignal()},t.prototype.updateCoins=function(){var e=p.Hlp.Load();this.coinsCountText.text=e.coins.toString()},t.prototype.updateAds=function(){var e=p.Hlp.Load();(new Date).getTime()/1e3-e.shop_ad_time<this.rewardIntervalInSeconds?this.claimCoinsButton.visible=!1:this.claimCoinsButton.visible=!0},t.prototype.getMoreCoins=function(){var e=this;Fabrique.AdHandler.getInstance().showRewardedAd(AzerionIntegration.IntegrationEvents.CLAIM_COINS,function(){return e.updateAfterReward()},function(){return e.adFailed()})},t.prototype.updateAfterReward=function(){var e=p.Hlp.Load();e.coins+=p.Hlp.kShowedAdCoinsReward,e.shop_ad_time=(new Date).getTime()/1e3,p.Hlp.Save(),this.updateCoins(),this.updateAds(),AzerionIntegration.GameEvents.sendEvent(AzerionIntegration.GameEventType.REWARD_AFTER_AD,"coins")},t.prototype.adFailed=function(){console.log("no ads in shop")},t.prototype.updateItemPrices=function(){for(var e=p.Hlp.Load(),t=0,i=0,n=e.buyed_wings;i<n.length;i++)n[i]&&++t;for(var s=0,a=0,o=e.buyed_backs;a<o.length;a++)o[a]&&++s;switch(t){case 1:this.wingItemPrice=100;break;case 2:this.wingItemPrice=250;break;case 3:this.wingItemPrice=600;break;case 4:this.wingItemPrice=1e3;break;case 5:this.wingItemPrice=1500}1===s&&(this.backgroundItemPrice=500)},t.prototype.resize=function(e){var t,i;a.prototype.resize.call(this,e=void 0===e?!1:e),this.game&&this.upperBackground&&(e=this.game.width/this.game.height,t=this.game.width<this.game.height,i=1.5*this.game.width/this.game.height,t?e<.8?(this.upperBackground.scale.set(i,i),this.upperBackground.position.y=.6*-this.game.height):(this.upperBackground.scale.set(i,i),this.upperBackground.position.y=-this.game.height*i*.5):(this.upperBackground.scale.set(1,1),this.upperBackground.position.y=-780))},t.prototype.enableCheats=function(){var e=this;this.game.input.keyboard.addKey(Phaser.Keyboard.M).onDown.add(function(){p.Hlp.Load().coins+=100,p.Hlp.Save(),e.updateCoins()},this)},t.prototype.sendThemePurchaseEvent=function(){AzerionIntegration.GameEvents.sendEvent(AzerionIntegration.GameEventType.UNLOCK_ITEM,"theme__river")},t.prototype.sendWingPurchaseEvent=function(e){var t;switch(e){case 2:t="brown";break;case 3:t="pink";break;case 4:t="blue";break;case 5:t="green";break;case 6:t="purple"}AzerionIntegration.GameEvents.sendEvent(AzerionIntegration.GameEventType.UNLOCK_ITEM,"butterfly__"+t)};var a,e=t;function t(e,t,i){var n=a.call(this,e,t,i)||this,t=(n.backgroundItemPrice=0,n.wingItemPrice=0,n.backgroundItems=[],n.wingItems=[],n.backgroundGroups=[],n.wingGroups=[],n.rewardIntervalInSeconds=180,e.width,e.height,n.game=e,n.closeSignal=t,n.backgroundSprite.position.y=40,n.updateItemPrices(),n.closeButton=p.Hlp.NewButtonBitmapScaling(e,Atlases.game_scene_ui,SpriteNames.STORE_CLOSE_BUTTON),n.backgroundSprite.addChild(n.closeButton),n.closeButton.anchor.set(.5,.5),n.closeButton.position.x=n.backgroundSprite.width-60,n.closeButton.position.y=75-n.backgroundSprite.height,n.closeButton.OnClick().add(n.onCloseButtonClicked,n),n.upperBackground=new Phaser.Sprite(e,0,0,Atlases.game_scene_ui,i),n.upperBackground.position.y=-780,n.upperBackground.anchor.set(.5,.5),n.add(n.upperBackground),Fabrique.LocalizationHandler.getInstance().getValue("store")),i=new Phaser.Text(n.game,0,0,t,{font:"60px 'Balsamiq Sans Bold'",fill:"#ffffff",align:"center",stroke:"#2A7F85",strokeThickness:4}),s=.5*n.upperBackground.height-65,i=(n.upperBackground.addChild(i),i.anchor.set(.5,.5),i.position.y=s,n.claimCoinsButton=p.Hlp.NewButtonBitmapScaling(e,Atlases.game_scene_ui,SpriteNames.STORE_TITLE_BUTTON,!0),n.claimCoinsButton.position.x=.5*-n.upperBackground.width+140,n.claimCoinsButton.position.y=5+s,new Phaser.Sprite(e,-64,-5,Atlases.game_scene_ui,SpriteNames.AD_ICON)),i=(n.claimCoinsButton.addChild(i),i.anchor.set(.5,.5),new Phaser.Sprite(e,66,-6,Atlases.game_scene_ui,SpriteNames.COIN)),i=(i.scale.set(.65,.65),i.anchor.set(.5,.5),n.claimCoinsButton.addChild(i),new Phaser.Text(e,0,-5,"+50",{font:"32px 'Balsamiq Sans Bold'",fill:"#ffffff",align:"center",stroke:"#3BA147",strokeThickness:4})),i=(n.claimCoinsButton.addChild(i),i.anchor.set(.5,.5),n.upperBackground.addChild(n.claimCoinsButton),n.claimCoinsButton.OnClick().add(n.getMoreCoins,n),n.claimCoinsButton.OnClick().add(function(){n.game.add.tween(n.coinIcon.scale).to({x:1.5,y:1.5},200,Phaser.Easing.Linear.None,!0,0,0,!0)},n),new Phaser.Sprite(e,0,0,Atlases.game_scene_ui,SpriteNames.STORE_TITLE_COUNTER));return n.upperBackground.addChild(i),i.anchor.set(.5,.5),i.position.x=.5*n.upperBackground.width-112,i.position.y=s,n.coinIcon=new Phaser.Sprite(e,-60,0,Atlases.game_scene_ui,SpriteNames.COIN),i.addChild(n.coinIcon),n.coinIcon.anchor.set(.5,.5),n.coinsCountText=new Phaser.Text(e,20,2,"0",{font:"25px 'Balsamiq Sans Bold'",fill:"#ffffff",align:"center"}),n.coinsCountText.anchor.set(.5,.5),i.addChild(n.coinsCountText),n.backgroundItemsGroup=new Phaser.Group(e,null),n.backgroundSprite.addChild(n.backgroundItemsGroup),n.backgroundItemsGroup.y=200,t=Fabrique.LocalizationHandler.getInstance().getValue("themes"),n.themesLabelText=new Phaser.Text(e,0,55,t,{font:"42px 'Balsamiq Sans Bold'",fill:"#ffffff",align:"center",stroke:"#3BA147",strokeThickness:4}),n.themesLabelText.anchor.set(.5,.5),n.backgroundSprite.addChild(n.themesLabelText),t=Fabrique.LocalizationHandler.getInstance().getValue("wings"),n.wingsLabelText=new Phaser.Text(e,0,-255,t,{font:"42px 'Balsamiq Sans Bold'",fill:"#ffffff",align:"center",stroke:"#3BA147",strokeThickness:4}),n.wingsLabelText.anchor.set(.5,.5),n.backgroundSprite.addChild(n.wingsLabelText),n.wingItemsGroup=new Phaser.Group(e,null),n.backgroundSprite.addChild(n.wingItemsGroup),n.wingItemsGroup.y=-130,n.initBackgroundItems(),n.initWingItems(),n.updateCoins(),n.resize(!0),n}p.Store=e;function i(e,t,i,n,s,a,o,r){this.buyId=0,this.price=0,this.isSelected=!1,this.button=e,this.buyId=t,this.price=i,this.purchaseButton=s,this.isSelected=n,this.onSelectedGroup=a,this.onSelectedSprite=o,this.parentGroup=r}p.StoreItem=i,__extends(s,n=i);var n,f=s;function s(){return null!==n&&n.apply(this,arguments)||this}p.BackgroundStoreItem=f;__extends(r,o=i);var o,m=r;function r(){return null!==o&&o.apply(this,arguments)||this}p.WingStoreItem=m}(ButterflyKyodai=ButterflyKyodai||{}),function(e){s=e.Button,__extends(i,s),i.prototype.setupToggleSprites=function(e,t){this.soundOnSprite=e,this.soundOffSprite=t,this.soundOffSprite.alpha=0,this.addChild(e),this.addChild(this.soundOffSprite),this.OnClick().add(this.toggle,this),this.updateState()},i.prototype.updateState=function(){this.isSoundMuted!==this.game.sound.mute&&this.toggle()},i.prototype.toggle=function(){this.isSoundMuted?(this.soundOnSprite.alpha=1,this.soundOffSprite.alpha=0):(this.soundOnSprite.alpha=0,this.soundOffSprite.alpha=1),this.isSoundMuted=!this.isSoundMuted,this.game.sound.mute=this.isSoundMuted};var s,t=i;function i(e,t,i,n){e=s.call(this,e,t=void 0===t?0:t,i=void 0===i?0:i,n=void 0===n?!1:n)||this;return e.isSoundMuted=!1,e}e.SoundButton=t}(ButterflyKyodai=ButterflyKyodai||{});